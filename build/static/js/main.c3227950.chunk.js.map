{"version":3,"sources":["reducers/user/user-initialState.js","reducers/exhibit/exhibitDelete-initialState.js","actions/action-types.js","reducers/exhibit/exhibitShow-initialState.js","reducers/exhibit/exhibit-initialState.js","reducers/exhibit/exhibitCache-initialState.js","reducers/record/record-initialState.js","i18nLibrary.js","types.js","reducers/map/mapCache-initialState.js","reducers/leaflet/leaflet-initialState.js","reducers/index.js","reducers/leaflet/leaflet-reducer.js","reducers/user/user-reducer.js","reducers/exhibit/exhibit-reducer.js","reducers/exhibit/exhibitShow-reducer.js","reducers/exhibit/exhibitDelete-reducer.js","reducers/record/record-reducer.js","reducers/map/mapCache-reducer.js","reducers/exhibit/exhibitCache-reducer.js","sagas/api_helper.js","history.js","sagas/index.js","store.js","actions/index.js","views/exhibits/index.js","components/ExhibitForm/index.js","components/Timeline/TimelineForm.js","components/NeatlineText/NeatlineTextForm.js","views/exhibits/update.js","components/ExhibitPublicMap/leafletSupport.js","components/ExhibitPublicMap/index.js","components/Timeline/TLAxis.js","components/Timeline/index.js","components/NeatlineText/NarrativePanel.js","components/info.js","views/records/index.js","components/ColorPicker/index.js","components/DatePicker/index.js","components/RecordForm/index.js","views/records/create.js","views/records/update.js","components/LockOverlay/index.js","components/SpinnerOverlay/index.js","components/AlertBar/index.js","views/exhibits/show.js","views/exhibits/create.js","views/app/index.js","index.js"],"names":["userSignedIn","window","jwt","undefined","loading","errored","EXHIBIT_LOADED","RECORD_SELECTED","RECORD_DESELECTED","RECORD_ADDED","RECORD_CREATE","RECORD_DELETE","RECORD_UPDATE","EXHIBIT_PATCH_SUCCESS","EXHIBITS_LOADING","exhibit","exhibitNotFound","selectedRecord","previewedRecord","editorRecord","editorNewRecord","tabIndex","showExhibitSettings","recordEditorType","showRecords","exhibits","newExhibit","changedExhibit","cache","changedRecord","newRecord","error","strings","LocalizedStrings","en","createExhibit","browseExhibit","refreshExhibits","title","full","contained","created","owner","public","delete","exhibit_delete_confirmation","yes","no","create_exhibit_error","update_exhibit_error","delete_exhibit_error","slug","narrative","accessible_url","default_spatial_layer","additional_spatial_layers","image_layer","zoom_levels","wms_address","wms_layers","spatial_querying","create_exhibit","records","new_record","save_record","save_exhibit","text","style","text_description","body","colors","fill_color","stroke_color","fill_opacity","stroke_opacity","selected","selected_fill_color","selected_stroke_color","selected_stroke_opacity","selected_fill_opacity","dimensions","stroke_width","point_radius","z_index","order_weight","dates","start_date","end_date","after_date","before_date","imagery","point_image","visibility","min_zoom","max_zoom","default_zoom","default_focus","create","unsaved_changes","update_record_error","delete_record_error","create_record_error","record_delete_confirmation","es","EXHIBIT_TYPE","Object","freeze","UNDEFINED","MAP","IMAGE","BASELAYER_TYPE","WMS","TILE","EXHIBIT_DEFAULT_VALUES","selectedRecordID","isEditingWithPreview","hasUnsavedChanges","current","type","TYPE","tileLayer","tile_address","displayName","deprecated","attribution","url","basemapOptions","default","geometryStyles","available","baseMaps","isEditing","isSaving","combineReducers","form","leaflet","state","initialState","action","payload","user","ACTION_TYPE","console","log","exhibitShow","filteredRecords","record","Math","min","concat","filter","r","toString","thisRecord","coverage","exhibitDelete","errors","jsonResponse","message","mapCache","Array","isArray","push","setValues","newCache","length","forEach","recordID","newValues","keys","idx","key","value","substring","id","availableOptions","ids","thisID","map","exhibitCache","urlFormat","endpoint","params","apiRoot","hasOwnProperty","urlParams","URLSearchParams","paramsString","formatRecord","format","JSON","parse","createBrowserHistory","rootSaga","createRecord","selectRecord","deselectRecord","createRecordResponseReceived","deleteRecord","deleteRecordResponseReceived","updateRecord","updateRecordResponseReceived","fetchExhibits","fetchExhibitsResponseReceived","updateExhibit","updateExhibitResponseReceived","fetchRecordsBySlug","fetchRecords","fetchRecordsResponseReceived","updateRecordCacheAndSave","saveCacheToDatabase","JSON_HEADERS","getExhibits","getExhibitCache","getMapCache","all","takeLatest","requestMapRefreshGeometry","requestMapRefresh","fetch","method","headers","stringify","response","json","response_json","put","select","baseRoute","history","replace","confirm","formatString","newPayload","event","CustomEvent","document","dispatchEvent","status","then","Error","statusText","e","baselayerType","image_address","image_attribution","tile_attribution","wms_attribution","exhibit_id","isNewRecord","x","middleware","thunk","sagaMiddleware","createSagaMiddleware","composedEnhancers","compose","applyMiddleware","store","createStore","rootReducer","run","set_availableTileLayers","setUnsavedChanges","updateRecordCache","updateExhibitCache","removeRecordFromCache","leafletIsEditing","leafletIsSaving","resetExhibit","unpreviewRecord","setTabIndex","filterRecords","setShowRecords","setShowExhibitSettings","setRecordEditorType","deleteExhibit","dispatch","ok","catch","Exhibits","createExhibitView","handleSort","clickedColumn","column","direction","setState","props","reverse","sort","a","b","toUpperCase","localeCompare","Date","this","lngButtons","getAvailableLanguages","lng","Button","onClick","setLanguage","changeLanguage","showFullViewLinks","containerFullMode","containerFullModeBaseRoute","showReturnLink","containerReturnBaseRoute","Menu","stackable","Item","header","as","Link","to","className","href","aria-label","Icon","name","size","position","icon","_","disabled","deleteInProgress","deleteErrored","Component","connect","exhibitsLoading","exhibitsErrored","bindActionCreators","ExhibitForm","onSpatialLayerInfoChange","spatial_layer","target","formSelector","updateLayerPreview","markUnsaved","baseLayerType","isNaN","preview_baseLayer","enabledSpatialLayerPreview","data","exhibitTypeSwitch","exhibitType","change","layerTYPE","retval","availableBaseMaps","thisMap","buildLayerTypeOptions","layerType","opt_key","handleSubmit","submitLabel","layerTypeOptions","currentSlug","isNewExhibit","initialValues","exhibit_type","nextprops","nextSlug","Form","onSubmit","htmlFor","Field","component","placeholder","onChange","checked","label","multiple","reduxForm","enableReinitialize","formValueSelector","defaultValues","TimelineForm","data-enforce","NeatlineTextForm","onEditorChange","bind","evt","editor","getData","input","renderEditor","EditorPreview","dangerouslySetInnerHTML","__html","defaultProps","ExhibitUpdate","panes","menuItem","render","Tab","Pane","attached","menu","secondary","pointing","leafletSupport","drawingOptions","useImperialUnits","showUnits","draw","circlemarker","marker","rectangle","showArea","showRadius","feet","metric","nautic","polygon","showLength","polyline","circle","invertCoordinateOrder","coordinates","latLngSet","coordinateArray","coordinatePair","convertToVector","geojson","convertedGeometry","features","feature","options","dashArray","positions","geometry","L","on","editing","fillColor","removeExistingHandlers","mapInstance","off","clearGeometry","eachLayer","layer","removeLayer","ExhibitPublicMap","componentDidUpdate","prevProps","mapInitialized","ls_mapInit","ls_mapUpdate","firstUpdate","hasWarning","getElementById","classList","add","remove","initialBaselayer","currentMapCache","baseLayers","img","Image","src","onerror","alert","onload","w","width","h","height","southWest","unproject","maxZoom","northEast","imageBounds","LatLngBounds","leafletMap","_image","imageOverlay","addTo","attributionControl","addAttribution","setMaxBounds","setZoom","setMaxZoom","layers","thisTileLayer","layerControl","control","onMapClick","setView","map_center","map_zoom","ls_fg","FeatureGroup","ls_drawControl","Control","Draw","edit","featureGroup","saveChanges","syncDrawWithReact","ls_geometrySetup","editable","addLayer","removeControl","uneditable","viewMode","addControl","geojsonData","toGeoJSON","ls_hasEditToSave","allowRender","isDrawing","setTimeout","onGeometryClick","onMouseEnter","recordMouseEnter","onMouseLeave","recordMouseLeave","editable_geometry","uneditable_geometry","isSelected","geoJSON","defaultGeometryStyle","record_id","coverageStyle","stroke","fill","weight","color","opacity","fillOpacity","geoJSONLayer","addData","setStyle","recordId","event_refreshMap","event_refreshMapGeometry","cacheInitialized","forceUpdate","DomEvent","stop","geoClick","addEventListener","removeEventListener","TLAxis","domain","range","timeEntries","spanHeight","parser","d3","ref","useRef","ref2","pointRadius","items","d","tier","entries","useEffect","nice","zoom","transform","zx","rescaleX","interpolate","gx","call","xAxis","allCharts","selectAll","attr","applyX","spanX","k","spanW","svg","svg2","point","item","values","enter","append","each","buttonReset","buttonZoomIn","buttonZoomOut","axisHeight","g","ticks","tickSize","transition","duration","scaleBy","Timeline","minDate","maxDate","xScale","NarrativePanel","isVisible","marginRight","Records","resetSearch","results","searchChange","mouseClick","keyCode","includes","searchTerm","setActiveCard","activeCard","Search","fluid","onSearchChange","showNoResults","onKeyDown","fontWeight","Card","marginTop","Content","Header","Description","whiteSpace","overflow","textOverflow","ColorPicker","top","left","handleChange","React","DatePicker","thisValue","formatDate","moment","isValid","fieldName","parseDate","onDayChange","RecordForm","handleDelete","scrollEvent","hideColorPicker","_colorPickerListener","targetElement","el","parentNode","colorPickerVisible","colorPickerEventHandler","enable","showColorPicker","propertyToColor","parentEl","offsetTop","scrollTop","colorPickerCurrentColor","dataset","initialcolor","colorPickerCurrentField","fieldname","colorPickerCurrentlyEditing","colorPickerTop","handleColorChange","property","hex","slider_changeStart","slider","slider_change","toFixed","updatedSliderValues","sliderValues","parseFloat","slider_changeComplete","inputEnforce","enforcementType","enforce","currentVal","currentField","forcedValue","test","showDelete","colorPickerDefaultColor","initialSliderValues","onScroll","border","padding","data-initialcolor","data-fieldname","backgroundColor","max","step","orientation","onChangeStart","onChangeComplete","background","RecordCreate","Breadcrumb","Section","deselect","Divider","active","submit","RecordUpdate","LockOverlay","SpinnerOverlay","AlertBar","ExhibitShowHeader","onSave","children","ExhibitPanelContent","ExhibitShow","saveAll","match","recordsLoading","exhibitShowURL","showExhibitPanel","setViewExhibitEditing","viewingExhibitEdit","setViewMode","val","cacheIntitialized","exhibitCacheInitialized","exhibitDisplay","showFullViewLink","toggle","basic","Grid","Row","Column","floated","marginBottom","leafletState","recordsErrored","ExhibitCreate","location","pathname","open","fullscreen","App","Router","Switch","Route","exact","path"],"mappings":"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","file":"static/js/main.c3227950.chunk.js","sourcesContent":["export default {\n  userSignedIn: (window.jwt !== null && window.jwt !== 'null' && window.jwt !== undefined)\n}\n","export default {\n\tloading: false,\n\terrored: false\n};\n","// All of the actions live here...\n// if this gets unweildy, it can be split into multiple files\nexport const PREVIEW_BASELAYER = 'PREVIEW_BASELAYER';\nexport const RECORD_PREVIEWED = 'RECORD_PREVIEWED';\nexport const RECORD_UNPREVIEWED = 'RECORD_UNPREVIEWED';\n\nexport const RECORD_CACHE_CLEAR = 'RECORD_CACHE_CLEAR';\nexport const RECORD_CACHE_CLEAR_UNSAVED = 'RECORD_CACHE_CLEAR_UNSAVED';\nexport const EXHIBIT_CACHE_SAVE = 'EXHIBIT_CACHE_SAVE';\nexport const RECORD_CACHE_UPDATE = 'RECORD_CACHE_UPDATE';\nexport const RECORD_CACHE_REMOVE = 'RECORD_CACHE_REMOVE';\nexport const RECORD_CACHE_UPDATE_AND_SAVE = 'RECORD_CACHE_UPDATE_AND_SAVE';\nexport const SET_AVAILABLE_TILELAYERS = 'SET_AVAILABLE_TILELAYERS';\nexport const HAS_UNSAVED_CHANGES = 'HAS_UNSAVED_CHANGES';\n\n// Exhibits\nexport const EXHIBIT_CACHE_UPDATE = 'EXHIBIT_CACHE_UPDATE';\nexport const EXHIBIT_LOADING = 'exhibitShow/EXHIBIT_LOADING';\nexport const EXHIBIT_ERRORED = 'exhibitShow/EXHIBIT_ERRORED';\nexport const EXHIBIT_FETCH = 'EXHIBIT_FETCH';\nexport const EXHIBIT_FETCH_RESPONSE_RECEIVED = 'EXHIBIT_FETCH_RESPONSE_RECEIVED';\nexport const EXHIBIT_FETCH_SUCCESS = 'exhibitShow/EXHIBIT_FETCH_SUCCESS';\nexport const EXHIBIT_RESET = 'exhibitShow/EXHIBIT_RESET';\nexport const EXHIBIT_LOADED = 'exhibitShow/EXHIBIT_LOADED';\nexport const EXHIBIT_NOT_FOUND = 'exhibitShow/EXHIBIT_NOT_FOUND';\n\nexport const RECORD_SELECTED = 'exhibitShow/RECORD_SELECTED';\nexport const RECORD_DESELECTED = 'exhibitShow/RECORD_DESELECTED';\n\nexport const EDITOR_NEW_RECORD = 'exhibitShow/EDITOR_NEW_RECORD';\nexport const EDITOR_CLOSE_NEW_RECORD = 'exhibitShow/EDITOR_CLOSE_NEW_RECORD';\nexport const TAB_INDEX_SET = 'exhibitShow/TAB_INDEX';\nexport const RECORD_ADDED = 'exhibitShow/RECORD_ADDED';\nexport const RECORD_REPLACED = 'exhibitShow/RECORD_REPLACED';\nexport const RECORD_REMOVED = 'exhibitShow/RECORD_REMOVED';\nexport const RECORD_COVERAGE_SET = 'exhibitShow/RECORD_COVERAGE_SET';\n\n// Records\nexport const LEAFLET_IS_SAVING = 'LEAFLET_IS_SAVING';\nexport const LEAFLET_IS_EDITING = 'LEAFLET_IS_EDITING';\nexport const RECORD_ERROR = 'RECORD_ERROR';\nexport const NEW_RECORD_RESET = 'recordCreate/NEW_RECORD_RESET';\nexport const RECORD_CACHE_REMOVE_RECORD = 'RECORD_CACHE_REMOVE_RECORD';\n\nexport const RECORD_CREATE = 'recordCreate/RECORD_CREATE'\nexport const CREATE_RECORD_RESPONSE_RECEIVED = 'CREATE_RECORD_RESPONSE_RECEIVED';\n\nexport const RECORD_DELETE = 'recordDelete/RECORD_DELETE';\nexport const DELETE_RECORD_RESPONSE_RECEIVED = 'DELETE_RECORD_RESPONSE_RECEIVED';\n\nexport const RECORD_UPDATE = 'recordUpdate/RECORD_UPDATE';\nexport const UPDATE_RECORD_RESPONSE_RECEIVED = 'UPDATE_RECORD_RESPONSE_RECEIVED';\n\nexport const EXHIBIT_UPDATE = 'EXHIBIT_UPDATE';\nexport const EXHIBIT_UPDATE_RESPONSE_RECEIVED = 'EXHIBIT_UPDATE_RESPONSE_RECEIVED';\nexport const EXHIBIT_UPDATED = 'exhibitUpdate/EXHIBIT_CREATED';\nexport const EXHIBIT_PATCH_SUCCESS = 'exhibitUpdate/EXHIBIT_POST_SUCCESS';\nexport const EXHIBIT_PATCH_ERRORED = 'exhibitUpdate/EXHIBIT_POST_ERRORED';\n\n// Exhibits\nexport const EXHIBIT_CREATED = 'exhibitCreate/EXHIBIT_CREATED';\nexport const EXHIBIT_POST_SUCCESS = 'exhibitCreate/EXHIBIT_POST_SUCCESS';\nexport const EXHIBIT_POST_ERRORED = 'exhibitCreate/EXHIBIT_POST_ERRORED';\nexport const NEW_EXHIBIT_RESET = 'exhibitCreate/NEW_EXHIBIT_RESET';\n\nexport const EXHIBIT_DELETED = 'exhibitDelete/EXHIBIT_DELETED';\nexport const EXHIBIT_DELETE_SUCCESS = 'exhibitDelete/EXHIBIT_DELETE_SUCCESS';\nexport const EXHIBIT_DELETE_ERRORED = 'exhibitDelete/EXHIBIT_DELETE_ERRORED';\n\nexport const EXHIBITS_LOADING = 'exhibits/EXHIBITS_LOADING';\nexport const EXHIBITS_ERRORED = 'exhibits/EXHIBITS_ERRORED';\nexport const EXHIBITS_FETCH_SUCCESS = 'exhibits/EXHIBITS_FETCH_SUCCESS';\n\n\nexport const RECORD_CACHE_REMOVE_BY_ID = 'RECORD_CACHE_REMOVE_BY_ID';\nexport const RECORDS_LOADING = 'RECORDS_LOADING';\nexport const RECORD_FETCH_BY_SLUG = 'RECORD_FETCH_BY_SLUG';\nexport const RECORDS_FETCH = 'RECORDS_FETCH';\nexport const RECORDS_FETCH_RESPONSE_RECEIVED = 'RECORDS_FETCH_RESPONSE_RECEIVED';\nexport const RECORDS_FETCH_SUCCESS = 'RECORDS_FETCH_SUCCESS';\nexport const RECORDS_FILTER = 'RECORDS_FILTER';\n\nexport const EVENT_REFRESH_MAP = 'EVENT_REFRESH_MAP';\nexport const EVENT_REFRESH_MAP_GEOMETRY = 'EVENT_REFRESH_MAP_GEOMETRY';\n\nexport const SHOW_RECORDS = 'SHOW_RECORDS';\nexport const RECORD_EDITOR_TYPE = 'RECORD_EDITOR_TYPE';\nexport const SHOW_EXHIBIT_SETTINGS = 'SHOW_EXHIBIT_SETTINGS';","export default {\n\texhibit: null,\n\tloading: false,\n\terrored: false,\n\texhibitNotFound: false,\n\tselectedRecord: null,\n\tpreviewedRecord: null,\n\teditorRecord: null,\n\teditorNewRecord: false,\n\ttabIndex: 0,\n\tshowExhibitSettings: true,\n\trecordEditorType: '',\n\tshowRecords: true,\n};\n","export default {\n\texhibits: [],\n\tloading: false,\n\terrored: false,\n\tnewExhibit:{},\n\texhibit: {\n\t\tchangedExhibit: null,\n\t\tloading: false,\n\t\terrored: false,\n\t}\n};\n","export default {\n\tcache:{}\n};\n","export default {\n\tchangedRecord: null,\n\tnewRecord: null,\n\tloading: false,\n\terror: ''\n};\n","//import React, {Component} from 'react';\nimport LocalizedStrings from 'react-localization';\n\nexport let strings = new LocalizedStrings({\n en: {\n\n   //for exhibits/index.js\n     createExhibit:\"Create an Exhibit\",\n     browseExhibit:\"Browse Exhibits\",\n     refreshExhibits:\"Refresh Exhibits\",\n     exhibit: \"Exhibit\",\n     title: \"Title\",\n     full: \"Full window view\",\n     contained: \"Contained view\",\n     created: \"Created\",\n     owner: \"Owner\",\n     public: \"Public\",\n     delete: \"Delete\",\n     exhibit_delete_confirmation:\"Are you sure you want to delete the Neatline exhibit? This will delete the exhibit and its associated metadata.\",\n     yes: \"Yes\",\n     no: \"No\",\n\n   //for exhibits/create.js, components/exhibitForms.js\n     //title, createExhibit already defined\n     create_exhibit_error:\"Error: failed to create exhibit\",\n     update_exhibit_error:\"Error: failed to update exhibit\",\n     delete_exhibit_error:\"Error: exhibit failed to delete\",\n     slug:\"URL Slug\",\n     narrative:\"Narrative\",\n     accessible_url:\"Alternative Accessible URL\",\n     default_spatial_layer:\"Default Spatial Layer\",\n     additional_spatial_layers:\"Additional Spatial Layers\",\n     image_layer:\"Image Layer\",\n     zoom_levels:\"Zoom Levels\",\n     wms_address:\"WMS Address\",\n     wms_layers:\"WMS Layers\",\n     spatial_querying:\"Spatial Querying\",\n     //public already defined\n     create_exhibit:\"Create exhibit\",\n\n   //for exhibits/show.js\n     //Exhibit already defined\n     records:\"Records\",\n     new_record:\"New Record\",\n     save_record:\"Save Record\",\n     save_exhibit:\"Save Exhibit\",\n     text:\"Text\",\n     style:\"Style\",\n     text_description:\"Text Description\",\n     //title, slug,already defined\n     loading:\"Loading...\",\n     body:\"Body\",\n     colors:\"Colors\",\n     fill_color:\"Fill Color\",\n     stroke_color:\"Stroke Color\",\n     fill_opacity:\"Fill Opacity\",\n     stroke_opacity:\"Stroke Opacity\",\n     selected:\"Selected\",\n     selected_fill_color:\"Selected - Fill Color\",\n     selected_stroke_color:\"Selected - Stroke Color\",\n     selected_stroke_opacity:\"Selected - Stroke Opacity\",\n     selected_fill_opacity:\"Selected - Fill Opacity\",\n     dimensions:\"Dimensions\",\n     stroke_width:\"Stroke Width\",\n     point_radius:\"Point Radius\",\n     z_index:\"Z-Index\",\n     order_weight:\"Order/Weight\",\n     dates:\"Dates\",\n     start_date:\"Start Date\",\n     end_date:\"End Date\",\n     after_date:\"After Date\",\n     before_date:\"Before Date\",\n     imagery:\"Imagery\",\n     point_image:\"Point Image\",\n     //wms_layers, wms_address already defined\n     visibility:\"Visibility\",\n     min_zoom:\"Min Zoom\",\n     max_zoom:\"Max Zoom\",\n     default_zoom:\"Default Zoom\",\n     default_focus:\"Default Focus\",\n     create:\"Create\",\n     unsaved_changes:\"You have unsaved changes!\",\n     update_record_error:\"Error updating record\",\n     delete_record_error:\"Error deleting record\",\n     create_record_error:\"Error creating record\",\n     record_delete_confirmation:\"Are you sure you want to delete the Neatline record?\",\n\n },\n es:{\n   //PLEASE note: Spanish translations are very rough, and they only exist\n   //to demonstrate the i18n functionality, with no intent to offend anyone.\n\n   //for exhibits/index.js\n     createExhibit:\"Crear una presentación\",\n     browseExhibit:\"Ver presentación\",\n     refreshExhibits:\"Actualizar las presentaciones\",\n     exhibit: \"Presentación\",\n     title: \"Título\",\n     created: \"Creado\",\n     owner: \"Owner\",\n     public: \"Público\",\n     delete: \"Borrar\",\n     exhibit_delete_confirmation:\"Está seguro que quiere borrar la presentación {0}? Esta acción va a borrar la presentación y su metadata asociada.\",\n     yes: \"Sí\",\n     no: \"No\",\n\n\n   //for exhibits/create.js, components/exhibitForms.js\n     //title, createExhibit already defined\n     create_exhibit_error:\"Error: no pudo crear una presentación\",\n     update_exhibit_error:\"Error: no pudo actualizar la presentación\",\n     delete_exhibit_error:\"Error: no pudo deletar la presentación\",\n     slug:\"URL slug\",\n     narrative:\"Narración\",\n     accessible_url:\"URL accesible alternativo\",\n     default_spatial_layer:\"Valor por el defecto para capa espacial\",\n     additional_spatial_layers:\"Capas espaciales adicionales\",\n     image_layer:\"Capa del imagen\",\n     zoom_levels:\"Nivel del zoom\",\n     wms_layers:\"Capa del WMS\",\n     wms_address:\"Dirección del WMS\",\n     spatial_querying:\"Pregunta espacial\",\n     //public already defined\n     create_exhibit:\"Crear la presentación\",\n\n   //for exhibits/show.js\n       //Exhibit already defined\n     records:\"Archivos\",\n     new_record:\"Un archivo nuevo\",\n     save_record:\"Grabar el archivo\",\n     save_exhibit:\"Grabar la presentación\",\n     text:\"Texto\",\n     style:\"Estilo\",\n     text_description:\"Descripción del texto\",\n     //title, slug,already defined\n     loading:\"Cargando...\",\n     body:\"Cuerpo\",\n     colors:\"Colores\",\n     fill_color:\"Color llenado\",\n     stroke_color:\"Color del trazo\",\n     fill_opacity:\"Opacidad llenada\",\n     stroke_opacity:\"Opacidad del trazo\",\n     selected:\"Seleccionado\",\n     selected_fill_color:\"Color llenado\",\n     selected_stroke_color:\"Color del trazo\",\n     selected_stroke_opacity:\"Opacidad llenada\",\n     selected_fill_opacity:\"Opacidad del trazo\",\n     dimensions:\"Dimensiones\",\n     stroke_width:\"Ancho del trazo\",\n     point_radius:\"Radio del punto\",\n     z_index:\"indice Z\",\n     order_weight:\"Orden/peso\",\n     dates:\"Fechas\",\n     start_date:\"Fecha del comienzo\",\n     end_date:\"Fecha del fin\",\n     after_date:\"Fecha después\",\n     before_date:\"Fecha antes\",\n     imagery:\"Imaginería\",\n     point_image:\"Imagen del punto\",\n     //wms_layers, wms_address already defined\n     visibility:\"Visibilidad\",\n     min_zoom:\"Zoom mínimo\",\n     max_zoom:\"Zoom máximo\",\n     default_zoom:\"Valor por el defecto para zoom\",\n     default_focus:\"Valor por el defecto para enfoque\",\n     create:\"Crear\",\n     unsaved_changes:\"¡Tiene cambios que no están grabados!\",\n     update_record_error:\"Error: no pudo actualizar el archivo\",\n     delete_record_error:\"Error: no pudo deletar el archivo\",\n     create_record_error:\"Error: no pudo crear el archivo\",\n     record_delete_confirmation:\"¿Está seguro que quiere borrar el archivo {0}?\",\n },\n\n/*\n//template, maybe for future use\n emptyList: {\n   createExhibit:\"\",\n   browseExhibit:\"\",\n   refreshExhibits:\"\",\n   exhibit: \"\",\n   title: \"\",\n   created: \"\",\n   public: \"\",\n   delete: \"\",\n   exhibit_delete_confirmation:\"\",\n   yes: \"\",\n   no: \"\",\n\n //for exhibits/create.js, components/exhibitForms.js\n   //title, createExhibit already defined\n   create_exhibit_error:\"\",\n   update_exhibit_error:\"\",\n   delete_exhibit_error:\"\",\n   slug:\"\",\n   narrative:\"\",\n   accessible_url:\"\",\n   default_spatial_layer:\"\",\n   additional_spatial_layers:\"\",\n   image_layer:\"\",\n   zoom_levels:\"\",\n   wms_layers:\"\",\n   wms_address:\"\",\n   spatial_querying:\"\",\n   //public already defined\n   create_exhibit:\"\",\n\n //for exhibits/show.js\n     //Exhibit already defined\n   records:\"\",\n   new_record:\"\",\n   save_record:\"\",\n   save_exhibit:\"\",\n   text:\"\",\n   style:\"\",\n   text_description:\"\",\n   //title, slug,already defined\n   loading:\"\",\n   body:\"\",\n   colors:\"\",\n   fill_color:\"\",\n   stroke_color:\"\",\n   fill_opacity:\"\",\n   stroke_opacity:\"\",\n   selected:\"\",\n   selected_fill_color:\"\",\n   selected_stroke_color:\"\",\n   selected_stroke_opacity:\"\",\n   selected_fill_opacity:\"\",\n   dimensions:\"\",\n   stroke_width:\"\",\n   point_radius:\"\",\n   z_index:\"\",\n   order_weight:\"\",\n   dates:\"\",\n   start_date:\"\",\n   end_date:\"\",\n   after_date:\"\",\n   before_date:\"\",\n   imagery:\"\",\n   point_image:\"\",\n   //wms_layers, wms_address already defined\n   visibility:\"\",\n   min_zoom:\"\",\n   max_zoom:\"\",\n   default_zoom:\"\",\n   default_focus:\"\",\n   create:\"\",\n   unsaved_changes:\"\",\n   update_record_error:\"\",\n   delete_record_error:\"\",\n   create_record_error:\"\",\n   record_delete_confirmation:\"\",\n\n }\n*/\n});\n","// Exhibit types, either IMAGE or MAP\nexport const EXHIBIT_TYPE = Object.freeze({\n\tUNDEFINED: -1,\n\tMAP: 0,\n\tIMAGE: 1,\n});\n\n// Supported baselayer types, note that \"IMAGE\" and the rest are mutually exclusive (different coordinate systems)\nexport const BASELAYER_TYPE = Object.freeze({\n\tMAP: \"MAP\",\n\tIMAGE: \"IMAGE\",\n\tWMS: \"WMS\",\n\tTILE: \"TILE\"\n});\n\n// FIXME: Not sure why this is here\nexport const EXHIBIT_DEFAULT_VALUES = Object.freeze({\n  'o:spatial_layer': '0',\n\t'o:spatial_layers': [],\n\t'o:zoom_levels': 20,\n\t'o:spatial_querying': true\n});\n\n// Marks record temporary (new record, pre-save)\nexport const NEW_UNSAVED_RECORD = -1;\n","/*\n\tThere is a \"deprecated\" flag for basemap options which will allow them to remain\n\tin this file but they will not appear in the UI.\n\n\tAt the moment this is the case for the google basemaps - enabling them here\n\tWILL function correctly, but per the Google user agreement it is no longer\n\tallowed to access maps in this way.\n\n\thttps://cloud.google.com/maps-platform/maps/\n\n\tIn order to use the google maps correctly, they should be accessed via an\n\tAPI key associated with a credit card that can be charged for usage. As of\n\tthis writing, google grants a $200/month credit, but the logistics of credit\n\tcard and API key setup are outside the scope of this repo and depend on your\n\torganization.\n*/\nimport * as TYPE from '../../types';\nexport default {\n\tcache:[],\n\tselectedRecordID:null,\n\tisEditingWithPreview: true,\n\thasUnsavedChanges: false,\n\tcurrent: {\n\t\ttype: TYPE.BASELAYER_TYPE.MAP,\n\t\ttileLayer: {\n\t\t\ttile_address:'',\n\t\t\tslug: \"OpenStreetMap\",\n\t\t\tdisplayName: \"Open Street Map\",\n\t\t\tdeprecated: false,\n\t\t\tattribution: '&amp;copy <a href=&quot;http://osm.org/copyright&quot;>OpenStreetMap</a> contributors',\n\t\t\turl: 'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',\n\t\t},\n\t\tbasemapOptions: [\n\t\t\t{\n\t\t\t\tslug: \"OpenStreetMap\",\n\t\t\t\tdisplayName: \"DEFAULT Open Street Map\",\n\t\t\t\tdeprecated: false,\n\t\t\t\tattribution: '&amp;copy <a href=&quot;http://osm.org/copyright&quot;>OpenStreetMap</a> contributors',\n\t\t\t\turl: 'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png'\n\t\t\t}\n\t\t]\n\t},\n\n\tdefault: {\n\t\tgeometryStyles: {\n\t\t\t'o:stroke_width': 2,\n\t\t\t'o:stroke_color': '#000000',\n\t\t\t'o:stroke_color_select': '#000000',\n\t\t\t'o:stroke_opacity': 1.0,\n\t\t\t'o:stroke_opacity_select': 1.0,\n\t\t\t'o:fill_opacity': 0.5,\n\t\t\t'o:fill_color': '#00aeff',\n\t\t\t'o:fill_color_select': '#00aeff'\n\t\t}\n\t},\n\n\tavailable: {\n\t\tbaseMaps: [\n\t\t\t{\n\t\t\t\ttype: TYPE.BASELAYER_TYPE.MAP,\n\t\t\t\tslug: \"OpenStreetMap\",\n\t\t\t\tdisplayName: \"Open Street Map\",\n\t\t\t\tdeprecated: false,\n\t\t\t\tattribution: '&amp;copy <a href=&quot;http://osm.org/copyright&quot;>OpenStreetMap</a> contributors',\n\t\t\t\turl: 'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png'\n\t\t\t}, {\n\t\t\t\ttype: TYPE.BASELAYER_TYPE.MAP,\n\t\t\t\tslug: \"StamenToner\",\n\t\t\t\tdisplayName: \"Stamen: Toner\",\n\t\t\t\tdeprecated: false,\n\t\t\t\tattribution: 'Map tiles by <a href=\"http://stamen.com\">Stamen Design</a>, under <a href=\"http://creativecommons.org/licenses/by/3.0\">CC BY 3.0</a>. Data by <a href=\"http://openstreetmap.org\">OpenStreetMap</a>, under <a href=\"http://www.openstreetmap.org/copyright\">ODbL</a>.',\n\t\t\t\turl: 'http://tile.stamen.com/toner/{z}/{x}/{y}.png'\n\t\t\t}, {\n\t\t\t\ttype: TYPE.BASELAYER_TYPE.MAP,\n\t\t\t\tslug: \"StamenWatercolor\",\n\t\t\t\tdisplayName: \"Stamen: Watercolor\",\n\t\t\t\tdeprecated: false,\n\t\t\t\tattribution: 'Map tiles by <a href=\"http://stamen.com\">Stamen Design</a>, under <a href=\"http://creativecommons.org/licenses/by/3.0\">CC BY 3.0</a>. Data by <a href=\"http://openstreetmap.org\">OpenStreetMap</a>, under <a href=\"http://creativecommons.org/licenses/by-sa/3.0\">CC BY SA</a>.',\n\t\t\t\turl: 'http://tile.stamen.com/watercolor/{z}/{x}/{y}.png'\n\t\t\t}, {\n\t\t\t\ttype: TYPE.BASELAYER_TYPE.MAP,\n\t\t\t\tslug: \"StamenTerrain\",\n\t\t\t\tdisplayName: \"Stamen: Terrain\",\n\t\t\t\tdeprecated: false,\n\t\t\t\tattribution: 'Map tiles by <a href=\"http://stamen.com\">Stamen Design</a>, under <a href=\"http://creativecommons.org/licenses/by/3.0\">CC BY 3.0</a>. Data by <a href=\"http://openstreetmap.org\">OpenStreetMap</a>, under <a href=\"http://www.openstreetmap.org/copyright\">ODbL</a>.',\n\t\t\t\turl: 'http://tile.stamen.com/terrain/{z}/{x}/{y}.png'\n\t\t\t}, {\n\t\t\t\ttype: TYPE.BASELAYER_TYPE.MAP,\n\t\t\t\tslug: \"GooglePhysical\",\n\t\t\t\tdisplayName: \"Google: Physical\",\n\t\t\t\tdeprecated: true,\n\t\t\t\tattribution: '&amp;copy <a href=&quot;http://osm.org/copyright&quot;>OpenStreetMap</a> contributors',\n\t\t\t\turl: 'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png'\n\t\t\t}, {\n\t\t\t\ttype: TYPE.BASELAYER_TYPE.MAP,\n\t\t\t\tslug: \"GoogleStreets\",\n\t\t\t\tdisplayName: \"Google: Streets\",\n\t\t\t\tdeprecated: true,\n\t\t\t\tattribution: '&amp;copy <a href=&quot;http://osm.org/copyright&quot;>OpenStreetMap</a> contributors',\n\t\t\t\turl: 'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png'\n\t\t\t}, {\n\t\t\t\ttype: TYPE.BASELAYER_TYPE.MAP,\n\t\t\t\tslug: \"GoogleHybrid\",\n\t\t\t\tdisplayName: \"Google: Hybrid\",\n\t\t\t\tdeprecated: true,\n\t\t\t\tattribution: '&amp;copy <a href=&quot;http://osm.org/copyright&quot;>OpenStreetMap</a> contributors',\n\t\t\t\turl: 'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png'\n\t\t\t}, {\n\t\t\t\ttype: TYPE.BASELAYER_TYPE.MAP,\n\t\t\t\tslug: \"GoogleSatellite\",\n\t\t\t\tdisplayName: \"Google: Satellite\",\n\t\t\t\tdeprecated: true,\n\t\t\t\tattribution: '&amp;copy <a href=&quot;http://osm.org/copyright&quot;>OpenStreetMap</a> contributors',\n\t\t\t\turl: 'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png'\n\t\t\t}\n\t\t]\n\t}\n\n};\n","export default {\n\tisEditing: false,\n\tisSaving: false\n};\n","import { combineReducers } from 'redux';\nimport { reducer as form } from 'redux-form';\n\nimport user from './user/user-reducer';\n\nimport exhibitDelete from './exhibit/exhibitDelete-reducer.js';\nimport exhibitShow from './exhibit/exhibitShow-reducer.js';\nimport exhibits from './exhibit/exhibit-reducer.js';\nimport exhibitCache from './exhibit/exhibitCache-reducer.js';\n\nimport record from './record/record-reducer.js';\n\nimport mapCache from './map/mapCache-reducer.js';\n\nimport leaflet from './leaflet/leaflet-reducer.js';\n\nexport default combineReducers({\n  form,\n  leaflet,\n  user,\n  exhibits,\n  exhibitShow,\n  exhibitDelete,\n  record,\n\n  mapCache,\n  exhibitCache\n});\n","import initialState from './leaflet-initialState';\nimport * as ACTION_TYPE from '../../actions/action-types';\n\n\nexport default function(state = initialState, action) {\n\tswitch (action.type) {\n\n\t\t// On initiate create...\n\t\tcase ACTION_TYPE.LEAFLET_IS_EDITING:\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t   isEditing: action.payload\n\t\t\t};\n\n\t\t\tcase ACTION_TYPE.LEAFLET_IS_SAVING:\n\t\t\t\treturn {\n\t\t\t\t\t...state,\n\t\t\t\t   isSaving: action.payload\n\t\t\t\t};\n\n\t\tdefault:\n\t\t\treturn state;\n\t}\n}\n","import initialState from './user-initialState';\nexport default (state = initialState, action) => {\n  switch (action.type) {\n    default:\n      return state;\n  }\n}\n","import initialState from './exhibit-initialState';\nimport * as ACTION_TYPE from '../../actions/action-types';\nexport default function(state = initialState, action) {\n\tswitch (action.type) {\n\n\t case ACTION_TYPE.EXHIBITS_LOADING:\n   \t return {\n   \t   ...state,\n   \t   loading: action.loading\n   \t };\n\n     case ACTION_TYPE.EXHIBITS_ERRORED:\n     console.log(action);\n   \t return {\n   \t   ...state,\n   \t   errored: action.errored\n   \t };\n\n     case ACTION_TYPE.EXHIBITS_FETCH_SUCCESS:\n   \t return {\n   \t   ...state,\n   \t   exhibits:action.payload\n   \t };\n\n\t case ACTION_TYPE.EXHIBIT_UPDATED:\n       return {\n         ...state,\n         loading: true,\n         changedExhibit: action.exhibit\n       };\n\n     case ACTION_TYPE.EXHIBIT_PATCH_SUCCESS:\n       return {\n         ...state,\n         loading: false,\n         changedExhibit: initialState.changedExhibit\n       };\n\n     case ACTION_TYPE.EXHIBIT_PATCH_ERRORED:\n       return {\n         ...state,\n         errored: true\n       };\n\n    default:\n   \t \treturn state;\n    }\n}\n","import initialState from './exhibitShow-initialState';\nimport * as ACTION_TYPE from '../../actions/action-types';\n\nexport default function(state = initialState, action) {\n\n\tswitch (action.type) {\n\t\tcase ACTION_TYPE.EXHIBIT_LOADING:\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tloading: action.loading\n\t\t\t};\n\n\t\tcase ACTION_TYPE.EXHIBIT_ERRORED:\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\terrored: action.errored\n\t\t\t};\n\n\t\tcase ACTION_TYPE.RECORDS_LOADING:\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tloading: action.payload\n\t\t\t};\n\n\t\tcase ACTION_TYPE.RECORDS_FETCH_SUCCESS:\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\trecords: action.payload,\n\t\t\t\tloading: false\n\t\t\t};\n\n\t\tcase ACTION_TYPE.RECORDS_FILTER:\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tfilteredRecords: action.payload\n\t\t\t};\n\n\t\tcase ACTION_TYPE.EXHIBIT_RESET:\n\t\t\treturn initialState;\n\n\t\tcase ACTION_TYPE.EXHIBIT_LOADED:\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\texhibit: action.payload,\n\t\t\t\texhibitNotFound: false\n\t\t\t};\n\n\t\tcase ACTION_TYPE.EXHIBIT_NOT_FOUND:\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\texhibitNotFound: true\n\t\t\t};\n\n\t\tcase ACTION_TYPE.SHOW_RECORDS:\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tshowRecords: action.payload\n\t\t\t};\n\n\t\tcase ACTION_TYPE.SHOW_EXHIBIT_SETTINGS:\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tshowExhibitSettings: action.payload\n\t\t\t};\n\n\t\tcase ACTION_TYPE.RECORD_EDITOR_TYPE:\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\trecordEditorType: action.payload,\n\t\t\t}\n\t\tcase ACTION_TYPE.RECORD_SELECTED:\n\t\t\tlet record = action.payload.record;\n\t\t\tif (typeof record !== 'undefined' && record !== null) {\n\t\t\t\treturn {\n\t\t\t\t\t...state,\n\t\t\t\t\tselectedRecord: record,\n\t\t\t\t\teditorRecord: record,\n\t\t\t\t\teditorNewRecord: false,\n\t\t\t\t\ttabIndex: 2\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\treturn {\n\t\t\t\t\t...state\n\t\t\t\t};\n\t\t\t}\n\n\t\tcase ACTION_TYPE.RECORD_DESELECTED:\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\teditorRecord: null,\n\t\t\t\tselectedRecord: null,\n\t\t\t\teditorNewRecord: false,\n\t\t\t\ttabIndex: Math.min(state.tabIndex, 1)\n\t\t\t};\n\n\t\tcase ACTION_TYPE.RECORD_PREVIEWED:\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tpreviewedRecord: action.record\n\t\t\t};\n\n\t\tcase ACTION_TYPE.RECORD_UNPREVIEWED:\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tpreviewedRecord: null\n\t\t\t};\n\n\t\tcase ACTION_TYPE.EDITOR_NEW_RECORD:\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\teditorNewRecord: true,\n\t\t\t\teditorRecord: null,\n\t\t\t\tselectedRecord: null,\n\t\t\t\ttabIndex: 2\n\t\t\t}\n\n\t\tcase ACTION_TYPE.EDITOR_CLOSE_NEW_RECORD:\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\teditorNewRecord: false,\n        recordEditorType: ''\n\t\t\t}\n\n\t\tcase ACTION_TYPE.TAB_INDEX_SET:\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\ttabIndex: action.payload\n\t\t\t}\n\n\t\tcase ACTION_TYPE.RECORD_ADDED:\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\trecords: state.records.concat(action.record),\n\t\t\t\teditorRecord: action.record,\n\t\t\t\tselectedRecord: action.record,\n\t\t\t\tfilteredRecords: state.filteredRecords.concat(action.record),\n\t\t\t}\n\n\t\tcase ACTION_TYPE.RECORD_REPLACED:\n      // console.log('START of RECORD_REPLACED - selectedRecord')\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\trecords: state.records.filter(r => r['o:id'].toString() !== action.record['o:id'].toString()).concat(action.record),\n\t\t\t\t// editorRecord: action.record,\n\t\t\t\tfilteredRecords: state.filteredRecords.filter(r => r['o:id'].toString() !== action.record['o:id'].toString()).concat(action.record)\n\t\t\t\t/* selectedRecord: action.record */\n\t\t\t}\n\n\t\tcase ACTION_TYPE.RECORD_REMOVED:\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\trecords: state.records.filter(r => r['o:id'].toString() !== action.record['o:id'].toString()),\n\t\t\t\teditorRecord: null,\n\t\t\t\tselectedRecord: null,\n\t\t\t\ttabIndex: 1,\n\t\t\t\tfilteredRecords: state.filteredRecords.filter(r => r['o:id'].toString() !== action.record['o:id'].toString())\n\t\t\t}\n\n\t\t// FIXME: Remove this and have map use hidden form\n\t\tcase ACTION_TYPE.RECORD_COVERAGE_SET:\n\t\t\tif (state.editorRecord !== null) {\n\t\t\t\tvar thisRecord = state.editorRecord;\n\t\t\t\tthisRecord['o:coverage'] = action.coverage;\n\t\t\t\treturn {\n\t\t\t\t\t...state,\n\t\t\t\t\teditorRecord: thisRecord\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn state;\n\n\t\tdefault:\n\t\t\treturn state;\n\t}\n\n}\n","import initialState from './exhibitDelete-initialState';\nimport * as ACTION_TYPE from '../../actions/action-types';\n\nexport default function(state = initialState, action) {\n\tswitch (action.type) {\n\t\tcase ACTION_TYPE.EXHIBIT_DELETED:\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tloading: true\n\t\t\t};\n\n\t\tcase ACTION_TYPE.EXHIBIT_DELETE_SUCCESS:\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tloading: false\n\t\t\t};\n\n\t\tcase ACTION_TYPE.EXHIBIT_DELETE_ERRORED:\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\terrored: true\n\t\t\t};\n\n\t\tdefault:\n\t\t\treturn state;\n\t}\n}\n","import initialState from './record-initialState';\nimport * as ACTION_TYPE from '../../actions/action-types';\nimport {strings} from '../../i18nLibrary';\n\nexport default function(state = initialState, action) {\n\tswitch (action.type) {\n\n\t\t// On initiate create...\n\t\tcase ACTION_TYPE.RECORD_CREATE:\n\t\t\treturn {\n\t\t\t  ...state,\n\t\t\t  loading: true,\n\t\t\t  newRecord: action.payload\n\t\t\t};\n\n\t\t// Handle response from create record API call\n\t\tcase ACTION_TYPE.CREATE_RECORD_RESPONSE_RECEIVED:\n\t\t\t// Failed with error from API server\n\t\t\tif (typeof action.payload.errors !== 'undefined') {\n\t\t\t\tconsole.error(`CREATE_RECORD_ERROR: ${action.payload.errors.error}`);\n\t\t\t\treturn {\n\t\t\t\t\t...state,\n\t\t\t\t\terror: strings.create_record_error\n\t\t\t\t};\n\n\t\t\t// Accepted (RECORD_CREATED)\n\t\t\t} else {\n\t\t\t\treturn {\n\t\t\t\t\t...state,\n\t\t\t\t\tloading: false,\n\t\t\t\t\terror: '',\n\t\t\t\t\tnewRecord: action.record\n\t\t\t\t};\n\t\t\t}\n\n\n\t\t// On initiate delete...\n\t\tcase ACTION_TYPE.RECORD_DELETE:\n\t\t\treturn {\n\t          ...state,\n\t          loading: true\n\t        };\n\n\t\t// Handle response from delete record API call\n\t\tcase ACTION_TYPE.DELETE_RECORD_RESPONSE_RECEIVED:\n\n\t\t\t// Failed with error from API server\n\t\t\tif (typeof action.payload.jsonResponse.errors !== 'undefined') {\n\t\t\t\tconsole.error(`DELETE_RECORD_ERROR: ${action.payload.jsonResponse.errors.error}`);\n\t\t\t\treturn {\n\t\t\t\t\t...state,\n\t\t\t\t\terror: strings.delete_record_error\n\t\t\t\t};\n\n\t\t\t// Accepted (RECORD_DELETED)\n\t\t\t} else {\n\t\t\t\treturn {\n\t\t\t\t\t...state,\n\t\t\t\t\tloading: false,\n\t\t\t\t\terror: ''\n\t\t\t\t};\n\t\t\t}\n\n\t\t// Handle response from update record API call\n\t\tcase ACTION_TYPE.UPDATE_RECORD_RESPONSE_RECEIVED:\n\t\t\t// Failed with error from API server\n\t\t\tif (typeof action.payload.errors !== 'undefined') {\n\t\t\t\tconsole.error(`UPDATE_RECORD_ERROR: ${action.payload.errors.error}`);\n\t\t\t\treturn {\n\t\t\t\t\t...state,\n\t\t\t\t\terror: strings.update_record_error\n\t\t\t\t};\n\n\t\t\t// Accepted\n\t\t\t} else {\n\n\t\t\t\treturn {\n\t\t\t\t\t...state,\n\t\t\t\t\tloading: false,\n\t\t\t\t\tchangedRecord: action.payload,\n\t\t\t\t\terror: '',\n\t\t\t\t\tisEditing:false\n\t\t\t\t};\n\t\t\t}\n\n\t\t// A wild error appeared!\n\t\tcase ACTION_TYPE.RECORD_ERROR:\n\t\t\tconsole.error(`RECORD_ERROR: ${action.payload.error}`);\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\terror: action.payload.message\n\t\t\t};\n\n\t\t// Reset\n\t\tcase ACTION_TYPE.NEW_RECORD_RESET:\n\t\t\treturn initialState;\n\n\t\tdefault:\n\t\t\treturn state;\n\t}\n}\n","import initialState from './mapCache-initialState';\nimport * as ACTION_TYPE from '../../actions/action-types';\nimport * as TYPE from '../../types';\n\nexport default function app(state = initialState, action) {\n\tlet newState;\n\tswitch (action.type) {\n\n\t\t// Accepts an object of kvps, or an array of same\n\t\t// - replaces existing values\n\t\t// - ignores keys that don't start with 'o:'\n\t\tcase ACTION_TYPE.RECORD_CACHE_UPDATE:\n\n\t\t\tif(typeof action.payload === 'undefined'){\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tlet records=[];\n\t\t\tif(Array.isArray(action.payload)){\n\t\t\t\trecords=action.payload;\n\t\t\t}else{\n\t\t\t\trecords.push(action.payload.setValues);\n\t\t\t}\n\t\t\tlet newCache = records;\n\t\t\tif (records.length > 0) {\n\t\t\t\tnewCache = state.cache;\n\t\t\t\trecords.forEach(record => {\n\n\t\t\t\t\tlet recordID = record[\"o:id\"];\n\t\t\t\t\tif (typeof recordID === 'undefined') {\n\t\t\t\t\t\trecordID = TYPE.NEW_UNSAVED_RECORD;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (typeof newCache[recordID] === 'undefined') {\n\t\t\t\t\t\tnewCache[recordID] = {};\n\t\t\t\t\t}\n\n\t\t\t\t\t// Loop over and overwrite any o: values\n\t\t\t\t\tlet newValues = record;\n\t\t\t\t\tlet keys = Object.keys(newValues);\n\t\t\t\t\tfor (let idx = 0; idx < keys.length; idx++) {\n\t\t\t\t\t\tlet key = keys[idx];\n\t\t\t\t\t\tlet value = newValues[key];\n\t\t\t\t\t\tif (key.substring(0, 2) === 'o:' || key.substring(0, 1) === '@') {\n\t\t\t\t\t\t\tnewCache[recordID][key] = value;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\t\n\t\t\treturn{\n\t\t\t\t...state,\n\t\t\t\tcache:newCache\n\t\t\t}\n\n\t\tcase ACTION_TYPE.RECORD_CACHE_REMOVE_BY_ID:\n\t\t\tnewCache = state.cache;\n\t\t\tdelete newCache[action.payload];\n\t\t\treturn{\n\t\t\t\t...state,\n\t\t\t\tcache:newCache\n\t\t\t}\n\n\t\tcase ACTION_TYPE.RECORD_CACHE_CLEAR_UNSAVED:\n\t\t\tnewCache = state.cache;\n\t\t\tdelete newCache[-1];\n\t\t\treturn{\n\t\t\t\t...state,\n\t\t\t\tcache:newCache\n\t\t\t}\n\n\t\tcase ACTION_TYPE.RECORD_CACHE_REMOVE_RECORD:\n\t\t\tnewCache = state.cache;\n\t\t\tdelete newCache[action.payload.recordID];\n\t\t\treturn{\n\t\t\t\t...state,\n\t\t\t\tcache:newCache\n\t\t\t}\n\n\t\tcase ACTION_TYPE.RECORD_CACHE_CLEAR:\n\t\t\treturn{\n\t\t\t\t...state,\n\t\t\t\tcache:[]\n\t\t\t}\n\n\n\n\n\t\tcase ACTION_TYPE.HAS_UNSAVED_CHANGES:\n\t\t\tnewState = {\n\t\t\t\t...state,\n\t\t\t\thasUnsavedChanges:action.payload.hasUnsavedChanges\n\t\t\t};\n\t\t\treturn newState;\n\n\n\n\t\tcase ACTION_TYPE.EXHIBIT_PATCH_SUCCESS:\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\thasUnsavedChanges: false\n\t\t\t}\n\n\n\t\t// Set the tilelayer object based on an ID (array position)\n\t\tcase ACTION_TYPE.PREVIEW_BASELAYER:\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tcurrent: {\n\t\t\t\t\t...state.current,\n\t\t\t\t\t...action.payload,\n\t\t\t\t\ttileLayer: state.available.baseMaps[action.payload.id]\n\t\t\t\t}\n\t\t\t};\n\n\t\t// Create a subset of tilelayer objects based on array of IDs\n\t\tcase ACTION_TYPE.SET_AVAILABLE_TILELAYERS:\n\t\t\tlet availableOptions = [];\n\t\t\taction.payload.ids.forEach((thisID, key, map) => {\n\t\t\t\tavailableOptions.push(state.available.baseMaps[thisID]);\n\t\t\t});\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tcurrent: {\n\t\t\t\t\t...state.current,\n\t\t\t\t\tbasemapOptions: availableOptions\n\t\t\t\t}\n\t\t\t};\n\n\t\tdefault:\n\t\t\treturn state;\n\t}\n}\n","import initialState from './exhibitCache-initialState';\nimport * as ACTION_TYPE from '../../actions/action-types';\n\nexport default function app(state = initialState, action) {\n\tswitch (action.type) {\n\n\t\t// Accepts an object of kvps, replaces existing values\n\t\t// Ignores keys that don't start with 'o:'\n\t\tcase ACTION_TYPE.EXHIBIT_CACHE_UPDATE:\n\t\t\t// Loop over and overwrite any o: values\n\t\t\tlet newCache = state.cache;\n\t\t\tlet newValues=action.payload.setValues;\n\t\t\tlet keys = Object.keys(newValues);\n\t\t\tfor (let idx=0; idx < keys.length;idx++) {\n\t\t\t\tlet key = keys[idx];\n\t\t\t    let value = newValues[key];\n\t\t\t\tif(key.substring(0, 2) === 'o:' || key.substring(0, 1) === '@'){\n\t\t\t\t\tnewCache[key]=value;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn{\n\t\t\t\t...state,\n\t\t\t\tcache:newCache\n\t\t\t}\n\n\t\tdefault:\n\t\t\treturn state;\n\t}\n}\n","import {format} from 'date-fns';\n\nexport const exhibitsEndpoint = 'neatline_exhibits';\nexport const recordsEndpoint = 'neatline_records';\n\nexport const urlFormat = (endpoint, params = {}, id = null) => {\n\tconst apiRoot = '/api/';\n\tif (window.jwt && !params.hasOwnProperty('jwt') && (window.jwt !== null && window.jwt !== 'null') )\n\t\tparams.jwt = window.jwt;\n\tconst urlParams = new URLSearchParams(params);\n\tlet url = apiRoot + endpoint;\n\tif (id)\n\t\turl += '/' + id;\n\tlet paramsString = urlParams.toString();\n\tif (paramsString.length > 0)\n\t\turl += '?' + paramsString;\n\treturn url;\n}\n\nexport const parseExhibitsJSON = response => {\n\treturn response.json().then(exhibits => {\n\t\texhibits.forEach(exhibit => {\n\t\t\tif ('o:owner' in exhibit)\n\t\t\t\texhibit['o:owner'] = exhibit['o:owner']['@id'];\n\t\t\tif ('o:added' in exhibit)\n\t\t\t\texhibit['o:added'] = format(exhibit['o:added']['@value'], 'MMM D, YYYY');\n\t\t\t}\n\t\t);\n\t\treturn exhibits;\n\t});\n}\n\nexport const parseRecordsJSON = response => {\n\treturn response.json().then(records => {\n\t\trecords.forEach(formatRecord);\n\t\treturn records;\n\t});\n}\n\nexport const parseRecordJSON = response => {\n\treturn response.json().then(record => {\n\t\tformatRecord(record);\n\t\treturn record;\n\t});\n}\n\nconst formatRecord = record => {\n\tif ('o:owner' in record)\n\t\trecord['o:owner'] = record['o:owner']['@id'];\n\tif ('o:added' in record)\n\t\trecord['o:added'] = format(record['o:added']['@value'], 'MMM D, YYYY');\n\tif ('o:coverage' in record)\n\t\trecord['o:coverage'] = JSON.parse(record['o:coverage']);\n}\n","import { createBrowserHistory } from 'history';\nexport default createBrowserHistory();\n","import * as ACTION_TYPE from '../actions/action-types';\nimport {urlFormat, recordsEndpoint, exhibitsEndpoint, parseRecordsJSON,parseExhibitsJSON} from './api_helper.js';\nimport {put, takeLatest, all, select} from 'redux-saga/effects';\nimport {strings} from '../i18nLibrary';\nimport history from '../history';\nconst JSON_HEADERS = {\n\t'Accept': 'application/json',\n\t'Content-Type': 'application/json'\n}\n\nexport const getExhibits = (state) => state.exhibits.exhibits;\nexport const getExhibitCache = (state) => state.exhibitCache.cache;\nexport const getMapCache = (state) => state.mapCache.cache;\nexport const getSelectedRecord = (state) => state.exhibitShow.selectedRecord;\nexport const getRecords = (state) => state.exhibitShow.records;\n\nexport default function* rootSaga() {\n\tyield all([\n\t\ttakeLatest(ACTION_TYPE.RECORD_CREATE, createRecord),\n\t\ttakeLatest(ACTION_TYPE.CREATE_RECORD_RESPONSE_RECEIVED, createRecordResponseReceived),\n\n\t\ttakeLatest(ACTION_TYPE.RECORD_DELETE, deleteRecord),\n\t\ttakeLatest(ACTION_TYPE.DELETE_RECORD_RESPONSE_RECEIVED, deleteRecordResponseReceived),\n\n\t\ttakeLatest(ACTION_TYPE.RECORD_UPDATE, updateRecord),\n\t\ttakeLatest(ACTION_TYPE.UPDATE_RECORD_RESPONSE_RECEIVED, updateRecordResponseReceived),\n\n\n\t\ttakeLatest(ACTION_TYPE.EXHIBIT_FETCH, fetchExhibits),\n\t\ttakeLatest(ACTION_TYPE.EXHIBIT_FETCH_RESPONSE_RECEIVED, fetchExhibitsResponseReceived),\n\n\n\t\ttakeLatest(ACTION_TYPE.RECORDS_FETCH, fetchRecords),\n\t\ttakeLatest(ACTION_TYPE.RECORDS_FETCH_RESPONSE_RECEIVED, fetchRecordsResponseReceived),\n\t\t// takeLatest(ACTION_TYPE.RECORDS_FILTER, filterRecords),\n\n\n\t\ttakeLatest(ACTION_TYPE.RECORD_FETCH_BY_SLUG, fetchRecordsBySlug),\n\t\ttakeLatest(ACTION_TYPE.EXHIBIT_UPDATE, updateExhibit),\n\t\ttakeLatest(ACTION_TYPE.EXHIBIT_UPDATE_RESPONSE_RECEIVED, updateExhibitResponseReceived),\n\n\t\ttakeLatest(ACTION_TYPE.RECORD_SELECTED, selectRecord),\n\t\ttakeLatest(ACTION_TYPE.RECORD_DESELECTED, deselectRecord),\n\n\t\ttakeLatest(ACTION_TYPE.RECORD_CACHE_UPDATE_AND_SAVE, updateRecordCacheAndSave),\n\t\ttakeLatest(ACTION_TYPE.EXHIBIT_CACHE_SAVE, saveCacheToDatabase),\n\n\t\ttakeLatest(ACTION_TYPE.EVENT_REFRESH_MAP_GEOMETRY, requestMapRefreshGeometry),\n\t\ttakeLatest(ACTION_TYPE.EVENT_REFRESH_MAP, requestMapRefresh)\n\n    // commenting out for now as HAS_UNSAVED_CHANGES fires frequently during editing and doesn't appear to require a map refresh in most cases (akstuhl)\n\t\t// takeLatest(ACTION_TYPE.HAS_UNSAVED_CHANGES, requestMapRefresh)\n\t])\n}\n\n\nfunction* createRecord(action) {\n\t// Make API call\n\ttry {\n\t\tlet url = urlFormat(recordsEndpoint);\n\t\tconst response = yield fetch(url, {\n\t\t\tmethod: 'POST',\n\t\t\theaders: JSON_HEADERS,\n\t\t\tbody: JSON.stringify(action.payload)\n\t\t});\n\t\tlet response_json = yield response.json();\n\t\tyield put({type: ACTION_TYPE.CREATE_RECORD_RESPONSE_RECEIVED, payload: response_json});\n\n\t// Failed on the fetch call (timeout, etc)\n\t} catch (e) {\n\t\tyield put({\n\t\t\ttype: ACTION_TYPE.RECORD_ERROR,\n\t\t\tpayload: {\n\t\t\t\trecord: '',\n\t\t\t\tmessage: strings.create_record_error,\n\t\t\t\terror: e\n\t\t\t}\n\t\t});\n\t}\n\n}\n\nfunction* selectRecord(action){\n\tlet exhibit = yield select(getExhibitCache);\n\tlet slug = exhibit['o:slug'];\n\tlet url = (typeof window.baseRoute !== 'undefined')?`${window.baseRoute}`:\"\";\n\t    url += `/show/${slug}/edit/${action.payload.record['o:id']}`;\n\thistory.replace(url);\n}\n\nfunction* deselectRecord(){\n\tlet exhibit = yield select(getExhibitCache);\n\tlet slug = exhibit['o:slug'];\n\tlet url = (typeof window.baseRoute !== 'undefined')?`${window.baseRoute}`:\"\";\n\t    url += `/show/${slug}`;\n\thistory.replace(url);\n\tyield put({type: ACTION_TYPE.EVENT_REFRESH_MAP_GEOMETRY});\n}\n\nfunction* createRecordResponseReceived(action) {\n\t// On success...\n\tif (typeof action.payload.errors === 'undefined') {\n\t\tyield put({type: ACTION_TYPE.RECORD_CACHE_UPDATE, payload:{\n\t\t\tsetValues:{\n\t\t\t\t'o:id': action.payload['o:id'],\n\t\t\t\t'o:coverage': action.payload['o:coverage'],\n\t\t\t\t'o:is_coverage': action.payload['o:is_coverage'],\n\t\t\t\t'o:fill_color': 'FF00FF'\n\t\t\t}}\n\t\t});\n\t\tyield put({type: ACTION_TYPE.EDITOR_CLOSE_NEW_RECORD});\n\t\tyield put({type: ACTION_TYPE.RECORD_ADDED, record:action.payload});\n\t\tyield put({type: ACTION_TYPE.RECORD_SELECTED, payload:{record:action.payload}});\n\n\n\t// On failure...\n\t} else {\n    console.log('!! failure response received for createRecord');\n  }\n}\n\nfunction* deleteRecord(action) {\n\tlet record = action.payload;\n\tif (window.confirm(strings.formatString(strings.record_delete_confirmation, record['o:title']))) {\n\n\t\t// Make API call\n\t\ttry {\n\t\t\tconst response = yield fetch(urlFormat(recordsEndpoint, {}, record['o:id']), {method: 'DELETE'});\n\t\t\tlet response_json = yield response.json();\n\t\t\tlet newPayload = {\n\t\t\t\tjsonResponse: response_json,\n\t\t\t\trecord: action.payload\n\t\t\t}\n\t\t\tyield put({type: ACTION_TYPE.DELETE_RECORD_RESPONSE_RECEIVED, payload: newPayload});\n\n\t\t// Failed on the fetch call (timeout, etc)\n\t\t} catch (e) {\n\t\t\tyield put({\n\t\t\t\ttype: ACTION_TYPE.RECORD_ERROR,\n\t\t\t\tpayload: {\n\t\t\t\t\trecord: record,\n\t\t\t\t\tmessage: strings.delete_record_error,\n\t\t\t\t\terror: e\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n}\n\n\n\n\nfunction* deleteRecordResponseReceived(action) {\n\t// On success...\n\tif (typeof action.payload.jsonResponse.errors === 'undefined') {\n\t\tyield put({type: ACTION_TYPE.RECORD_REMOVED, record: action.payload.record});\n\t\tyield put({type: ACTION_TYPE.RECORD_CACHE_REMOVE_BY_ID, payload:action.payload.record['o:id']});\n\n\t}\n\tyield put({type: ACTION_TYPE.RECORD_DESELECTED});\n}\n\nfunction* updateRecord(action) {\n\tlet record = action.payload;\n\ttry {\n\t\tlet url = urlFormat(recordsEndpoint, {}, record['o:id']);\n\t\tconst response = yield fetch(url, {\n\t\t\tmethod: 'PATCH',\n\t\t\theaders: JSON_HEADERS,\n\t\t\tbody: JSON.stringify(record)\n\t\t});\n\t\tlet response_json = yield response.json();\n\t\tyield put({type: ACTION_TYPE.UPDATE_RECORD_RESPONSE_RECEIVED, payload: response_json});\n\n\t// Failed on the fetch call (timeout, etc)\n\t} catch (e) {\n\t\tyield put({\n\t\t\ttype: ACTION_TYPE.RECORD_ERROR,\n\t\t\tpayload: {\n\t\t\t\trecord: record,\n\t\t\t\tmessage: strings.update_record_error,\n\t\t\t\terror: e\n\t\t\t}\n\t\t});\n\t}\n}\n\nfunction* updateRecordResponseReceived(action) {\n\t// On success...\n\tif (typeof action.payload.errors === 'undefined') {\n\t\tyield put({type: ACTION_TYPE.RECORD_REPLACED, record: action.payload});\n\t}\n\n  // commenting out for now -- what is deselection intended to accomplish here? (akstuhl)\n\t// yield put({type: ACTION_TYPE.RECORD_DESELECTED});\n\n\tyield put({type: ACTION_TYPE.LEAFLET_IS_EDITING, payload: false});\n}\n\nfunction requestMapRefreshGeometry(action){\n\tvar event = new CustomEvent(\"refreshMapGeometry\");\n\tdocument.dispatchEvent(event);\n}\nfunction requestMapRefresh(action){\n\tvar event = new CustomEvent(\"refreshMap\");\n\tdocument.dispatchEvent(event);\n}\n\nfunction* fetchExhibits(action) {\n\ttry {\n\t\tyield put({type: ACTION_TYPE.EXHIBITS_LOADING,payload: {loading: true}});\n\t\tlet url = urlFormat(exhibitsEndpoint);\n\t\tconst response = yield fetch(url);\n\t\tyield put({type: ACTION_TYPE.EXHIBIT_FETCH_RESPONSE_RECEIVED, payload: {response:response}});\n\n\t// Failed on the fetch call (timeout, etc)\n\t} catch (e) {\n    console.log(e);\n\t\tyield put({type: ACTION_TYPE.EXHIBITS_LOADING,payload: {loading: false}});\n\t\tyield put({type: ACTION_TYPE.EXHIBITS_ERRORED, payload: e});\n\t}\n}\n\nfunction* fetchExhibitsResponseReceived(action) {\n\tyield put({type: ACTION_TYPE.EXHIBITS_LOADING, payload: {loading: false}});\n\n\t// On success...\n\tif (action.payload.response.status === 200) {\n\t\tlet exhibits = yield parseExhibitsJSON(action.payload.response);\n\t\tyield put({type: ACTION_TYPE.EXHIBITS_FETCH_SUCCESS, payload:exhibits});\n\n\t// On failure...\n\t} else {\n\t\tyield put({type: ACTION_TYPE.EXHIBITS_ERRORED, payload: action.payload.response});\n\t}\n}\n\nfunction* updateExhibit(action) {\n\ttry {\n\t\tlet exhibit = action.payload;\n\t\tlet url = urlFormat(exhibitsEndpoint, {}, exhibit['o:id']);\n\t\tconst response = yield fetch(url, {\n\t\t\theaders: {\n\t\t\t\t'Accept': 'application/json',\n\t\t\t\t'Content-Type': 'application/json'\n\t\t\t},\n\t\t\tmethod: 'PATCH',\n\t\t\tbody: JSON.stringify(exhibit)\n\t\t});\n\t\tyield put({\n\t\t\ttype: ACTION_TYPE.EXHIBIT_UPDATE_RESPONSE_RECEIVED,\n\t\t\tpayload: {\n\t\t\t\tresponse: response,\n\t\t\t\texhibit: exhibit\n\t\t\t}\n\t\t});\n\n\t} catch (e) {\n\t\tyield put({\n\t\t\ttype: ACTION_TYPE.RECORD_ERROR,\n\t\t\tpayload: {\n\t\t\t\terror: e\n\t\t\t}\n\t\t});\n\t}\n}\n\nfunction* updateExhibitResponseReceived(action) {\n\tlet exhibit = action.payload.exhibit;\n\tif (typeof action.payload.errors === 'undefined') {\n\t\tyield put({type: ACTION_TYPE.EXHIBIT_PATCH_SUCCESS});\n\t\tyield put({type: ACTION_TYPE.EXHIBIT_LOADED, payload: exhibit});\n\t\tyield put({type: ACTION_TYPE.EXHIBIT_FETCH});\n\t} else {\n\t\tyield put({type: ACTION_TYPE.EXHIBIT_PATCH_ERRORED});\n\t\tthrow Error(action.payload.response.statusText);\n\t}\n}\n\nfunction* fetchRecordsBySlug(action) {\n\tlet slug = action.payload;\n\tlet exhibits = yield select(getExhibits);\n\tif (exhibits && exhibits.length > 0) {\n\t\tlet exhibit = exhibits.filter(e => e['o:slug'] === slug)[0];\n\t\tyield put({ type: ACTION_TYPE.RECORDS_LOADING, payload: true});\n\t\tyield put({type: ACTION_TYPE.EXHIBIT_LOADED, payload: exhibit});\n\t\tyield put({type: ACTION_TYPE.EXHIBIT_CACHE_UPDATE, payload:{setValues:exhibit}});\n\t\tyield put({type: ACTION_TYPE.RECORDS_FETCH, payload: exhibit});\n\n\t\t// FIXME: this could be a lot more efficient, an it's not great to\n\t\t// unpack the type like this\n\t\tlet baselayerType=\"MAP\";\n\t\tswitch (exhibit['o:exhibit_type']) {\n\t\t\tcase 1:\n\t\t\t\tbaselayerType=\"IMAGE\";\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\t\tbaselayerType=\"WMS\";\n\t\t\t\tbreak;\n\t\t\tcase 3:\n\t\t\t\tbaselayerType=\"TILE\";\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t}\n\t\tyield put({ type: ACTION_TYPE.PREVIEW_BASELAYER,\n\t\t\t\t\tpayload:{\n\t\t\t\t\t\tid: exhibit['o:exhibit_type'],\n\t\t\t\t\t\timage_address: exhibit['o:image_layer'],\n\t\t\t\t\t\timage_attribution: exhibit['o:image_attribution'],\n\t\t\t\t\t\timage_layer:  exhibit['o:image_layer'],\n\t\t\t\t\t\ttile_address: exhibit['o:tile_address'],\n\t\t\t\t\t\ttile_attribution: exhibit['o:tile_attribution'],\n\t\t\t\t\t\ttype: baselayerType,\n\t\t\t\t\t\twms_address: exhibit['o:wms_address'],\n\t\t\t\t\t\twms_attribution: exhibit['o:wms_attribution'],\n\t\t\t\t\t\twms_layers: exhibit['o:wms_layers']\n\t\t\t\t\t}});\n\n\n\t}\n}\n\n\nfunction* fetchRecords(action) {\n\tyield put({ type: ACTION_TYPE.RECORDS_LOADING, payload: true});\n\n\ttry {\n\t\tlet url = urlFormat(recordsEndpoint, {exhibit_id: action.payload['o:id']});\n\t\tconst response = yield fetch(url);\n\t\tyield put({type: ACTION_TYPE.RECORDS_FETCH_RESPONSE_RECEIVED, payload: {response:response}});\n\n\t// Failed on the fetch call (timeout, etc)\n\t} catch (e) {\n\t\t//yield put({type: ACTION_TYPE.RECORDS_LOADING,payload: {loading: false}});\n\t\tyield put({ type: ACTION_TYPE.RECORD_ERROR, payload: {message: 'error',error: e}});\n\t}\n\n}\n\nfunction* fetchRecordsResponseReceived(action) {\n\tif (typeof action.payload.errors === 'undefined') {\n\t\tlet records = yield parseRecordsJSON(action.payload.response);\n\t\tyield put({type: ACTION_TYPE.RECORD_CACHE_UPDATE, payload:records});\n\t\tyield put({type: ACTION_TYPE.RECORDS_FETCH_SUCCESS, payload:records});\n\t\tyield put({ type: ACTION_TYPE.RECORDS_FILTER, payload: records })\n\n\t} else {\n\t\tyield put({type: ACTION_TYPE.RECORD_ERROR});\n\t\tthrow Error(action.payload.response.statusText);\n\t}\n}\n\n// function* filterRecords(action) {\n// \tyield put({ type: ACTION_TYPE.RECORDS_FILTER, payload: action.payload });\n// }\n\n\n\nfunction* updateRecordCacheAndSave(action) {\n\tyield put({type: ACTION_TYPE.RECORD_CACHE_UPDATE, payload:action.payload});\n\tyield put({type: ACTION_TYPE.EXHIBIT_CACHE_SAVE, payload:action.payload});\n\tyield put({type: ACTION_TYPE.EVENT_REFRESH_MAP_GEOMETRY});\n}\n\nfunction* saveCacheToDatabase(action) {\n\tyield put({type: ACTION_TYPE.LEAFLET_IS_SAVING, payload: true});\n\n\tlet exhibit = yield select(getExhibitCache);\n\tlet records = yield select(getMapCache);\n\tlet selectedRecord = action.payload.selectedRecord;\n\tlet isNewRecord=false;\n\n\t// Create if there's a new one\n\tif (typeof records[-1] !== 'undefined') {\n\t\tisNewRecord=true;\n\t\tlet newRecord = records[-1];\n\t\tif(newRecord[\"o:exhibit\"] !== 'undefined'){\n\t\t\tyield put({type: ACTION_TYPE.RECORD_CREATE, payload: newRecord});\n\t\t}\n\t}\n\n\t// Clear temp cache item\n\tyield put({type: ACTION_TYPE.RECORD_CACHE_CLEAR_UNSAVED});\n\n\n  // FIXME: TO BE RESOLVED - this was causing all kinds of trouble because all records get updated every time anything happens, and then between the saga/takeLatest flow and the reducer's assingment of the response object to exhibitShow.editorRecord, the record selection would change counterintuitively; all that said, I guess we want to be able to do something like this in theory, so maybe the problem should be fixed in the response handler (reducer) stage\n\t// Update records\n\tfor (let x=0; x<records.length; x++) {\n\t\tlet thisRecord = records[x];\n\t\tif (typeof thisRecord !== 'undefined') {\n\t\t\tyield put({type: ACTION_TYPE.RECORD_UPDATE, payload: thisRecord});\n\t\t}\n\t}\n\n\t// Save the exhibit\n\tif (typeof exhibit !== 'undefined') {\n\t\tyield put({type: ACTION_TYPE.EXHIBIT_UPDATE, payload: exhibit});\n\t}\n\n  // why do we deselect then select here?\n\tif(typeof selectedRecord !== 'undefined' && selectedRecord !== null && !isNewRecord){\n\t\tyield put({type: ACTION_TYPE.RECORD_DESELECTED});\n\t\tyield put({type: ACTION_TYPE.RECORD_SELECTED, payload:{record:selectedRecord}});\n\t}\n\n\tyield put({type: ACTION_TYPE.RECORDS_FETCH, payload: exhibit});\n\n\tyield put({type: ACTION_TYPE.LEAFLET_IS_SAVING, payload: false});\n\n}\n","import { createStore, applyMiddleware, compose } from 'redux';\nimport thunk from 'redux-thunk';\nimport createSagaMiddleware from 'redux-saga'\nimport rootReducer from './reducers';\nimport rootSaga from './sagas'\n\n\n\nconst initialState = {};\nconst enhancers = [];\nconst middleware = [\n  thunk\n];\n\nif (process.env.NODE_ENV === 'development') {\n  const devToolsExtension = window.devToolsExtension;\n\n  if (typeof devToolsExtension === 'function') {\n    enhancers.push(devToolsExtension());\n  }\n}\n\nconst sagaMiddleware = createSagaMiddleware();\nconst composedEnhancers = compose(\n  applyMiddleware(...middleware),\n  applyMiddleware(sagaMiddleware),\n  ...enhancers\n);\n\nconst store = createStore(\n  rootReducer,\n  initialState,\n  composedEnhancers\n);\n\nsagaMiddleware.run(rootSaga);\nexport default store;\n","import * as ACTION_TYPE from './action-types';\nimport {urlFormat, exhibitsEndpoint} from '../sagas/api_helper.js';\nimport history from '../history';\nimport { strings } from '../i18nLibrary';\n\nfunction action(type, payload = {}) {return {type, payload}}\n\n\nexport const preview_baseLayer = (payload) => action(ACTION_TYPE.PREVIEW_BASELAYER, payload);\nexport const set_availableTileLayers = (payload) => action(ACTION_TYPE.SET_AVAILABLE_TILELAYERS, payload);\n\nexport const createRecord = (payload) => action(ACTION_TYPE.RECORD_CREATE, payload);\nexport const updateRecord = (payload) => action(ACTION_TYPE.RECORD_UPDATE, payload);\nexport const deleteRecord = (payload) => action(ACTION_TYPE.RECORD_DELETE, payload);\n\nexport const setUnsavedChanges = (payload) => action(ACTION_TYPE.HAS_UNSAVED_CHANGES, payload);\n\nexport const updateRecordCache = (payload) => action(ACTION_TYPE.RECORD_CACHE_UPDATE, payload);\nexport const updateRecordCacheAndSave = (payload) => action(ACTION_TYPE.RECORD_CACHE_UPDATE_AND_SAVE, payload);\n\nexport const updateExhibitCache = (payload) => action(ACTION_TYPE.EXHIBIT_CACHE_UPDATE, payload);\nexport const recordCacheToDatabase = (payload) => action(ACTION_TYPE.EXHIBIT_CACHE_SAVE, payload);\n\nexport const clearRecordCache = () => action(ACTION_TYPE.RECORD_CACHE_CLEAR);\nexport const removeRecordFromCache = (payload) => action(ACTION_TYPE.RECORD_CACHE_REMOVE_RECORD, payload);\nexport const clearUnsavedRecordCache = () => action(ACTION_TYPE.RECORD_CACHE_CLEAR_UNSAVED);\n\n\nexport const leafletIsEditing = (payload) => action(ACTION_TYPE.LEAFLET_IS_EDITING, payload);\nexport const leafletIsSaving = (payload) => action(ACTION_TYPE.LEAFLET_IS_SAVING, payload);\n\nexport const fetchExhibits = () => action(ACTION_TYPE.EXHIBIT_FETCH);\nexport const updateExhibit = (payload) => action(ACTION_TYPE.EXHIBIT_UPDATE, payload);\n\nexport const resetExhibit = () => action(ACTION_TYPE.EXHIBIT_RESET);\n\nexport const previewRecord = (payload) => action(ACTION_TYPE.RECORD_PREVIEWED, payload);\nexport const unpreviewRecord = () => action(ACTION_TYPE.RECORD_UNPREVIEWED);\nexport const openEditorToNewRecord = () => action(ACTION_TYPE.EDITOR_NEW_RECORD);\nexport const setTabIndex = (payload) => action(ACTION_TYPE.TAB_INDEX_SET, payload);\nexport const setCurrentRecordCoverage = (payload) => action(ACTION_TYPE.RECORD_COVERAGE_SET, payload);\n\nexport const selectRecord = (payload) => action(ACTION_TYPE.RECORD_SELECTED, payload);\nexport const deselectRecord = (payload) => action(ACTION_TYPE.RECORD_DESELECTED, payload);\nexport const fetchRecordsBySlug = (payload) => action(ACTION_TYPE.RECORD_FETCH_BY_SLUG, payload);\nexport const filterRecords = (payload) =>  action(ACTION_TYPE.RECORDS_FILTER, payload);\nexport const setShowRecords = (payload) => action(ACTION_TYPE.SHOW_RECORDS, payload);\n\nexport const setShowExhibitSettings = (payload) => action(ACTION_TYPE.SHOW_EXHIBIT_SETTINGS, payload);\n\nexport const setRecordEditorType = (payload) => action(ACTION_TYPE.RECORD_EDITOR_TYPE, payload);\n\n// FIXME:  Here be dragons\n// The code below is old and needs to be refactored so that it behaves like proper action dispatcher + saga (follow pattern above)\nexport const deleteExhibit = (exhibit) => {\n\treturn function(dispatch) {\n\t\tif (window.confirm(strings.formatString(strings.exhibit_delete_confirmation, exhibit['o:title']))) {\n\t\t\tdispatch({type: ACTION_TYPE.EXHIBIT_DELETED, exhibit});\n\n\t\t\tfetch(urlFormat(exhibitsEndpoint, {}, exhibit['o:id']), {method: 'DELETE'}).then(response => {\n\t\t\t\tif (!response.ok) {\n\t\t\t\t\tthrow Error(response.statusText);\n\t\t\t\t}\n\t\t\t}).then(() => dispatch({type: ACTION_TYPE.EXHIBIT_DELETE_SUCCESS})).then(() => dispatch(fetchExhibits())).catch(() => dispatch({type: ACTION_TYPE.EXHIBIT_DELETE_ERRORED}));\n\t\t}\n\t}\n}\n\nexport const createExhibit = (exhibit) => {\n\treturn function(dispatch) {\n\t\tdispatch({type: ACTION_TYPE.EXHIBIT_CREATED, exhibit});\n\n\t\tfetch(urlFormat(exhibitsEndpoint), {\n\t\t\theaders: {\n\t\t\t\t'Accept': 'application/json',\n\t\t\t\t'Content-Type': 'application/json'\n\t\t\t},\n\t\t\tmethod: 'POST',\n\t\t\tbody: JSON.stringify(exhibit)\n\t\t}).then(response => {\n\t\t\tif (!response.ok) {\n\t\t\t\tthrow Error(response.statusText);\n\t\t\t}\n\t\t}).then(() => dispatch({type: ACTION_TYPE.EXHIBIT_POST_SUCCESS})).then(() => history.push(`${window.baseRoute}/`)).catch(() => dispatch({type: ACTION_TYPE.EXHIBIT_POST_ERRORED}));\n\t}\n}\n","import React, { Component } from 'react';\nimport { Link } from 'react-router-dom';\nimport { bindActionCreators } from 'redux';\nimport { connect } from 'react-redux';\nimport { Menu, Button, Icon } from 'semantic-ui-react';\n//import { fetchExhibits } from '../../reducers/not_refactored/exhibits';\nimport { resetExhibit } from '../../actions';\nimport { deleteExhibit } from '../../actions';\nimport { strings } from '../../i18nLibrary';\nimport history from '../../history';\nimport {fetchExhibits} from '../../actions';\nimport _ from 'lodash';\n\nclass Exhibits extends Component {\n\n  componentWillMount() {\n\t\tthis.props.dispatch(fetchExhibits());\n    this.props.dispatch(resetExhibit());\n    this.setState({ column: null, direction: null});\n  }\n\n  createExhibitView =  () => {\n\t  history.push(`${window.baseRoute}/add`);\n  }\n\n  handleSort = (clickedColumn) => () => {\n    const { column, direction } = this.state\n\n    if (column !== clickedColumn) {\n      this.setState({\n        column: clickedColumn,\n        exhibits: this.props.exhibits.sort(function(a, b) {\n          if (clickedColumn === 'o:title' || clickedColumn === 'o:owner'){\n            return a[clickedColumn].toUpperCase().localeCompare(b[clickedColumn].toUpperCase());\n          } \n          if (clickedColumn === 'o:added'){\n            return new Date(a[clickedColumn]) - new Date(b[clickedColumn]);\n          } \n          if (clickedColumn === 'o:public'){\n            return (a[clickedColumn] === b[clickedColumn])? 0 : a[clickedColumn] ? -1 : 1;\n          } else {\n            return new Date(a['o:added']) - new Date(b['o:added']);\n          }\n        }),\n        direction: 'ascending',\n      })\n      return\n    }\n\n    this.setState({\n      exhibits: this.props.exhibits.reverse(),\n      direction: direction === 'ascending' ? 'descending' : 'ascending',\n    })\n  }\n\n\n  render() {\n    const props = this.props;\n    const state = this.state;\n    const changeLanguage = lng => {\n      strings.setLanguage(lng);\n      this.setState({});\n    }\n    const allLanguages = strings.getAvailableLanguages();\n    const lngButtons = allLanguages.map((lng) =>\n        <Button key={lng} onClick={() => changeLanguage(lng)}>{lng}</Button>\n    );\n    const showFullViewLinks = window.containerFullMode === false && window.containerFullModeBaseRoute;\n\t\tconst showReturnLink = !showFullViewLinks && window.containerFullMode === true && window.containerReturnBaseRoute;\n\n    return (\n      <div>\n        <Menu stackable>\n        <Menu.Item header as={Link} to={`${window.baseRoute}/`}>\n          <span className=\"neatline-subhead\">Neatline</span>\n        </Menu.Item>\n        <Menu.Item><h1 className=\"neatline-title\">{strings.browseExhibit}</h1></Menu.Item>\n        {showReturnLink &&\n        <Menu.Item>\n\t\t\t\t\t\t<a title=\"Return to Omeka Admin\" href={`${window.containerReturnBaseRoute}`} aria-label=\"Return to Omeka Admin\"><Icon name='compress' size='large'/></a>\n        </Menu.Item>\n        }\n        {/* {showFullViewLinks &&\n        <Menu.Item>\n\t\t\t\t\t\t<a title=\"Fullscreen Editor\" href={`${window.containerFullModeBaseRoute}`} aria-label=\"Fullscreen Editor\"><Icon name='external alternate' size='large'/></a>\n        </Menu.Item>\n        } */}\n        <Menu.Item position='right'><div>\n              {props.userSignedIn &&\n                <Button\n                  icon\n                  onClick={this.createExhibitView}\n                >\n                  {strings.createExhibit}\n                   <Icon name=\"plus\" />\n                </Button>\n              }\n          {lngButtons}\n        </div></Menu.Item>\n        </Menu>\n        <table className=\"tablesaw neatline tablesaw-stack\" > \n          <thead>\n            <tr>\n              <th \n                className={state.column === 'o:title' ? state.direction : null}\n                onClick={this.handleSort('o:title')}\n              >{strings.title} </th>\n              <th \n                className={state.column === 'o:added' ? state.direction : null}\n                onClick={this.handleSort('o:added')}\n              >{strings.created} </th>\n              <th\n                className={state.column === 'o:public' ? state.direction : null}\n                onClick={this.handleSort('o:public')}              \n              >{strings.public} </th>\n              <th\n                className={state.column === 'o:owner' ? state.direction : null}\n                onClick={this.handleSort('o:owner')}                \n              >{strings.owner} </th>\n            </tr>\n          </thead>\n          <tbody>\n            {_.map(props.exhibits, (exhibit, idx) => (\n              <tr key={idx}>\n                <td>\n                  <b className=\"tablesaw-cell-label\">{strings.title}</b>\n                  <span className=\"tablesaw-cell-content\">\n                  <Link className='ps_n3_exhibitTitle' to={`${window.baseRoute}/show/${exhibit['o:slug']}`} >{exhibit['o:title']}</Link>\n                  <ul className=\"actions neatline\">\n                    {showFullViewLinks &&\n                    <li><a title=\"Fullscreen Editor\" href={`${window.containerFullModeBaseRoute}/show/${exhibit['o:slug']}`} aria-label=\"Fullscreen Editor\"><Icon name=\"external alternate\"/></a></li>\n                    }\n                    <li><a title=\"Edit\" href={`${window.baseRoute}/show/${exhibit['o:slug']}`} aria-label=\"Edit\"><Icon name=\"pencil alternate\" /></a></li>\n                    {props.userSignedIn &&\n                    <li>\n                      <a onClick={() => { props.deleteExhibit(exhibit); }} disabled={props.deleteInProgress} ><Icon name=\"trash alternate\"/></a>\n                    </li>\n                    }\n                  </ul>\n                  </span>\n                </td>\n                <td>\n                  <b className=\"tablesaw-cell-label\">{strings.created}</b>\n                  <span className=\"tablesaw-cell-content\">{exhibit['o:added']}</span>\n                </td>\n                <td>\n                  <b className=\"tablesaw-cell-label\">{strings.public}</b>\n                  <span className=\"tablesaw-cell-content\">{exhibit['o:public'] ? strings.yes : strings.no}</span>\n                </td>\n                <td>\n                  <b className=\"tablesaw-cell-label\">{strings.owner}</b>\n                  <span className=\"tablesaw-cell-content\">\n                    {exhibit['o:owner']}\n                    </span>\n                </td>\n              </tr>\n            ))}\n          </tbody>\n        </table>\n        {props.deleteErrored &&\n          <p>{strings.delete_exhibit_error}</p>\n        }\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = state => ({\n  userSignedIn: state.user.userSignedIn,\n  exhibits: state.exhibits.exhibits,\n  exhibitsLoading: state.exhibits.loading,\n  exhibitsErrored: state.exhibits.errored,\n  deleteInProgress: state.exhibitDelete.loading,\n  deleteErrored: state.exhibitDelete.errored\n});\n\nconst mapDispatchToProps = dispatch => bindActionCreators({\n  fetchExhibits,\n  resetExhibit,\n  deleteExhibit,\n  dispatch\n}, dispatch);\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(Exhibits);\n","import React, {Component} from 'react';\nimport {bindActionCreators} from 'redux';\nimport history from '../../history';\nimport {Field, reduxForm, change, formValueSelector} from 'redux-form'\nimport {connect} from 'react-redux';\nimport { Button, Form } from 'semantic-ui-react'\nimport {\n\tpreview_baseLayer,\n\tset_availableTileLayers,\n\tsetUnsavedChanges,\n\tupdateExhibitCache} from '../../actions';\nimport * as TYPE from '../../types';\n\nclass ExhibitForm extends Component {\n\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.set_availableTileLayers = set_availableTileLayers;\n\t\tthis.exhibit = props.exhibit;\n\t\tthis.handleSubmit = props.handleSubmit;\n\t\tthis.submitLabel = props.submitLabel;\n\t\tthis.disabled = props.disabled;\n\t\tthis.layerTypeOptions = this.buildLayerTypeOptions();\n\t\tthis.currentSlug='';\n\t\tthis.state={\n\t\t\texhibitType:TYPE.EXHIBIT_TYPE.MAP,\n\t\t\tbaseLayerType:TYPE.BASELAYER_TYPE.MAP,\n\t\t\tisNewExhibit:true,\n\t\t};\n\t}\n\n\tcomponentDidMount(){\n\t\t// Is this a new (add) or existing (edit) version of this form?\n\t\tlet isNewExhibit = (typeof this.props.initialValues['o:exhibit_type'] === 'undefined');\n\t\tlet exhibitType = (typeof this.props.initialValues['o:exhibit_type'] === 'undefined')?TYPE.EXHIBIT_TYPE.MAP:this.props.initialValues['o:exhibit_type'];\n\n\t\t// Init form field\n\t\tthis.props.change('o:exhibit_type', exhibitType);\n\n\t\t// Update the layer preview with initial values\n\t\tthis.updateLayerPreview({\n\t\t\texhibit_type:this.props.initialValues['o:exhibit_type'],\n\t\t\tspatial_layer:(exhibitType === TYPE.EXHIBIT_TYPE.MAP)?this.props.initialValues['o:spatial_layer']:TYPE.BASELAYER_TYPE.IMAGE,\n\n\t\t\twms_address:this.props.initialValues['o:wms_address'],\n\t\t\twms_layers:this.props.initialValues['o:wms_layers'],\n\t\t\twms_attribution:this.props.initialValues['o:wms_attribution'],\n\n\t\t\timage_layer:this.props.initialValues['o:image_layer'],\n\t\t\timage_address:this.props.initialValues['o:image_layer'],\n\t\t\timage_attribution:this.props.initialValues['o:image_attribution'],\n\n\t\t\ttile_address:this.props.initialValues['o:tile_address'],\n\t\t\ttile_attribution:this.props.initialValues['o:tile_attribution']\n\t\t});\n\n\t\t// Update the state\n\t\tthis.setState({\n\t\t\texhibitType:exhibitType,\n\t\t\tisNewExhibit:isNewExhibit\n\t\t});\n\n\t\t// Set the slug for the router\n\t\tthis.setState({currentSlug:this.props.initialValues['o:slug']})\n\n\t\t// Reset save warning\n\t\tthis.props.dispatch(setUnsavedChanges({hasUnsavedChanges:false}));\n\t}\n\n\t// Update the live-preview of the spatial layer\n\tonSpatialLayerInfoChange = (event) => {\n\t\tlet payload={\n\t\t\tspatial_layer:(event.target.name === \"o:spatial_layer\")?event.target.value:formSelector(this.props.state, 'o:spatial_layer'),\n\n\t\t\twms_address:(event.target.name === \"o:wms_address\")?event.target.value:formSelector(this.props.state, 'o:wms_address'),\n\t\t\twms_layers:(event.target.name === \"o:wms_layers\")?event.target.value:formSelector(this.props.state, 'o:wms_layers'),\n\t\t\twms_attribution:(event.target.name === \"o:wms_attribution\")?event.target.value:formSelector(this.props.state,'o:wms_attribution'),\n\n\t\t\timage_address:(event.target.name === \"o:image_layer\")?event.target.value:formSelector(this.props.state, 'o:image_layer'),\n\t\t\timage_attribution:(event.target.name === \"o:image_attribution\")?event.target.value:formSelector(this.props.state,'o:image_attribution'),\n\n\t\t\ttile_address:(event.target.name === \"o:tile_address\")?event.target.value:formSelector(this.props.state, 'o:tile_address'),\n\t\t\ttile_attribution:(event.target.name === \"o:tile_attribution\")?event.target.value:formSelector(this.props.state, 'o:tile_attribution')\n\t\t};\n\n\t\t// If we're editing a property of image, ensure that's what baselayer we're on\n\t\tif((event.target.name === \"o:image_layer\") || (event.target.name === \"o:image_attribution\")){\n\t\t\tpayload.spatial_layer=TYPE.BASELAYER_TYPE.IMAGE;\n\t\t}\n\t\tthis.updateLayerPreview(payload);\n\t\tthis.markUnsaved(event, { 'name': event.target.name, 'value':event.target.value});\n\t}\n\n\tupdateLayerPreview = (payload) =>{\n\n\t\t// Set type...\n\t\t// If it's a number, it's an id of a map, otherwise it's IMAGE or WMS\n\t\tlet baseLayerType=payload.spatial_layer;\n\t\tif(!isNaN(payload.spatial_layer)){\n\t\t\tbaseLayerType=TYPE.BASELAYER_TYPE.MAP;\n\t\t}\n\n\t\t// Update local state and preview via redux\n\t\tthis.setState({baseLayerType:baseLayerType});\n\t\tthis.props.dispatch(\n\t\t\tpreview_baseLayer({\n\t\t\t\ttype: baseLayerType,\n\t\t\t\tid: payload.spatial_layer,\n\n\t\t\t\twms_address:payload.wms_address,\n\t\t\t\twms_layers:payload.wms_layers,\n\t\t\t\twms_attribution:payload.wms_attribution,\n\n\t\t\t\timage_layer:payload.image_layer,\n\t\t\t\timage_address:payload.image_address,\n\t\t\t\timage_attribution:payload.image_attribution,\n\n\t\t\t\ttile_address:payload.tile_address,\n\t\t\t\ttile_attribution:payload.tile_attribution\n\t\t\t})\n\t\t);\n\t}\n\n\tenabledSpatialLayerPreview = (event, data) => {\n\t\tthis.props.dispatch(this.set_availableTileLayers({ids: data}));\n\t\tthis.markUnsaved(event,{name:'o:spatial_layers',value:data});\n\t}\n\n\t// Switches between map and image\n\texhibitTypeSwitch = (event) => {\n\t\tif (event.target.name === 'image') {\n\t\t\tthis.setState({\n\t\t\t\tbaseLayerType: TYPE.BASELAYER_TYPE.IMAGE,\n\t\t\t\texhibitType: TYPE.EXHIBIT_TYPE.IMAGE\n\t\t\t});\n\t\t\tthis.onSpatialLayerInfoChange({\n\t\t\t\ttarget: {\n\t\t\t\t\tname: 'o:spatial_layer',\n\t\t\t\t\tvalue: TYPE.BASELAYER_TYPE.IMAGE\n\t\t\t\t}\n\t\t\t});\n\t\t\tthis.props.change('o:exhibit_type', TYPE.EXHIBIT_TYPE.IMAGE);\n\n\t\t} else {\n\t\t\tthis.setState({\n\t\t\t\tbaseLayerType: TYPE.BASELAYER_TYPE.MAP,\n\t\t\t\texhibitType: TYPE.EXHIBIT_TYPE.MAP\n\t\t\t});\n\t\t\tthis.onSpatialLayerInfoChange({\n\t\t\t\ttarget: {\n\t\t\t\t\tname: 'o:spatial_layer',\n\t\t\t\t\tvalue: 0\n\t\t\t\t}\n\t\t\t});\n\t\t\tthis.props.change('o:exhibit_type', TYPE.EXHIBIT_TYPE.MAP);\n\t\t}\n\t}\n\n\t// Sets the unsaved changes flag\n\tmarkUnsaved = (event) => {\n\t\t// Update the cache\n\t\tif(typeof event !== 'undefined'){\n\t\t\tthis.props.dispatch(updateExhibitCache({\n\t\t\t\tsetValues: {\n\t\t\t\t\t[event.target.name]: event.target.value\n\t\t\t\t}\n\t\t\t}));\n\t\t\t// this.props.dispatch(updateExhibitCache({setValues:{[name]:value}}));\n\t\t}else{\n\t\t\tconsole.log(\"Skipping cache update\");\n\t\t}\n\n\t\t// Mark unsaved\n\t\tthis.props.dispatch(setUnsavedChanges({hasUnsavedChanges:true}));\n\n\t}\n\n\t// Build layerTYPE from the set of non-deprecated maps\n\tlayerTYPE = () => {\n\t\tlet retval = [];\n\t\tvar availableBaseMaps = this.props.mapCache.available.baseMaps;\n\t\tObject.keys(availableBaseMaps).forEach(function (key) {\n\t\t\tlet thisMap = availableBaseMaps[key];\n\t\t\tif (!thisMap.deprecated) {\n\t\t\t\tretval.push(thisMap);\n\t\t\t}\n\t\t});\n\t\treturn retval;\n\t};\n\n\tbuildLayerTypeOptions = () => {\n\t\tvar retval = [];\n \t\tlet layerTYPE = this.layerTYPE();\n\t\tObject.keys(layerTYPE).forEach(function(key) {\n\t\t\tlet layerType = layerTYPE[key];\n\t\t\tlet opt_key = `layerTypeOption-${key}`;\n\t\t\tretval.push(<option value={key} key={opt_key}>{layerType.displayName}</option>);\n\t\t});\n\t\treturn retval;\n\t};\n\n\n\tcomponentWillReceiveProps(nextprops){\n\t\tif(typeof nextprops.exhibit !== 'undefined'){\n\t\t\tlet nextSlug = nextprops.exhibit['o:slug'];\n\t\t\tif(this.currentSlug !== nextSlug && nextSlug.length > 0){\n\t\t\t\tthis.setState({currentSlug:nextSlug});\n\t\t\t\thistory.push(window.baseRoute + '/show/' + nextSlug);\n\t\t\t\tthis.currentSlug=nextSlug;\n\t\t\t}\n\t\t}\n\t}\n\trender() {\n\t\treturn (\n\t\t\t<div className=\"ps_n3_exhibitFormContainer\">\n\t\t\t\t<Form onSubmit={this.handleSubmit}>\n\t\t\t\t\t<fieldset disabled={this.disabled}>\n\t\t\t\t\t<legend>\n\t\t\t\t\t\t{this.state.isNewExhibit ?\n\t\t\t\t\t\t\t<h2>New Exhibit</h2>\n\t\t\t\t\t\t\t: <h4>Exhibit Settings</h4>\n\t\t\t\t\t\t}\n\t\t\t\t\t</legend>\n\t\t\t\t\t\t<div className='field'>\n\t\t\t\t\t\t\t<label htmlFor='o:title'>Title</label>\n\t\t\t\t\t\t\t<div className='ui input'>\n\t\t\t\t\t\t\t<Field \n\t\t\t\t\t\t\t\tid='o:title'\n\t\t\t\t\t\t\t\tname='o:title'\n\t\t\t\t\t\t\t\tcomponent='input'\n\t\t\t\t\t\t\t\ttype='text'\n\t\t\t\t\t\t\t\tplaceholder='Enter exhibit title'\n\t\t\t\t\t\t\t\tonChange={this.markUnsaved} />\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div className='field'>\n\t\t\t\t\t\t\t<label htmlFor='o:slug'>URL Slug</label>\n\t\t\t\t\t\t\t<div className='ui input'>\n\t\t\t\t\t\t\t<Field \n\t\t\t\t\t\t\t\tid='o:slug'\n\t\t\t\t\t\t\t\tname='o:slug'\n\t\t\t\t\t\t\t\tcomponent='input'\n\t\t\t\t\t\t\t\ttype='text'\n\t\t\t\t\t\t\t\tplaceholder='Enter url slug'\n\t\t\t\t\t\t\t\tonChange={this.markUnsaved}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div className='field'>\n\t\t\t\t\t\t\t<label htmlFor='o:narrative'>Narrative</label>\n\t\t\t\t\t\t\t<div className='ui input'>\n\t\t\t\t\t\t\t<Field \n\t\t\t\t\t\t\t\tid='o:narrative'\n\t\t\t\t\t\t\t\tname='o:narrative'\n\t\t\t\t\t\t\t\tcomponent='textarea'\n\t\t\t\t\t\t\t\tplaceholder='Enter exhibit narrative'\n\t\t\t\t\t\t\t\tonChange={this.markUnsaved}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div className='field'>\n\t\t\t\t\t\t\t<label htmlFor='o:accessible_url'>Alternative Accessible URL</label>\n\t\t\t\t\t\t\t<div className='ui input'>\n\t\t\t\t\t\t\t\t<Field id='o:accessible_url' name='o:accessible_url'\n\t\t\t\t\t\t\t\t\tcomponent='input'\n\t\t\t\t\t\t\t\t\ttype='text'\n\t\t\t\t\t\t\t\t\tplaceholder='Enter alternative url'\n\t\t\t\t\t\t\t\t\tonChange={this.markUnsaved}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{this.state.isNewExhibit ?\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<div className='field'>\n\t\t\t\t\t\t\t\t<label htmlFor='o:public'>Public</label>\n\t\t\t\t\t\t\t\t<div className='ui checkbox toggle ps_n3_checkbox'>\n\t\t\t\t\t\t\t\t\t<Field id=\"o:public\" name=\"o:public\"\n\t\t\t\t\t\t\t\t\tcomponent='input'\n\t\t\t\t\t\t\t\t\ttype=\"checkbox\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t<label>Check here to publish exhibit to the public site.</label>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div className='grouped fields'>\n\t\t\t\t\t\t\t\t<label><h3>Select Map Type</h3></label>\n\t\t\t\t\t\t\t\t\t<div className='field'>\n\t\t\t\t\t\t\t\t\t\t<div className='ui radio checkbox'>\n\t\t\t\t\t\t\t\t\t\t\t<Field\n\t\t\t\t\t\t\t\t\t\t\t\tid='map-radio'\n\t\t\t\t\t\t\t\t\t\t\t\tname='map'\n\t\t\t\t\t\t\t\t\t\t\t\ttype=\"radio\"\n\t\t\t\t\t\t\t\t\t\t\t\tcomponent='input'\n\t\t\t\t\t\t\t\t\t\t\t\tchecked={this.state.exhibitType === TYPE.EXHIBIT_TYPE.MAP}\n\t\t\t\t\t\t\t\t\t\t\t\tonChange={this.exhibitTypeSwitch}\n\t\t\t\t\t\t\t\t\t\t\t\tvalue={0}\n\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t<label htmlFor='map-radio'>Map</label>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div className='field'>\n\t\t\t\t\t\t\t\t\t\t<div className='ui radio checkbox'>\n\t\t\t\t\t\t\t\t\t\t\t<Field id=\"image-radio\"\n\t\t\t\t\t\t\t\t\t\t\t\tname=\"image\"\n\t\t\t\t\t\t\t\t\t\t\t\ttype=\"radio\"\n\t\t\t\t\t\t\t\t\t\t\t\tcomponent='input'\n\t\t\t\t\t\t\t\t\t\t\t\tchecked={this.state.exhibitType === TYPE.EXHIBIT_TYPE.IMAGE}\n\t\t\t\t\t\t\t\t\t\t\t\tonChange={this.exhibitTypeSwitch}\n\t\t\t\t\t\t\t\t\t\t\t\tvalue={1}\n\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t<label htmlFor=\"image-radio\">Image</label>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t: null }\n\t\t\t\t\t\t{(this.state.exhibitType === TYPE.EXHIBIT_TYPE.MAP) &&\n\t\t\t\t\t\t\t<div className='field'>\n\t\t\t\t\t\t\t\t<label htmlFor='o:spatial_layer'>Base Layer</label>\n\t\t\t\t\t\t\t\t<Field \n\t\t\t\t\t\t\t\t\tid='o:spatial_layer'\n\t\t\t\t\t\t\t\t\tname='o:spatial_layer'\n\t\t\t\t\t\t\t\t\tcomponent='select'\n\t\t\t\t\t\t\t\t\tonChange={this.onSpatialLayerInfoChange}>\n\t\t\t\t\t\t\t\t\t<optgroup label='Default Layers'>\n\t\t\t\t\t\t\t\t\t\t{this.layerTypeOptions}\n\t\t\t\t\t\t\t\t\t\t<option value={TYPE.BASELAYER_TYPE.TILE}>Custom: Tile Layer</option>\n\t\t\t\t\t\t\t\t\t\t<option value={TYPE.BASELAYER_TYPE.WMS}>Custom: WMS Layer</option>\n\t\t\t\t\t\t\t\t\t</optgroup>\n\t\t\t\t\t\t\t\t</Field>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t}\n\t\t\t\t\t\t{(this.state.exhibitType === TYPE.EXHIBIT_TYPE.IMAGE) &&\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t<div className='field'>\n\t\t\t\t\t\t\t\t\t\t<label htmlFor='o:image_layer'>Image URL</label>\n\t\t\t\t\t\t\t\t\t\t<Field \n\t\t\t\t\t\t\t\t\t\t\tid='o:image_layer'\n\t\t\t\t\t\t\t\t\t\t\tname='o:image_layer'\n\t\t\t\t\t\t\t\t\t\t\tcomponent='input'\n\t\t\t\t\t\t\t\t\t\t\ttype='text'\n\t\t\t\t\t\t\t\t\t\t\tonChange={this.onSpatialLayerInfoChange} />\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div className='field'>\n\t\t\t\t\t\t\t\t\t\t<label htmlFor='o:image_attribution'>Attribution</label>\n\t\t\t\t\t\t\t\t\t\t<Field \n\t\t\t\t\t\t\t\t\t\t\tid='o:image_attribution'\n\t\t\t\t\t\t\t\t\t\t\tname='o:image_attribution'\n\t\t\t\t\t\t\t\t\t\t\tcomponent='input'\n\t\t\t\t\t\t\t\t\t\t\ttype='text'\n\t\t\t\t\t\t\t\t\t\t\tonChange={this.onSpatialLayerInfoChange} />\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t}\n\t\t\t\t\t\t{(this.state.baseLayerType === TYPE.BASELAYER_TYPE.TILE) &&\n\t\t\t\t\t\t\t<div className=\"ps_n3_sub_options\">\n\t\t\t\t\t\t\t\t<div className='field'>\n\t\t\t\t\t\t\t\t\t<label htmlFor='o:tile_address'>Tile URL</label>\n\t\t\t\t\t\t\t\t\t<Field \n\t\t\t\t\t\t\t\t\t\tid='o:tile_address'\n\t\t\t\t\t\t\t\t\t\tname='o:tile_address'\n\t\t\t\t\t\t\t\t\t\tcomponent='input'\n\t\t\t\t\t\t\t\t\t\ttype='text'\n\t\t\t\t\t\t\t\t\t\tonChange={this.onSpatialLayerInfoChange} />\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div className='field'>\n\t\t\t\t\t\t\t\t\t<label htmlFor='o:tile_attribution'>Attribution</label>\n\t\t\t\t\t\t\t\t\t<Field \n\t\t\t\t\t\t\t\t\t\tid='o:tile_attribution'\n\t\t\t\t\t\t\t\t\t\tname='o:tile_attribution'\n\t\t\t\t\t\t\t\t\t\tcomponent='input'\n\t\t\t\t\t\t\t\t\t\ttype='text'\n\t\t\t\t\t\t\t\t\t\tonChange={this.onSpatialLayerInfoChange} />\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t{(this.state.baseLayerType === TYPE.BASELAYER_TYPE.WMS) &&\n\t\t\t\t\t\t\t<div className=\"ps_n3_sub_options\">\n\t\t\t\t\t\t\t\t<div className='field'>\n\t\t\t\t\t\t\t\t\t<label htmlFor='o:wms_address'>WMS URL</label>\n\t\t\t\t\t\t\t\t\t<Field \n\t\t\t\t\t\t\t\t\t\tid='o:wms_address'\n\t\t\t\t\t\t\t\t\t\tname='o:wms_address'\n\t\t\t\t\t\t\t\t\t\tcomponent='input'\n\t\t\t\t\t\t\t\t\t\ttype='text'\n\t\t\t\t\t\t\t\t\t\tonChange={this.onSpatialLayerInfoChange} />\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div className='field'> \n\t\t\t\t\t\t\t\t\t<label htmlFor='o:wms_layers'>WMS Layers</label>\n\t\t\t\t\t\t\t\t\t<Field id='o:wms_layers'\n\t\t\t\t\t\t\t\t\t\tname='o:wms_layers'\n\t\t\t\t\t\t\t\t\t\tcomponent='input'\n\t\t\t\t\t\t\t\t\t\ttype='text'\n\t\t\t\t\t\t\t\t\t\tonChange={this.onSpatialLayerInfoChange} />\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div className='field'>\n\t\t\t\t\t\t\t\t\t<label htmlFor='o:wms_attribution'>Attribution</label>\n\t\t\t\t\t\t\t\t\t<Field id='o:wms_attribution'\n\t\t\t\t\t\t\t\t\t\tname='o:wms_attribution'\n\t\t\t\t\t\t\t\t\t\tcomponent='input'\n\t\t\t\t\t\t\t\t\t\ttype='text'\n\t\t\t\t\t\t\t\t\t\tonChange={this.onSpatialLayerInfoChange} />\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t{(this.state.exhibitType === TYPE.EXHIBIT_TYPE.MAP) &&\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<div className='field'>\n\t\t\t\t\t\t\t\t\t<label htmlFor='o:spatial_layers'>Additional Layers</label>\n\t\t\t\t\t\t\t\t\t<Field id='o:spatial_layers'\n\t\t\t\t\t\t\t\t\t\tname='o:spatial_layers'\n\t\t\t\t\t\t\t\t\t\tcomponent='select'\n\t\t\t\t\t\t\t\t\t\tmultiple=\"multiple\"\n\t\t\t\t\t\t\t\t\t\tonChange={this.enabledSpatialLayerPreview}>\n\t\t\t\t\t\t\t\t\t\t{this.layerTypeOptions}\n\t\t\t\t\t\t\t\t\t</Field>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div className='field'>\n\t\t\t\t\t\t\t\t\t<label htmlFor='o:zoom_levels'>Zoom Levels</label>\n\t\t\t\t\t\t\t\t\t<Field id='o:zoom_levels'\n\t\t\t\t\t\t\t\t\t\tname='o:zoom_levels'\n\t\t\t\t\t\t\t\t\t\tcomponent='input'\n\t\t\t\t\t\t\t\t\t\ttype='number'\n\t\t\t\t\t\t\t\t\t\tonChange={this.markUnsaved} />\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t}\n\t\t\t\t\t\t<div className=\"ps_n3_checkboxPair\">\n\t\t\t\t\t\t\t\t\t\t{/*\n\t\t\t\t\t\t\tSpatial querying disabled for alpha:\n\t\t\t\t\t\t\thttps://github.com/performant-software/neatline-3/issues/114\n\t\t\t\t\t\t*/}\n\t\t\t\t\t\t\t{/* <div className='field'> */}\n\t\t\t\t\t\t\t\t{/*<label \thtmlFor='o:spatial_querying'>Spatial Querying</label>*/}\n\t\t\t\t\t\t\t\t<Field id='o:spatial_querying' \n\t\t\t\t\t\t\t\t\t\tname='o:spatial_querying'\n\t\t\t\t\t\t\t\t\t\tcomponent='input'\n\t\t\t\t\t\t\t\t\t\ttype='hidden'\n\t\t\t\t\t\t\t\t\t\tonChange={this.markUnsaved} />\n\t\t\t\t\t\t\t{/* </div> */}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{this.exhibit && this.exhibit['o:id'] &&\n\t\t\t\t\t\t\t<Field name='o:id'\n\t\t\t\t\t\t\t\tcomponent='input'\n\t\t\t\t\t\t\t\ttype='hidden' />\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t{/* Hidden fields */}\n\t\t\t\t\t\t<Field name='o:exhibit_type'\n\t\t\t\t\t\t\tcomponent='input'\n\t\t\t\t\t\t\ttype='hidden' />\n\t\t\t\t\t</fieldset>\n\t\t\t\t{this.state.isNewExhibit &&\n\t\t\t\t<Button type=\"submit\">Create Exhibit</Button>\n\t\t\t\t}\n\t\t\t</Form>\n\t\t</div>\n\t\t);\n\t}\n}\n\nExhibitForm = reduxForm({form: 'exhibit',enableReinitialize:true})(ExhibitForm);\nconst formSelector = formValueSelector('exhibit');\n\nconst mapStateToProps = state => ({\n\tstate,\n\tmapCache: state.mapCache,\n\tinitialValues: state.exhibitShow.exhibit?state.exhibitShow.exhibit:TYPE.EXHIBIT_DEFAULT_VALUES\n});\n\nconst mapDispatchToProps = dispatch => bindActionCreators({\n\tchange,\n\tdispatch\n}, dispatch);\n\nexport default connect(mapStateToProps, mapDispatchToProps)(ExhibitForm);\n","import React, {Component} from 'react';\nimport {bindActionCreators} from 'redux';\nimport {Field, reduxForm, change, formValueSelector} from 'redux-form'\nimport {connect} from 'react-redux';\nimport { Form } from 'semantic-ui-react'\nimport {\n\tsetUnsavedChanges,\n\tupdateExhibitCache} from '../../actions';\n\nconst defaultValues = {\n\t'o:track_height': 16\n};\n\nclass TimelineForm extends Component {\n\n    constructor(props) {\n\t\tsuper(props);\n\t\tthis.exhibit = props.exhibit;\n\t\tthis.handleSubmit = props.handleSubmit;\n\t\tthis.submitLabel = props.submitLabel;\n\t\tthis.disabled = props.disabled;\n    }\n    \n    \t// Sets the unsaved changes flag\n\tmarkUnsaved = (event) => {\n\t\t// Update the cache\n\t\tif(typeof event !== 'undefined'){\n\t\t\tthis.props.dispatch(updateExhibitCache({\n\t\t\t\tsetValues: {\n\t\t\t\t\t[event.target.name]: event.target.value\n\t\t\t\t}\n\t\t\t}));\n\t\t\t// this.props.dispatch(updateExhibitCache({setValues:{[name]:value}}));\n\t\t}else{\n\t\t\tconsole.log(\"Skipping cache update\");\n\t\t}\n\n\t\t// Mark unsaved\n\t\tthis.props.dispatch(setUnsavedChanges({hasUnsavedChanges:true}));\n\n\t}\n\n    render() {\n\t\treturn (\n\t\t\t<div className=\"ps_n3_exhibitFormContainer\">\n                <Form onSubmit={this.handleSubmit}>\n                    <fieldset disabled={this.disabled}>\n                        <legend> \n                            <h4>Timeline Settings</h4>\n                        </legend>\n                    <div className=\"field\">\n                        <label htmlFor='o:timeline_toggle'>Show Timeline</label>\n                            <div className='ui checkbox'>\n                                <Field id=\"o:timeline_toggle\" name=\"o:timeline_toggle\"\n                                component='input'\n                                type=\"checkbox\"\n                                onChange={this.markUnsaved}\n                                />\n                            </div>\n                    </div>\n                    <div className='field'>\n                        <label htmlFor='o:track_height'>Track Height</label>\n                        <Field \tclassName=\"styleEditor_input\"\n                                id='o:track_height'\n                                name='o:track_height'\n                                component='input'\n                                type='number'\n                                data-enforce='float'\n                                onChange={this.markUnsaved}/>\n                    </div>\n                    </fieldset>\n                </Form>\n            </div>\n        )\n    }\n}\n\nTimelineForm = reduxForm({form: 'exhibit',enableReinitialize:true})(TimelineForm);\nconst formSelector = formValueSelector('exhibit');\n\nconst mapStateToProps = state => ({\n\tstate,\n\tmapCache: state.mapCache,\n    initialValues: state.exhibitShow.exhibit?state.exhibitShow.exhibit:{ ...defaultValues }\n});\n\nconst mapDispatchToProps = dispatch => bindActionCreators({\n\tchange,\n\tdispatch\n}, dispatch);\n\nexport default connect(mapStateToProps, mapDispatchToProps)(TimelineForm);","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport CKEditor from 'ckeditor4-react';\nimport {bindActionCreators} from 'redux';\nimport {Field, reduxForm, change, formValueSelector} from 'redux-form';\nimport {connect} from 'react-redux';\nimport {Form} from 'semantic-ui-react';\n\n\nclass NeatlineTextForm extends Component {\n    constructor( props ) {\n        super( props );\n        this.exhibit = props.exhibit;\n\t\tthis.handleSubmit = props.handleSubmit;\n\t\tthis.submitLabel = props.submitLabel;\n        this.disabled = props.disabled;\n        \n        this.state = {\n            data: props.initialValues['o:narrative']\n        };\n\n        this.onEditorChange = this.onEditorChange.bind( this );\n    }\n\n\n    onEditorChange( evt ) {\n        this.setState( {\n            data: evt.editor.getData()\n        } );\n    }\n\n    renderEditor({input}) {\n\t\treturn (\n\t\t  <CKEditor\n            data={input.value}\n\t\t\tonChange={(event) => {\n                return console.log(event.editor.getData());\n                // input.onChange(event.editor.getData());\n                // console.log(event.editor.getData());\n\t\t\t  }\n\t\t\t}\n\t\t  />\n\t\t)\n\t}\n\n    render() {\n        console.log(this.state.data)\n        // console.log(this.props.state.exhibitShow.exhibit['o:narrative'])\n        return (\n            <div className=\"ps_n3_exhibitFormContainer\">\n\t\t\t\t<Form onSubmit={this.handleSubmit}>\n\t\t\t\t\t<fieldset disabled={this.disabled}>\n\t\t\t\t\t<legend>\n\t\t\t\t\t\t<h4>NeatlineText Settings</h4>\n\t\t\t\t\t</legend>\n                    <div className=\"field\">\n                        <label htmlFor='o:text_toggle'>Show Exhibit Narrative</label>\n                            <div className='ui checkbox'>\n                                <Field id=\"o:text_toggle\" name=\"o:text_toggle\"\n                                component='input'\n                                type=\"checkbox\"\n                                />\n                            </div>\n                    </div>\n                    <div className='field'>\n                        <label htmlFor='o:narrative'>Narrative</label>\n                        <div className='ui input'>\n                        <Field \n                                id='o:narrative'\n                                name='o:narrative'\n                                component={this.renderEditor}\n                                // onChange={this.markUnsaved}\n                            />\n                        </div>\n                    </div>\n                    {this.exhibit && this.exhibit['o:id'] &&\n\t\t\t\t\t\t\t<Field name='o:id'\n\t\t\t\t\t\t\t\tcomponent='input'\n\t\t\t\t\t\t\t\ttype='hidden' />\n\t\t\t\t\t\t}\n                \n               </fieldset>\n               </Form>\n               <EditorPreview data={this.state.data} />               \n            </div>\n        );\n    }\n}\n\nclass EditorPreview extends Component {\n    render() {\n        return (\n            <div className=\"editor-preview\">\n                <div dangerouslySetInnerHTML={ { __html: this.props.data } }></div>\n            </div>\n        );\n    }\n}\n\nEditorPreview.defaultProps = {\n    data: ''\n};\n\nEditorPreview.propTypes = {\n    data: PropTypes.string\n};\n\nNeatlineTextForm = reduxForm({form: 'exhibit-text',enableReinitialize:true})(NeatlineTextForm);\nconst formSelector = formValueSelector('exhibit-text');\n\nconst mapStateToProps = state => ({\n\tstate,\n\tmapCache: state.mapCache,\n    initialValues: state.exhibitShow.exhibit\n        ? state.exhibitShow.exhibit\n        : {\n\t\t\t'o:narrative': {\n\t\t\t\t'o:narrative': state.exhibitShow.exhibit['o:narrative']\n\t\t\t}\n\t\t}\n});\n\nconst mapDispatchToProps = dispatch => bindActionCreators({\n\tchange,\n\tdispatch\n}, dispatch);\n\nexport default connect(mapStateToProps, mapDispatchToProps)(NeatlineTextForm);\n\n","import React, { Component } from 'react';\nimport ExhibitForm from '../../components/ExhibitForm';\nimport TimelineForm from '../../components/Timeline/TimelineForm';\nimport NeatlineTextForm from '../../components/NeatlineText/NeatlineTextForm';\nimport { bindActionCreators } from 'redux';\nimport { connect } from 'react-redux';\nimport {strings} from '../../i18nLibrary';\nimport { Tab } from 'semantic-ui-react';\n\n\nclass ExhibitUpdate extends Component {\n\t\n\trender() {\n\t\tconst props = this.props;\n\t\tconst panes = [\n\t\t\t{menuItem: 'Settings', render: () => \n\t\t\t\t<Tab.Pane attached={false}>\n\t\t\t\t\t<ExhibitForm exhibit={props.exhibit}\n\t\t\t\t\t\tsubmitLabel={strings.save_exhibit}\n\t\t\t\t\t\tdisabled={props.loading} />\n\t\t\t\t\t{props.errored &&\n\t\t\t\t\t\t<p>{strings.update_exhibit_error}</p>\n\t\t\t\t\t}\n\t\t\t\t</Tab.Pane>\n\t\t\t},\n\t\t\t{menuItem: 'Timeline', render: () => \n\t\t\t\t<Tab.Pane attached={false}>\n\t\t\t\t\t\t<TimelineForm \n\t\t\t\t\t\t\texhibit={props.exhibit}\n\t\t\t\t\t\t\tsubmitLabel={strings.save_exhibit}\n\t\t\t\t\t\t\tdisabled={props.loading}\n\t\t\t\t\t\t/>\n\t\t\t\t</Tab.Pane>\n\t\t\t},\n\t\t\t{menuItem: 'NeatlineText', render: () => \n\t\t\t\t<Tab.Pane attached={false}>\n\t\t\t\t\t\t<NeatlineTextForm exhibit={props.exhibit}\n\t\t\t\t\t\tsubmitLabel={strings.save_exhibit}\n\t\t\t\t\t\tdisabled={props.loading}/>\n\t\t\t\t\t{props.errored &&\n\t\t\t\t\t\t<p>{strings.update_exhibit_error}</p>\n\t\t\t\t\t}\n\t\t\t\t</Tab.Pane>\n\t\t\t},\n\t\t]\n\t\treturn (\n\t\t\t<div>\n\t\t\t\t<Tab menu={{ secondary: true, pointing: true }} panes={panes} />\n\t\t\t</div>\n\t\t)\n\t}\n}\n\nconst mapStateToProps = state => ({\n  loading: state.exhibits.exhibit.loading,\n  errored: state.exhibits.exhibit.errored\n});\n\nconst mapDispatchToProps = dispatch => bindActionCreators({}, dispatch);\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps,\n)(ExhibitUpdate);\n","import L from 'leaflet';\n\nconst leafletSupport = {\n\t/*\n\t\tNOTE: Circles disabled for alpha\n\t\tIssue: https://github.com/performant-software/neatline-3/issues/94\n\n\t\tcircle: {\n\t\t\tshowRadius: showUnits,\n\t\t\tfeet: useImperialUnits,\n\t\t\tmetric: !useImperialUnits,\n\t\t\tnautic: false\n\t\t}\n\t*/\n\n\t// Drawing options\n\t// Leaflet docs: http://leaflet.github.io/Leaflet.draw/docs/leaflet-draw-latest.html\n\tdrawingOptions : (useImperialUnits, showUnits) =>{\n\t\treturn({\n\t\t\tdraw:{\n\t\t\t\tcirclemarker: false,\n\t\t\t\tmarker: {},\n\t\t\t\trectangle: {\n\t\t\t\t\tshowArea: showUnits,\n\t\t\t\t\tshowRadius: showUnits,\n\t\t\t\t\tfeet: useImperialUnits,\n\t\t\t\t\tmetric: !useImperialUnits,\n\t\t\t\t\tnautic: false\n\t\t\t\t},\n\t\t\t\tpolygon: {\n\t\t\t\t\tshowArea: showUnits,\n\t\t\t\t\tshowLength: showUnits,\n\t\t\t\t\tshowRadius: showUnits,\n\t\t\t\t\tfeet: useImperialUnits,\n\t\t\t\t\tmetric: !useImperialUnits,\n\t\t\t\t\tnautic: false\n\t\t\t\t},\n\t\t\t\tpolyline: {\n\t\t\t\t\tshowLength: showUnits,\n\t\t\t\t\tfeet: useImperialUnits,\n\t\t\t\t\tmetric: !useImperialUnits,\n\t\t\t\t\tnautic: false\n\t\t\t\t},\n\t\t\t\tcircle: false\n\t\t\t}\n\t\t});\n\t},\n\n\t// Geojson stores lng,lat, Leaflet expects lat,lng\n\tinvertCoordinateOrder : (coordinates) => {\n\n\t\tlet latLngSet = [];\n\t\tif (Array.isArray(coordinates[0])) {\n\n\t\t\tlet coordinateArray=coordinates[0];\n\t\t\tif (coordinates.length > 2){\n\t\t\t\tcoordinateArray=coordinates;\n\t\t\t}\n\n\t\t\tcoordinateArray.forEach(coordinatePair => {\n\t\t\t\tlatLngSet.push([\n\t\t\t\t\tcoordinatePair[1], coordinatePair[0]\n\t\t\t\t]);\n\t\t\t});\n\t\t\tlatLngSet = [latLngSet];\n\t\t} else {\n\t\t\tlatLngSet.push([\n\t\t\t\tcoordinates[1], coordinates[0]\n\t\t\t]);\n\t\t}\n\t\treturn latLngSet;\n\t},\n\n\t// Unpacks geojson and returns an array of leaflet vector objects\n\tconvertToVector : (geojson, style, onClick) => {\n\t\tif (typeof geojson === 'undefined' || geojson === null) {\n\t\t\tconsole.error(\"Cannot convert empty geojson\");\n\t\t\treturn null;\n\t\t}\n\n\t\tlet convertedGeometry = [];\n\t\tif (typeof geojson.features !== 'undefined') {\n\t\t\tgeojson.features.forEach((feature, idx) => {\n\n\t\t\t\tlet options = {...style,dashArray:4};\n\t\t\t\tlet positions = leafletSupport.invertCoordinateOrder(feature.geometry.coordinates);\n\t\t\t\tlet position = positions[0];\n\n\t\t\t\tswitch (feature.geometry.type) {\n\n\t\t\t\t\tcase \"Polygon\":\n\t\t\t\t\t\tlet polygon = L.polygon(positions,options);\n\t\t\t\t\t\tpolygon.on('click', onClick);\n\t\t\t\t\t\tpolygon.options.editing || (polygon.options.editing = {});\n\t\t\t\t\t\tconvertedGeometry.push(polygon);\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase \"Point\": case \"Circle\":\n\t\t\t\t\t\t// FIXME: Check for circles (points with radius), needs backend support\n\t\t\t\t\t\t// options = {...options,radius:10};\n\t\t\t\t\t\t// let circle = L.circle(position,options);\n\t\t\t\t\t\tlet marker = L.marker(position,options);\n\t\t\t\t\t\tmarker.on('click', onClick);\n\t\t\t\t\t\tconvertedGeometry.push(marker);\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase \"LineString\":\n\t\t\t\t\tcase \"MultiLineString\":\n\t\t\t\t\t\toptions = {\t...options, fillColor:\"transparent\"};\n\t\t\t\t\t\tlet polyline = L.polyline(positions,options);\n\t\t\t\t\t\tpolyline.on('click', onClick);\n\t\t\t\t\t\tpolyline.options.editing || (polyline.options.editing = {});\n\t\t\t\t\t\tconvertedGeometry.push(polyline);\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tconsole.error(\"I don't know how to handle geometries of type: \" + feature.geometry.type);\n\t\t\t\t}\n\n\t\t\t});\n\t\t}\n\t\treturn convertedGeometry;\n\t},\n\n\tremoveExistingHandlers : (mapInstance) =>{\n\t\tmapInstance.off('draw:created');\n\t\tmapInstance.off('draw:deleted');\n\t\tmapInstance.off('draw:deletestart');\n\t\tmapInstance.off('draw:deletestop');\n\t\tmapInstance.off('draw:editstart');\n\t\tmapInstance.off('draw:editstop');\n\t\tmapInstance.off('draw:edited');\n\t\tmapInstance.off('draw:drawstart');\n\t\tmapInstance.off('draw:drawstop');\n\t},\n\n\tclearGeometry : (mapInstance) =>{\n\t\tmapInstance.eachLayer(function(layer){\n\t\t\tif(typeof layer.feature !== 'undefined'){\n\t\t\t\tmapInstance.removeLayer(layer);\n\t\t\t}\n\t\t});\n\t}\n\n};\nexport default leafletSupport;\n","/*\n\tREAD THIS!:\n\n\tHi... This is a a strange component...\n\n\tLeaflet and React don't play that nicely together, so what we do is create\n\ta situation where React renders an empty div, which we then pick up after\n\tthe DOM render which is where leaflet does its thing.\n\n\t- Note the empty <div/> in render()\n\t- All of the work is in this.updateMap();\n\t- Methods that begin with 'ls_' are specific to leaflet and drawing\n\t- We toggle rendering off while editing using shouldComponentUpdate()\n\n\tFor more on the basics of this technique:\n\thttps://reactjs.org/docs/integrating-with-other-libraries.html\n*/\nimport * as TYPE from '../../types';\nimport React, {Component} from 'react';\nimport {bindActionCreators} from 'redux';\nimport {connect} from 'react-redux';\nimport {change} from 'redux-form';\nimport {updateRecordCacheAndSave, leafletIsSaving, leafletIsEditing} from '../../actions';\nimport { selectRecord, deselectRecord, previewRecord, unpreviewRecord, setShowRecords, setShowExhibitSettings} from '../../actions';\nimport L from 'leaflet';\nimport Draw from 'leaflet-draw';\nimport leafletSupport from './leafletSupport.js';\n\nclass ExhibitPublicMap extends Component {\n\n\tconstructor(props) {\n\t\tsuper(props);\n\n\t\t// FIXME: Move these to exhibit settings\n\t\t// Issue: https://github.com/performant-software/neatline-3/issues/110\n\t\tthis.state ={\n\t\t\tmap_center:[51.505, -0.09],\n\t\t\tmap_zoom:13\n\t\t};\n\t\t// Render flags, used because we can't use standard react logic\n\t\tthis.cacheInitialized=false;\n\t\tthis.mapInitialized=false;\n\t\tthis.allowRender=true;\n\t\tthis.isDrawing=false;\n\t\tthis.Draw = Draw; /* Suppresses include warning */\n\t\tthis.geoClick=false;\n\t}\n\n\t// Stub for leaflet to attach to\n\trender() {\n\t\treturn (<div id='leafletMap' \n\t\t// style={{height: '500px'}}\n\t\t/>)\n\t}\n\n\t// enables/disables render\n\tshouldComponentUpdate(){return this.allowRender;}\n\n\t// Post-DOM\n\tcomponentDidUpdate = (prevProps) =>{\n\t\t// Initialize map\n\t\tif(!this.mapInitialized){\n\t\t\tthis.ls_mapInit();\n\t\t}\n\t\t// Update the map\n\t\tif ((typeof (prevProps.records || this.props.records) !== 'undefined') && (this.props.records !== prevProps.records)){\n\t\t\tthis.ls_mapUpdate();\n\t\t}\n\n\t\tif (this.firstUpdate || prevProps.selectedRecord !== this.props.selectedRecord) {\n\t\t\tthis.ls_mapUpdate();\n\t\t}\n\n\t\tif(this.props.hasWarning){\n\t\t\tdocument.getElementById('leafletMap').classList.add('ps_n3_mapComponent_withWarning');\n\t\t}else{\n\t\t\tdocument.getElementById('leafletMap').classList.remove('ps_n3_mapComponent_withWarning');\n\t\t}\n\t}\n\n\t// Custom event listeners are stopgaps until this gets refactored to follow redux store\n\tcomponentDidMount(){\n\t\tdocument.addEventListener(\"refreshMapGeometry\", this.event_refreshMapGeometry);\n\t\tdocument.addEventListener(\"refreshMap\", this.event_refreshMap);\n    this.firstUpdate = true;\n    this.forceUpdate();\n\t}\n\n\tcomponentWillUnmount(){\n\t\tdocument.removeEventListener(\"refreshMapGeometry\", this.event_refreshMapGeometry);\n\t\tdocument.removeEventListener(\"refreshMap\", this.event_refreshMap);\n\t}\n\n\t//////////////////////////////////////\n\t// Leaflet\n\t//////////////////////////////////////\n\tls_mapInit = () => {\n\t\tdocument.getElementById('leafletMap').classList.add('ps_n3_leafletMap');\n\t\tif(typeof this.map === 'undefined'){\n\t\t\tthis.map = L.map('leafletMap');\n\t\t}else{\n\t\t\tif(typeof this.initialBaselayer !== 'undefined'){\n\t\t\t\tthis.initialBaselayer.remove();\n\n\t\t\t}\n\t\t}\n\t\tlet baselayerType = this.props.mapCache.current.type;\n\t\tlet currentMapCache = this.props.mapCache.current;\n\t\tlet baseLayers = {};\n\t\tlet overlays = {};\n\t\tswitch (baselayerType) {\n\n\t\t\t// Known map layer\n\t\t\tcase TYPE.BASELAYER_TYPE.MAP:\n\t\t\tcase TYPE.BASELAYER_TYPE.TILE:\n\t\t\t\tif(typeof currentMapCache.tileLayer !== 'undefined'){\n\t\t\t\t\tbaseLayers[currentMapCache.tileLayer.displayName] = L.tileLayer(currentMapCache.tileLayer.url, { attribution: currentMapCache.tileLayer.attribution});\n\t\t\t\t\tthis.initialBaselayer=baseLayers[currentMapCache.tileLayer.displayName];\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\t// Image layer\n\t\t\tcase TYPE.BASELAYER_TYPE.IMAGE:\n\t\t\t\tthis.props.leafletIsSaving(true);\n\t\t\t\tvar img = new Image();\n\t\t\t\t\timg.src = currentMapCache.image_address;\n\t\t\t\t\timg.onerror = () => {\n\t\t\t\t\t\talert(\"Invalid Image URL\");\n\t\t\t\t\t\tthis.props.leafletIsSaving(false);\n\t\t\t\t\t}\n\t\t\t\t\timg.onload = () => {\n\t\t\t\t\t\tlet w = img.width;\n\t\t\t\t\t\tlet h = img.height;\n\t\t\t\t\t\tlet maxZoom = 4;\n\t\t\t\t\t\tlet southWest = this.map.unproject([0, h], maxZoom-1);\n\t\t\t\t\t\tlet northEast = this.map.unproject([w, 0], maxZoom-1);\n\t\t\t\t\t\tlet imageBounds = new L.LatLngBounds(southWest, northEast);\n\n\t\t\t\t\t\t// Remove existing image layers and add new one\n\t\t\t\t\t\tlet leafletMap=this.map;\n\t\t\t\t\t\tleafletMap.eachLayer(function(layer){\n\t\t\t\t\t\t\tif(layer._image){\n\t\t\t\t\t\t\t\tleafletMap.removeLayer(layer);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t\tL.imageOverlay(\tcurrentMapCache.image_address,\n\t\t\t\t\t\t\t\t\t\timageBounds,\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tattribution:currentMapCache.image_attribution\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t  ).addTo(this.map);\n\n\t\t\t\t\t\tthis.map.attributionControl.addAttribution(currentMapCache.image_attribution);\n\n\t\t\t\t\t\t// Tell leaflet that the map is exactly as big as the image\n\t\t\t\t\t\tthis.map.setMaxBounds(imageBounds);\n\n\t\t\t\t\t\t// Set zoom\n\t\t\t\t\t\tthis.map.setZoom(1);\n\t\t\t\t\t\tthis.map.setMaxZoom(maxZoom);\n\n\t\t\t\t\t\tthis.props.leafletIsSaving(false);\n\t\t\t\t\t};\n\t\t\t\tbreak;\n\n\t\t\t\tcase TYPE.BASELAYER_TYPE.WMS:\n\t\t\t\t\tif(currentMapCache.wms_address !== null){\n\t\t\t\t\t\tbaseLayers[currentMapCache.wms_address] = L.tileLayer(currentMapCache.wms_address, {\n\t\t\t\t\t\t\tattribution: currentMapCache.wms_attribution,\n\t\t\t\t\t\t\tlayers: currentMapCache.wms_layers\n\t\t\t\t\t\t});\n\t\t\t\t\t\tthis.initialBaselayer=baseLayers[currentMapCache.wms_address];\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\n\t\t\tdefault:\n\t\t\t\tconsole.error(\"Unknown baselayer type: \"+currentMapCache.type);\n\t\t\t\tbreak;\n\t\t}\n\n\t\t// Other options\n\t\tcurrentMapCache.basemapOptions.forEach(\n\t\t\tthisTileLayer => {\n\t\t\t\t// Don't allow duplicate\n\t\t\t\tif ((typeof currentMapCache.tileLayer !== 'undefined') && thisTileLayer.slug !== currentMapCache.tileLayer.slug) {\n\t\t\t\t\tbaseLayers[thisTileLayer.displayName] = L.tileLayer(thisTileLayer.url, { attribution: thisTileLayer.attribution});\n\t\t\t}\n\t\t});\n\n\t\tif(Object.keys(baseLayers).length > 0){\n\t\t\tif(typeof this.layerControl !== 'undefined'){\n\t\t\t\tthis.layerControl.remove();\n\t\t\t}\n\t\t\tthis.layerControl = L.control.layers(baseLayers, overlays).addTo(this.map);\n\t\t}\n\t\tif(typeof this.initialBaselayer !== 'undefined'){\n\t\t\tthis.initialBaselayer.addTo(this.map);\n\t\t}\n\n\t\tthis.map.off('click').on('click',(event)=>{this.onMapClick(event);});\n\t\tthis.map.setView(this.state.map_center,this.state.map_zoom);\n\t\tif(typeof this.ls_fg === 'undefined'){\n\t\t\tthis.ls_fg = new L.FeatureGroup();\n\t\t\tthis.ls_fg.addTo(this.map);\n\t\t\tthis.ls_drawControl = new L.Control.Draw({\n\t\t\t\t\t\t\t\t\t\t...leafletSupport.drawingOptions(),\n\t\t\t\t\t\t\t\t\t\tedit:{featureGroup:this.ls_fg}\n\t\t\t\t\t\t\t\t\t});\n\t\t}\n\n\t\tthis.mapInitialized=true;\n\t}\n\n\tls_mapUpdate = () => {\n\t\tlet mapInstance = this.map;\n\t\tlet selectedRecord = this.props.selectedRecord;\n\t\tlet saveChanges =  this.syncDrawWithReact;\n\t\tlet geometry = this.ls_geometrySetup();\n\t\tif(typeof geometry === 'undefined'){\n\t\t\treturn;\n\t\t}\n\n\t\t// Rebuild editable\n\t\tthis.ls_fg.eachLayer(layer =>{\n\t\t\tthis.ls_fg.removeLayer(layer);\n\t\t});\n\t\tgeometry.editable.forEach(layer =>{\n\t\t\tthis.ls_fg.addLayer(layer);\n\t\t});\n\n\t\t// Rebuild not-editable\n\t\tleafletSupport.clearGeometry(mapInstance);\n\t\tmapInstance.removeControl(this.ls_drawControl);\n\t\tgeometry.uneditable.forEach(\n\t\t\tlayer=>{layer.addTo(mapInstance);\n\t\t});\n\n\t\t// Selectively show the draw control\n\t\tif((this.props.viewMode === 'editing') && (this.props.showExhibitSettings === false)){\n\t\t\tif( (typeof selectedRecord !== 'undefined' && selectedRecord !== null) || this.props.editorNewRecord ){\n\t\t\t\tmapInstance.addControl(this.ls_drawControl);\n\t\t\t}\n\t\t}\n\n\n\t\t//////////////////////////////////////\n\t    // Event handlers\n\t\t//////////////////////////////////////\n\t\tleafletSupport.removeExistingHandlers(mapInstance);\n\n\t\tmapInstance.on('draw:created', (e) => {\n\t\t\tthis.ls_fg.addLayer(e.layer);\n\t\t\tlet geojsonData = this.ls_fg.toGeoJSON();\n\t\t\tsaveChanges(selectedRecord,geojsonData);\n\t\t});\n\n\t\tmapInstance.on('draw:deleted', (e) => {\n\t\t\tthis.ls_hasEditToSave=true;\n\t\t});\n\n\t\tmapInstance.on('draw:deletestart', (e) => {\n\t\t\tthis.allowRender=false;\n\t\t\tthis.props.leafletIsEditing(true);\n\t\t\tthis.isDrawing=true;\n\t\t\tthis.ls_hasEditToSave=false;\n\t\t});\n\n\t\tmapInstance.on('draw:deletestop', (e) => {\n\t\t\tthis.props.leafletIsEditing(false);\n\t\t\tthis.isDrawing=false;\n\t\t\tif(this.ls_hasEditToSave){\n\t\t\t\tlet geojsonData = this.ls_fg.toGeoJSON();\n\t\t\t\tif(geojsonData.features.length === 0){\n\t\t\t\t\t// FIXME: This is not really the way to store empty geometries, but it deals with the backend\n\t\t\t\t\tgeojsonData={\"type\": \"MultiLineString\", \"coordinates\": []};\n\t\t\t\t}\n\t\t\t\t//this.ls_fg.clearLayers();\n\t\t\t\tsaveChanges(selectedRecord,geojsonData);\n\t\t\t}\n\t\t\tthis.allowRender=true;\n\t\t});\n\n\t\tmapInstance.on('draw:editstart', (e) =>{\n\t\t\tthis.allowRender=false;\n\t\t\tthis.props.leafletIsEditing(true);\n\t\t\tthis.isDrawing=true;\n\t\t\tthis.ls_hasEditToSave=false;\n\t\t});\n\n\t\tmapInstance.on('draw:editstop', (e) => {\n\t\t\tthis.props.leafletIsEditing(false);\n\t\t\tthis.isDrawing=false;\n\t\t\tif(this.ls_hasEditToSave){\n\t\t\t\tlet geojsonData = this.ls_fg.toGeoJSON();\n\t\t\t\tsaveChanges(selectedRecord,geojsonData);\n\t\t\t}\n\t\t\tthis.allowRender=true;\n\t\t});\n\n\t\tmapInstance.on('draw:edited', (e) =>{\n\t\t\tthis.ls_hasEditToSave=true;\n\t\t});\n\n\t\tmapInstance.on('draw:drawstart', (e) => {\n\t\t\tthis.allowRender=false;\n\t\t\tthis.props.leafletIsEditing(true);\n\t\t\tthis.isDrawing=true;\n\t\t});\n\n\t\tmapInstance.on('draw:drawstop', (e) => {\n\t\t\tthis.props.leafletIsEditing(false);\n      // crude fix for events firing in non-intuitive sequence -- delay prevents the mouse action from getting treated as a mapClick and deselecting the record\n\t\t\twindow.setTimeout(function() {\n        this.isDrawing=false;\n      }.bind(this), 200);\n\t\t\tthis.allowRender=true;\n\t\t});\n\n\t}\n\n\tls_geometrySetup = () => {\n\t\tif(typeof this.props.records === 'undefined'){return;}\n\n\t\tlet onGeometryClick = this.onGeometryClick;\n\t\tlet selectedRecord = this.props.selectedRecord;\n\t\tlet onMouseEnter = this.props.recordMouseEnter;\n\t\tlet onMouseLeave = this.props.recordMouseLeave;\n\n\t\tlet editable_geometry=[];\n\t\tlet uneditable_geometry=[];\n\t\tthis.props.mapCache.cache.map(record => {\n\t\t\tlet isSelected = ((record !== null && selectedRecord !== null) && (record[\"o:id\"] === selectedRecord[\"o:id\"]));\n\t\t\t\tif (record['o:is_wms']) {\n\t\t\t\t\t/*\n\t\t\t\t\t// FIXME: Doesn't belong here anymore\n\t\t\t\t\tconsole.error(\"I am probably broken\");\n\t\t\t\t\tuneditable_geometry.push(\n\t\t\t\t\t\t<LayersControl.Overlay name={record['o:title']} checked={true} key={record['o:id'] + '_wms'}>\n\t\t\t\t\t\t\t<WMSTileLayer url={record['o:wms_address']} layers={record['o:wms_layers']} transparent={true} format='image/png' opacity={0.8}/>\n\t\t\t\t\t\t</LayersControl.Overlay>\n\t\t\t\t\t);\n\t\t\t\t\t*/\n\t\t\t\t} else if (record['o:is_coverage']) {\n\n\t\t\t\t\t// Sometimes JSON arrives as string, but component below will barf on that, so we cast it\n\t\t\t\t\tlet geoJSON=record['o:coverage'];\n\t\t\t\t\tif(typeof geoJSON === 'string'){geoJSON=JSON.parse(geoJSON);}\n\n\t\t\t\t\t// Style for this geometry\n\t\t\t\t\tlet defaultGeometryStyle = this.props.mapCache.default.geometryStyles;\n\t\t\t\t\tlet record_id = record['o:id'];\n\t\t\t\t\tlet style = defaultGeometryStyle;\n\t\t\t\t\tif(record_id in this.props.mapCache.cache){\n\t\t\t\t\t\tstyle = this.props.mapCache.cache[record_id];\n\t\t\t\t\t\tif(style['o:fill_color'] === null){\n\t\t\t\t\t\t\tconsole.log(\"**** BROKEN STYLE CACHE - USING DEFAULT\");\n\t\t\t\t\t\t\tstyle = defaultGeometryStyle;\n\t\t\t\t\t\t}\n\t\t\t\t\t}else{\n\t\t\t\t\t\tconsole.log(\"**** MISSING STYLE CACHE - USING DEFAULT\");\n\t\t\t\t\t}\n\n\t\t\t\t\tlet coverageStyle =()=>{\n\t\t\t\t\t\treturn({\n\t\t\t\t\t\t\tstroke:true,\n\t\t\t\t\t\t\tfill:true,\n\t\t\t\t\t\t\tweight: style[\"o:stroke_width\"],\n\t\t\t\t\t\t\tcolor: isSelected ? style[\"o:stroke_color_select\"]:style[\"o:stroke_color\"],\n\t\t\t\t\t\t\topacity: isSelected ? style[\"o:stroke_opacity_select\"]:style[\"o:stroke_opacity\"],\n\t\t\t\t\t\t\tfillColor: isSelected ? style[\"o:fill_color_select\"]:style[\"o:fill_color\"],\n\t\t\t\t\t\t\tfillOpacity: isSelected ? style[\"o:fill_opacity_select\"]:style[\"o:fill_opacity\"]\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\tif(isSelected){\n\t\t\t\t\t\teditable_geometry = leafletSupport.convertToVector(geoJSON, coverageStyle(), (event)=>{onGeometryClick(event,record)});\n\t\t\t\t\t}else{\n\t\t\t\t\t\t/*\n\t\t\t\t\t\t// Build circles from points with props\n\t\t\t\t\t\t// FIXME: Needs to check for props, not stored currently\n\t\t\t\t\t\tgeoJSON.features.forEach(\n\t\t\t\t\t\t\t(feature,idx) => {\n\t\t\t\t\t\t\t\t// Circles stored as feature properties\n\t\t\t\t\t\t\t\tif(feature.geometry.type === 'Point'){\n\t\t\t\t\t\t\t\t\tcircles.push(<Circle \tkey={`circle_${idx}`}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcenter={{lat:feature.geometry.coordinates[1], lng: feature.geometry.coordinates[0]}}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfillColor=\"red\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tradius={99000.000}/>);\n\t\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\t\tnonCircles.features.push(feature);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t);\n\t\t\t\t\t\t*/\n\n\t\t\t\t\t\tvar geoJSONLayer = L.geoJSON();\n\t\t\t\t\t\tgeoJSONLayer.addData(geoJSON);\n\t\t\t\t\t\tgeoJSONLayer.on('click',(event)=>{onGeometryClick(event,record)});\n\n\t\t\t\t\t\t// FIXME: The mouse events are wrong\n\t\t\t\t\t\tgeoJSONLayer.on('mouseover',()=>{onMouseEnter(record)});\n\t\t\t\t\t\tgeoJSONLayer.on('mouseout',()=>{onMouseLeave(record)});\n\t\t\t\t\t\tgeoJSONLayer.setStyle(function(feature, layer) {\n\t\t\t\t\t\t\t// If the geometry is a line, get rid of fill\n\t\t\t\t\t\t\tlet style=coverageStyle();\n\t\t\t\t\t\t\tif(\tfeature.geometry.type === 'LineString' ||\n\t\t\t\t\t\t\t\tfeature.geometry.type === 'MultiLineString'){\n\t\t\t\t\t\t\t\t\tstyle.fillColor='transparent';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn style;\n\t\t\t\t\t\t});\n\t\t\t\t\t\tuneditable_geometry.push(geoJSONLayer);\n\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn null;\n\t\t\t});\n\n\t\treturn({editable:editable_geometry,uneditable:uneditable_geometry})\n\t}\n\n\n\t//////////////////////////////////////\n\t// Event handlers\n\t//////////////////////////////////////\n\tsyncDrawWithReact = (selectedRecord,geojsonData) => {\n\t\tif(typeof this.props.records === 'undefined'){\n\t\t\treturn;\n\t\t}\n\t\tlet recordId = (typeof selectedRecord !== 'undefined' && selectedRecord !== null && selectedRecord['o:id'])?selectedRecord['o:id']:TYPE.NEW_UNSAVED_RECORD;\n\t\tthis.props.change('record', 'o:coverage', geojsonData);\n\t\tthis.props.change('record', 'o:is_coverage', true);\n\t\tthis.props.deselectRecord();\n\t\tthis.props.updateRecordCacheAndSave({\n\t\t\tsetValues: {\n\t\t\t\t'o:id': recordId,\n\t\t\t\t'o:coverage': geojsonData,\n\t\t\t\t'o:is_coverage': true\n\t\t\t},\n\t\t\tselectedRecord:selectedRecord\n\t\t});\n\t\tconsole.log('sync', this.props)\n\t\t// this.props.setShowRecords(true);\n\t}\n\n\tevent_refreshMap = (event) => {\n\t\tthis.mapInitialized=false;\n\t\tthis.event_refreshMapGeometry(event);\n\t}\n\n\tevent_refreshMapGeometry = (event) => {\n\t\tthis.cacheInitialized=false;\n\t\tthis.ls_mapUpdate();\n\t\tthis.forceUpdate();\n\t\tthis.props.leafletIsEditing(false);\n\t\tthis.allowRender=true;\n\t}\n\n\tonGeometryClick=(event,record)=>{\n\t\tif (\n\t\t\ttypeof this.props.records === 'undefined' ||\n\t\t\tthis.isDrawing //||\n\t\t\t// this.props.showExhibitSettings\n\t\t){return;}\n\t\tL.DomEvent.stop(event);\n\t\tthis.props.selectRecord({record:record});\n\t\tif (this.props.viewMode === 'editing'){\n\t\t\tthis.props.setShowRecords(false);\n      this.props.setShowExhibitSettings(false);\n      this.props.setRecordEditorType('edit')\n\t\t}\n\t\tthis.forceUpdate();\n\t}\n\n\tonMapClick=(event)=>{\n\t\tL.DomEvent.stop(event);\n\t\tif(typeof this.props.records === 'undefined' || this.isDrawing){return;}\n\t\tthis.map.removeControl(this.ls_drawControl);\n    this.props.setShowRecords(true);\n\t\tthis.props.deselectRecord();\n\t\tthis.forceUpdate();\n\t}\n}\n\nconst mapDispatchToProps = dispatch => bindActionCreators({\n\tselectRecord,\n\tleafletIsEditing,\n\tdeselectRecord,\n\trecordMouseEnter: record => previewRecord(record),\n\trecordMouseLeave: unpreviewRecord,\n\tchange,\n\tdispatch,\n\tleafletIsSaving,\n\tupdateRecordCacheAndSave,\n\tsetShowRecords,\n  setShowExhibitSettings\n}, dispatch);\n\nexport default connect(null,mapDispatchToProps)(ExhibitPublicMap);\n","import React, {useRef, useEffect} from 'react';\nimport * as d3 from 'd3';\nimport './Timeline.css';\nimport { Icon } from 'semantic-ui-react';\n\n\nconst TLAxis = ({ domain, range, timeEntries, spanHeight }) => {\n\n    const parser = d3.isoParse;\n    const ref = useRef()\n    const ref2 = useRef()\n    // const spanHeight = 16;\n    const pointRadius = spanHeight/4;\n\n    const items = d3.nest().key(function(d) {\n        if (d.tier != null) {\n            return d.tier\n        } else {\n            return d.id;\n        }\n      }).entries(timeEntries).sort((a, b) => a.key - b.key);\n    // console.log(items)\n\n    useEffect(() => {\n    const x = d3.scaleTime()\n        .domain(domain)\n        .range(range)\n        .nice();\n\n    const zoom = d3.zoom()\n        // .scaleExtent([0.5, 32])\n        .on(\"zoom\", zoomed);\n\n    const svg = d3.select(ref.current)\n        // .attr('width', width)\n        // .attr('height', height)\n\n    const svg2 = d3.select(ref2.current)\n\n    const spanX = function(d) {\n    return x(parser(d.start_date));\n    };\n    \n    const spanW = function(d) {\n    return x(parser(d.end_date)) - x(parser(d.start_date));\n    };\n    \n    const span = function(item) {\n        const svg = d3.select(this);\n        return svg.selectAll('rect')\n            .data(item => item.values.filter(d => (d.end_date != null)))\n            .enter()\n            .append('rect')\n            .attr('x', d => spanX(d))\n            .attr('y', 0).attr('width', d => spanW(d))\n            .attr('height', spanHeight)\n            .attr('fill', d => d.fill_color) //#ddf\n            .style(\"cursor\", \"pointer\")\n            .on(\"click\", d=>console.log('start: ' + d.start_date + ' end: ' + d.end_date))\n    };\n\n    const spanLabels = function(item) {\n        const svg = d3.select(this);\n        return svg.selectAll('text .span')\n        .data(item => item.values.filter(d => (d.end_date != null)))\n        .enter()\n        .append('text')\n        .attr('class', 'span')\n        .attr('x', d => x(parser(d.end_date)) )\n        .attr('y', spanHeight/2 + 5)\n        .text(d=>d.title)\n    }\n\n    const point = function(item){\n        const svg = d3.select(this);\n        return svg.selectAll('circle')\n            .data(item => item.values.filter(d => (d.end_date === null)))\n            .enter().append('circle')\n            .attr('cx', d => spanX(d))\n            .attr('cy', spanHeight/2)\n            .attr('r', pointRadius)\n            .attr('fill', d => d.fill_color)\n            .style(\"cursor\", \"pointer\")\n            .on(\"click\", d=>console.log('start: ' + d.start_date + ' end: ' + d.end_date))\n    }\n\n    const pointLabels = function(item) {\n        const svg = d3.select(this);\n        return svg.selectAll('text .point')\n            .data(item => item.values.filter(d => (d.end_date === null)))\n            .enter().append('text')\n            .attr('class', 'point')\n            .attr('x', d => spanX(d)+ pointRadius)\n            .attr('y', spanHeight/2 + 5)\n            .text(d=>d.title)\n    }\n    \n    const allCharts = d3.select('.tl-main')\n        .selectAll('svg')\n        .data(items)\n        .enter().append('svg')\n        .attr('class', 'tl-item')\n        .attr('height', spanHeight)\n        .each(span, point)\n        .each(point)\n        .each(spanLabels)\n        .each(pointLabels);\n\n    const gx = svg2.append(\"svg\");\n\n    const buttonReset = d3.select(\"#reset\")\n    const buttonZoomIn = d3.select(\"#zoomIn\")\n    const buttonZoomOut = d3.select(\"#zoomOut\")\n\n    const axisHeight = (spanHeight * items.length) + 22;\n    const xAxis = (g, x) => g\n        .attr(\"color\", \"#333\") //#737373\n        .attr('height', axisHeight + 22)\n        .style('font-size', '0.9rem')\n        .call(d3.axisBottom(x).ticks(12).tickSize(axisHeight))\n        .call(g => g.select(\".domain\").attr(\"display\", \"none\")) //\"none\" to hide axis line\n        .call(g => g.selectAll(\".tick\").selectAll(\"line\").attr(\"stroke\", \"#D8D8D8\").style(\"stroke-dasharray\", \"5 5\")) //#bfbfbf\n        \n    function zoomed() {\n        const transform = d3.event.transform;\n        const zx = transform.rescaleX(x).interpolate(d3.interpolateRound);\n        gx.call(xAxis, zx);\n        allCharts.selectAll('rect')\n            .attr('x', d => transform.applyX(spanX(d)))\n            .attr('width', d => transform.k * spanW(d));\n        allCharts.selectAll('circle')\n            .attr('cx', d => transform.applyX(spanX(d)));\n        allCharts.selectAll('text.span')\n            .attr('x', d => transform.applyX(x(parser(d.end_date))));\n        allCharts.selectAll('text.point')\n            .attr('x', d => transform.applyX(spanX(d)) + pointRadius);\n      }\n    \n    function reset() {\n        svg.transition()\n            .duration(1000)\n            .call(zoom.transform, d3.zoomIdentity);\n      }\n    //   https://observablehq.com/@d3/programmatic-zoom\n    function zoomIn() {svg.transition().call(zoom.scaleBy, 2);}\n    function zoomOut() {svg.transition().call(zoom.scaleBy, 0.5);}\n      \n    buttonReset.on(\"click\", reset);\n    buttonZoomIn.on(\"click\", zoomIn);\n    buttonZoomOut.on(\"click\", zoomOut);\n    svg.call(zoom).call(zoom.transform, d3.zoomIdentity);\n    }, [])\n  \n    return (\n        <div className=\"nl-timeline-container\">\n            <div className=\"tl-controls\">\n                <span id=\"zoomIn\" className=\"tl-controls-button\">\n                <Icon name=\"search plus\" />\n                </span>\n                <span id=\"zoomOut\" className=\"tl-controls-button\">\n                <Icon name=\"search minus\" />\n                </span>\n                <span id=\"reset\" className=\"tl-controls-button\">\n                <Icon name=\"undo alternate\" />\n                </span>\n            </div>\n            <div\n                className=\"tl-main\"\n                ref={ref}\n            />\n            <div\n                className=\"tl-axis\"\n                ref={ref2}\n            />\n        </div>\n    )\n  }\n\nexport default TLAxis;","import React from 'react';\nimport * as d3 from 'd3';\nimport TLAxis from './TLAxis.js';\n\n\nconst Timeline = () => {\n    const parser = d3.isoParse;\n\n    const data = [\n      { \"tier\": \"1\", \"id\": \"69\", \"owner_id\": \"2\", \"item_id\": null, \"exhibit_id\": \"5\", \"added\": \"2020-04-29 15:06:48\", \"modified\": \"2020-04-29 04:10:49\", \"is_coverage\": \"1\", \"is_wms\": \"0\", \"slug\": null, \"title\": \"Lynn Carol Allen\", \"item_title\": null, \"body\": null, \"coverage\": \"0x00000000010700000001000000010100000016bd53bcb36c62c1f26327f5287c5041\", \"tags\": \"sportsmaker\", \"widgets\": \"Simile\", \"presenter\": \"StaticBubble\", \"fill_color\": \"#00aeff\", \"fill_color_select\": \"#00aeff\", \"stroke_color\": \"white\", \"stroke_color_select\": \"black\", \"fill_opacity\": \"0.80\", \"fill_opacity_select\": \"1.00\", \"stroke_opacity\": \"0.80\", \"stroke_opacity_select\": \"1.00\", \"stroke_width\": \"2\", \"point_radius\": \"6\", \"zindex\": null, \"weight\": null, \"start_date\": \"1951-10-22\", \"end_date\": \"1954-10-22\", \"after_date\": null, \"before_date\": null, \"point_image\": null, \"wms_address\": null, \"wms_layers\": null, \"min_zoom\": null, \"max_zoom\": null, \"map_zoom\": \"5\", \"map_focus\": \"-10767225.550863,4172850.2475636\" },\n      { \"tier\": \"1\", \"id\": \"60\", \"owner_id\": \"2\", \"item_id\": null, \"exhibit_id\": \"5\", \"added\": \"2020-04-29 15:26:15\", \"modified\": \"2020-04-29 04:10:36\", \"is_coverage\": \"1\", \"is_wms\": \"0\", \"slug\": null, \"title\": \"Katherine Bennett\", \"item_title\": null, \"body\":  null, \"coverage\": \"0x000000000107000000010000000101000000a3a366e0e62e60c188380ccb33905041\", \"tags\": \"sportsmaker\", \"widgets\": \"Simile\", \"presenter\": \"StaticBubble\", \"fill_color\": \"#98df8a\", \"fill_color_select\": \"#00aeff\", \"stroke_color\": \"white\", \"stroke_color_select\": \"black\", \"fill_opacity\": \"0.80\", \"fill_opacity_select\": \"1.00\", \"stroke_opacity\": \"0.80\", \"stroke_opacity_select\": \"1.00\", \"stroke_width\": \"2\", \"point_radius\": \"6\", \"zindex\": null, \"weight\": null, \"start_date\": \"1932-10-17\", \"end_date\": \"1933-10-17\", \"after_date\": null, \"before_date\": null, \"point_image\": null, \"wms_address\": null, \"wms_layers\": null, \"min_zoom\": null, \"max_zoom\": null, \"map_zoom\": \"5\", \"map_focus\": \"-10767225.550863,4172850.2475636\" },\n      { \"tier\": null, \"id\": \"61\", \"owner_id\": \"2\", \"item_id\": null, \"exhibit_id\": \"5\", \"added\": \"2020-04-29 15:31:03\", \"modified\": \"2020-04-29 04:10:24\", \"is_coverage\": \"1\", \"is_wms\": \"0\", \"slug\": null, \"title\": \"Evie Garrett Dennis\", \"item_title\": null, \"body\": null, \"coverage\": \"0x00000000010700000001000000010100000070057991b01163c113fa4f5ad55c4d41\", \"tags\": \"sportsmaker\", \"widgets\": \"Simile\", \"presenter\": \"StaticBubble\", \"fill_color\": \"#00aeff\", \"fill_color_select\": \"#00aeff\", \"stroke_color\": \"white\", \"stroke_color_select\": \"black\", \"fill_opacity\": \"0.80\", \"fill_opacity_select\": \"1.00\", \"stroke_opacity\": \"0.80\", \"stroke_opacity_select\": \"1.00\", \"stroke_width\": \"2\", \"point_radius\": \"6\", \"zindex\": null, \"weight\": null, \"start_date\": \"1944-9-8\", \"end_date\": \"1945-9-8\", \"after_date\": null, \"before_date\": null, \"point_image\": null, \"wms_address\": null, \"wms_layers\": null, \"min_zoom\": null, \"max_zoom\": null, \"map_zoom\": \"5\", \"map_focus\": \"-10767225.550863,4172850.2475636\" },\n      { \"tier\": null, \"id\": \"62\", \"owner_id\": \"2\", \"item_id\": null, \"exhibit_id\": \"5\", \"added\": \"2020-04-29 15:37:26\", \"modified\": \"2020-04-29 04:10:04\", \"is_coverage\": \"1\", \"is_wms\": \"0\", \"slug\": null, \"title\": \"Benita Fitzgerald Mosley\", \"item_title\": null, \"body\": null, \"coverage\": \"0x0000000001070000000100000001010000008399c0e49b6a60c1541f48280cd15141\", \"tags\": \"sportsmaker\", \"widgets\": \"Simile\", \"presenter\": \"StaticBubble\", \"fill_color\": \"#00aeff\", \"fill_color_select\": \"#00aeff\", \"stroke_color\": \"white\", \"stroke_color_select\": \"black\", \"fill_opacity\": \"0.80\", \"fill_opacity_select\": \"1.00\", \"stroke_opacity\": \"0.80\", \"stroke_opacity_select\": \"1.00\", \"stroke_width\": \"2\", \"point_radius\": \"6\", \"zindex\": null, \"weight\": null, \"start_date\": \"1961-7-6\", \"end_date\": null, \"after_date\": null, \"before_date\": null, \"point_image\": null, \"wms_address\": null, \"wms_layers\": null, \"min_zoom\": null, \"max_zoom\": null, \"map_zoom\": \"5\", \"map_focus\": \"-10767225.550863,4172850.2475636\" },\n      { \"tier\": null, \"id\": \"63\", \"owner_id\": \"2\", \"item_id\": null, \"exhibit_id\": \"5\", \"added\": \"2020-04-29 16:02:32\", \"modified\": \"2020-04-29 04:09:45\", \"is_coverage\": \"1\", \"is_wms\": \"0\", \"slug\": null, \"title\": \"Dionne Warwick\", \"item_title\": null, \"body\": null, \"coverage\": \"0x0000000001070000000100000001010000005ae553a2ec825fc1f5eb18b7acfc5241\", \"tags\": \"musicmaker\", \"widgets\": \"Simile\", \"presenter\": \"StaticBubble\", \"fill_color\": \"#98df8a\", \"fill_color_select\": \"#98df8a\", \"stroke_color\": \"white\", \"stroke_color_select\": \"black\", \"fill_opacity\": \"0.80\", \"fill_opacity_select\": \"1.00\", \"stroke_opacity\": \"0.80\", \"stroke_opacity_select\": \"1.00\", \"stroke_width\": \"2\", \"point_radius\": \"6\", \"zindex\": null, \"weight\": null, \"start_date\": null, \"end_date\": null, \"after_date\": null, \"before_date\": null, \"point_image\": null, \"wms_address\": null, \"wms_layers\": null, \"min_zoom\": null, \"max_zoom\": null, \"map_zoom\": \"5\", \"map_focus\": \"-10767225.550863,4172850.2475636\" },\n      { \"tier\": \"2\", \"id\": \"64\", \"owner_id\": \"2\", \"item_id\": null, \"exhibit_id\": \"5\", \"added\": \"2020-04-29 16:20:40\", \"modified\": \"2020-04-29 04:56:55\", \"is_coverage\": \"1\", \"is_wms\": \"0\", \"slug\": null, \"title\": \"Billie Allen\", \"item_title\": null, \"body\": null, \"coverage\": \"0x000000000107000000010000000101000000acdc70718f7160c144db31d9f7375141\", \"tags\": \"artmaker\", \"widgets\": \"Simile\", \"presenter\": \"StaticBubble\", \"fill_color\": \"#f781bf\", \"fill_color_select\": \"#f781bf\", \"stroke_color\": \"white\", \"stroke_color_select\": \"black\", \"fill_opacity\": \"0.80\", \"fill_opacity_select\": \"1.00\", \"stroke_opacity\": \"0.80\", \"stroke_opacity_select\": \"1.00\", \"stroke_width\": \"2\", \"point_radius\": \"6\", \"zindex\": null, \"weight\": null, \"start_date\": \"1925-1-13\", \"end_date\": null, \"after_date\": null, \"before_date\": null, \"point_image\": null, \"wms_address\": null, \"wms_layers\": null, \"min_zoom\": null, \"max_zoom\": null, \"map_zoom\": \"5\", \"map_focus\": \"-10767225.550863,4172850.2475636\" },\n      { \"tier\": null, \"id\": \"65\", \"owner_id\": \"2\", \"item_id\": null, \"exhibit_id\": \"5\", \"added\": \"2020-04-29 17:00:08\", \"modified\": \"2020-04-29 05:01:11\", \"is_coverage\": \"1\", \"is_wms\": \"0\", \"slug\": null, \"title\": \"Madeleine Moore Burrell\", \"item_title\": null, \"body\": null, \"coverage\": \"0x000000000107000000010000000101000000be2951ddc0675fc1b284b5c953ec5241\", \"tags\": \"mediamaker\", \"widgets\": \"Simile\", \"presenter\": \"StaticBubble\", \"fill_color\": \"#f0027f\", \"fill_color_select\": \"#f0027f\", \"stroke_color\": \"white\", \"stroke_color_select\": \"black\", \"fill_opacity\": \"0.80\", \"fill_opacity_select\": \"1.00\", \"stroke_opacity\": \"0.80\", \"stroke_opacity_select\": \"1.00\", \"stroke_width\": \"2\", \"point_radius\": \"6\", \"zindex\": null, \"weight\": null, \"start_date\": \"1940-9-10\", \"end_date\": null, \"after_date\": null, \"before_date\": null, \"point_image\": null, \"wms_address\": null, \"wms_layers\": null, \"min_zoom\": null, \"max_zoom\": null, \"map_zoom\": \"5\", \"map_focus\": \"-10767225.550863,4172850.2475636\" },\n      { \"tier\": \"2\", \"id\": \"66\", \"owner_id\": \"2\", \"item_id\": null, \"exhibit_id\": \"5\", \"added\": \"2020-04-29 17:22:08\", \"modified\": \"2020-04-29 05:23:23\", \"is_coverage\": \"1\", \"is_wms\": \"0\", \"slug\": null, \"title\": \"Anna Langford\", \"item_title\": null, \"body\": null, \"coverage\": \"0x00000000010700000001000000010100000013765b65eacb61c1c3c8dc7c1a845241\", \"tags\": \"lawmaker\", \"widgets\": \"Simile\", \"presenter\": \"StaticBubble\", \"fill_color\": \"#ffbb78\", \"fill_color_select\": \"#ffbb78\", \"stroke_color\": \"white\", \"stroke_color_select\": \"black\", \"fill_opacity\": \"0.80\", \"fill_opacity_select\": \"1.00\", \"stroke_opacity\": \"0.80\", \"stroke_opacity_select\": \"1.00\", \"stroke_width\": \"2\", \"point_radius\": \"6\", \"zindex\": null, \"weight\": null, \"start_date\": \"1917-10-27\", \"end_date\": null, \"after_date\": null, \"before_date\": null, \"point_image\": null, \"wms_address\": null, \"wms_layers\": null, \"min_zoom\": null, \"max_zoom\": null, \"map_zoom\": \"5\", \"map_focus\": \"-10767225.550863,4172850.2475636\" },\n      { \"tier\": null, \"id\": \"67\", \"owner_id\": \"2\", \"item_id\": null, \"exhibit_id\": \"5\", \"added\": \"2020-04-30 17:55:38\", \"modified\": \"2020-04-30 05:57:04\", \"is_coverage\": \"1\", \"is_wms\": \"0\", \"slug\": null, \"title\": \"Ruth Beckford\", \"item_title\": null, \"body\": null, \"coverage\": \"0x000000000107000000010000000101000000bce7c093a9f669c10b4c02ce835d5141\", \"tags\": \"artmaker\", \"widgets\": \"Simile\", \"presenter\": \"StaticBubble\", \"fill_color\": \"#f781bf\", \"fill_color_select\": \"#f781bf\", \"stroke_color\": \"white\", \"stroke_color_select\": \"black\", \"fill_opacity\": \"0.80\", \"fill_opacity_select\": \"1.00\", \"stroke_opacity\": \"0.80\", \"stroke_opacity_select\": \"1.00\", \"stroke_width\": \"2\", \"point_radius\": \"6\", \"zindex\": null, \"weight\": null, \"start_date\": \"1925-12-7\", \"end_date\": null, \"after_date\": null, \"before_date\": null, \"point_image\": null, \"wms_address\": null, \"wms_layers\": null, \"min_zoom\": null, \"max_zoom\": null, \"map_zoom\": \"5\", \"map_focus\": \"-10767225.550863,4172850.2475636\" },\n        ]\n     \n    const minDate = d3.min(data, function(d) {\n        return parser(d.start_date);\n      });\n    const maxDate = d3.max(data, function(d) {\n        return parser(d.end_date);\n      });\n    // console.log(minDate, maxDate)\n\n    const timeEntries = data.filter(d => d.start_date != null)\n    // console.log(timeEntries)\n\n    const xScale = \n        d3.scaleTime()\n        .domain([minDate,maxDate])\n        //range should be container width\n        .range([0, 1000]);\n    \n    // console.log(xScale.range())\n\n    const spanHeight = 16;\n\n    return (\n        <TLAxis \n            // data={data}          \n            domain={xScale.domain()}\n            range={xScale.range()} \n            timeEntries={timeEntries}\n            spanHeight={spanHeight}\n      />    \n    )\n}\n\nexport default Timeline;","import React, { Component } from 'react';\nimport './NeatlineText.css';\n\n\nclass NarrativePanel extends Component {\n\n\n    render() {\n        return (\n            <div className=\"nl-narrative\">\n                <h2>Rendered content</h2>\n                {/* <div dangerouslySetInnerHTML={ { __html: this.props.data } }></div> */}\n            </div>\n        );\n    }\n}\n\nexport default NarrativePanel;\n","import React from 'react';\nimport { bindActionCreators } from 'redux';\nimport { connect } from 'react-redux';\n\nfunction RecordInfoPanel(props) {\n  const { selectedRecord, previewedRecord} = props;\n  const record = selectedRecord || previewedRecord;\n\n  if (record) {\n\n\t  let className = props.mapCache.hasUnsavedChanges?\"ps_n3_info_component_withWarning\":\"ps_n3_info_component\";\n\t  \t  className = props.isVisible?className:\"hidden\";\n    return (\n      <div className={className}>\n        <div style={{ marginRight: '20px' }}>{record['o:title']}</div>\n        {selectedRecord &&\n          <div>\n            <hr />\n            <p>{record['o:body']}</p>\n          </div>\n        }\n      </div>\n    )\n  }\n\n  return null;\n}\n\nconst mapStateToProps = state => ({\n\tmapCache: state.mapCache,\n\tselectedRecord: state.exhibitShow.selectedRecord,\n\tpreviewedRecord: state.exhibitShow.previewedRecord\n});\n\nconst mapDispatchToProps = dispatch => bindActionCreators({}, dispatch);\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps,\n)(RecordInfoPanel);\n","import React, { Component } from 'react';\nimport { selectRecord, filterRecords, removeRecordFromCache, deleteRecord} from '../../actions';\nimport {bindActionCreators} from 'redux';\nimport {connect} from 'react-redux';\nimport { strings } from '../../i18nLibrary';\nimport { Icon, Button, Search, Card } from 'semantic-ui-react';\n// import _ from 'lodash';\n\nclass Records extends Component {\n\tconstructor(props){\n\t\tsuper(props)\n\t\tthis.state = { activeCard: null };\n\t}\n\tcomponentWillMount() {\n\t\tthis.setState({ column: null, direction: null});\n\t\tthis.resetSearch();\n\t}\n\tresetSearch = () => this.setState({ results: this.props.filteredRecords, column: null, direction: null, 'searchTerm': '' });\n\n\tsearchChange = (e, d) => {\n\t\tif (d.value.length < 1) return this.resetSearch()\n\t\tthis.setState({'searchTerm': d.value})\n\t}\n\n\thandleSort = clickedColumn => () => {\n\t\tconst { column, results, direction } = this.state\n\n\t\tif (column !== clickedColumn) {\n\t\t\tthis.setState({\n\t\t\t\tcolumn: clickedColumn,\n\t\t\t\tresults: results.sort(function(a, b) {\n\t\t\t\t\tif (a[clickedColumn] != null && b[clickedColumn] != null) {\n\t\t\t\t\t\tif (clickedColumn === 'o:title'){\n\t\t\t\t\t\t return a[clickedColumn].toUpperCase().localeCompare(b[clickedColumn].toUpperCase());\n\t\t\t\t\t\t} \n\t\t\t\t\t\tif (clickedColumn === 'o:added'){\n\t\t\t\t\t\t return new Date(a[clickedColumn]) - new Date(b[clickedColumn]);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t return new Date(a['o:added']) - new Date(b['o:added']);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn new Date(a['o:added']) - new Date(b['o:added']);\n\t\t\t\t\t}\n\t\t\t\t}),\n\t\t\t\tdirection: 'ascending',\n\t\t\t})\n\t\t\treturn\n\t\t}\n\n\t\tthis.setState({\n\t\t\tresults: this.props.filteredRecords.reverse(),\n\t\t\tdirection: direction === 'ascending' ? 'descending' : 'ascending',\n\t\t})\n\t}\n\tmouseClick = (e, d) => {\n\t\tif (e.keyCode === 13) {\n\t\t\tlet results = this.props.records.filter(record => (record['o:title'] || '').includes(this.state.searchTerm));\n\t\t\treturn this.props.filterRecords(results)\n\t\t}\n\n\t}\n\tsetActiveCard = (record_id) => {\n\t\tthis.setState({activeCard: record_id})\n\t}\n\trender () {\n\t\tconst props = this.props;\n\t\tconst state = this.state;\n\t\treturn(\n\t\t\t<div className=\"nl-records-editor\">\n\t\t\t{this.props.viewMode === 'editing' ?\n\t\t\t<div>\n\t\t\t\t<Search\n\t\t\t\t\tfluid\n\t\t\t\t\tonSearchChange={(e, d) => this.searchChange(e, d)}\n\t\t\t\t\tshowNoResults={false}\n\t\t\t\t\tsize='small'\n\t\t\t\t\tonKeyDown={(e, d) => this.mouseClick(e, d)}\n\t\t\t\t\tplaceholder='Press enter to submit'\n\t\t\t\t/>\n\t\t\t\t<Button size='medium' fluid icon color='blue'\n\t\t\t\t\tonClick={() => { props.setRecordEditorType('new'); props.setShowRecords(false) }}>\n\t\t\t\t\t{strings.new_record} <Icon name=\"sticky note outline\" /></Button>\n\t\t\t\t</div>\n\t\t\t: null }\n\t\t\t{ this.props.viewMode === 'editing' ?\n\t\t\t\t<table className=\"tablesaw neatline tablesaw-stack neatline-records\">\n\t\t\t\t<thead>\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<th\n\t\t\t\t\t\t\tclassName={state.column === 'o:title' ? state.direction : null}\n\t\t\t\t\t\t\tonClick={this.handleSort('o:title')}\n\t\t\t\t\t\t\t>Record Title</th>\n\t\t\t\t\t\t<th\n\t\t\t\t\t\t\tclassName={state.column === 'o:added' ? state.direction : null}\n\t\t\t\t\t\t\tonClick={this.handleSort('o:added')}\n\t\t\t\t\t\t>Record Created</th>\n\t\t\t\t\t</tr>\n\t\t\t\t</thead>\n\t\t\t\t<tbody>\n\t\t\t\t\t{props.filteredRecords.map(record => (\n\t\t\t\t\t\t<tr key={'record-' + record['o:id']} >\n\t\t\t\t\t\t\t<td style={{\n\t\t\t\t\t\t\t\tfontWeight: record === props.selectedRecord ? 'bold' : 'normal'\n\t\t\t\t\t\t\t}}>\n\t\t\t\t\t\t\t\t<b className=\"tablesaw-cell-label\">Record Title</b>\n\t\t\t\t\t\t\t\t<span className=\"tablesaw-cell-content\">\n\t\t\t\t\t\t\t\t\t<a \n\t\t\t\t\t\t\t\t\t\tclassName='ps_n3_exhibitTitle'\n\t\t\t\t\t\t\t\t\t\tonClick={() => { props.selectRecord({ record: record }); props.setShowRecords(false); props.setRecordEditorType('edit') }}\n\t\t\t\t\t\t\t\t\t>{record['o:title'] === null ? \"???\" : record['o:title']}\n\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t\t<ul className=\"actions neatline\">\n\t\t\t\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t\t\t\t<a title=\"Edit Record\" onClick={() => { props.selectRecord({ record: record }); props.setShowRecords(false); props.setRecordEditorType('edit') }} aria-label=\"Edit Record\">\n\t\t\t\t\t\t\t\t\t\t\t<Icon name=\"pencil alternate\" /></a>\n\t\t\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\t\t\t{props.userSignedIn &&\n\t\t\t\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\t\t\t\t\tthis.props.dispatch(this.props.removeRecordFromCache(record['o:id']));\n\t\t\t\t\t\t\t\t\t\t\t\tthis.props.deleteRecord(record);\n\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\tdisabled={props.deleteInProgress}\n\t\t\t\t\t\t\t\t\t\t\t><Icon name=\"trash alternate\"/>\n\t\t\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t<b className=\"tablesaw-cell-label\">Record Created</b>\n\t\t\t\t\t\t\t\t<span className=\"tablesaw-cell-content\">\n\t\t\t\t\t\t\t\t\t{record['o:added'] === null ? \"???\" : record['o:added'].toString()}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t))\n\t\t\t\t\t}\n\t\t\t\t</tbody>\n\t\t\t</table> \n\t\t\t: <div className=\"ps_n3_exhibitFormContainer\">\n\t\t\t{props.filteredRecords.map( record => (\n\t\t\t\t\t<Card\n\t\t\t\t\t\tstyle={{marginTop:'4px'}}\n\t\t\t\t\t\tfluid\n\t\t\t\t\t\tkey={record['o:id']}\n\t\t\t\t\t\tcolor={((this.props.selectedRecord !== null) && (record['o:id'] === this.props.selectedRecord['o:id']) )? 'blue': null }\n\t\t\t\t\t>\n\t\t\t\t\t\t<Card.Content\n\t\t\t\t\t\t\tonClick={() => { this.setActiveCard(record['o:id']); props.selectRecord({ record: record }); }}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<Card.Header>{record['o:title']}</Card.Header>\n\t\t\t\t\t\t\t<Card.Description\n\t\t\t\t\t\t\t style={{whiteSpace: 'nowrap', overflow: 'hidden', textOverflow: 'ellipsis'}}\n\t\t\t\t\t\t\t>{record['o:body']}</Card.Description>\n\t\t\t\t\t\t</Card.Content>\n\t\t\t\t\t</Card>\n\t\t\t\t))}\n\t\t\t\t</div>\n\t\t\t}\n\t\t\t</div>\n\t\t);\n\t}\n}\n\n\nconst mapStateToProps = state => ({\n\trecord:state.record,\n\trecords: state.exhibitShow.records,\n\tselectedRecord: state.exhibitShow.selectedRecord,\n\tfilteredRecords: state.exhibitShow.filteredRecords,\n});\n\nconst mapDispatchToProps = dispatch => bindActionCreators({\n\tselectRecord,\n\tfilterRecords,\n\tdeleteRecord,\n\tremoveRecordFromCache,\n\tdispatch\n}, dispatch);\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Records);\n","//https://casesandberg.github.io/react-color/\nimport { SketchPicker } from 'react-color';\nimport React from 'react';\n\nclass ColorPicker extends React.Component {\n\trender() {\n\t\treturn (\n\t\t\t<div id=\"ps_n3_colorPickerComponent\" style={{top:this.props.top,left:'30px'}} className={this.props.isVisible?\"ps_n3_colorPicker_picker\":\"ps_n3_colorPicker_picker ps_n3_hidden\"}>\n\t\t\t\t<SketchPicker color={this.props.color} onChange={ this.props.handleChange }/>\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default (ColorPicker);\n","import React from 'react';\nimport {Field} from 'redux-form';\nimport DayPickerInput from 'react-day-picker/DayPickerInput';\nimport moment from 'moment';\n\nclass DatePicker extends React.Component {\n\trender() {\n\t\tlet thisValue=this.props.formatDate(this.props.value);\n\t\tif(!moment(this.props.value).isValid()){\n\t\t\tthisValue='';\n\t\t}\n\t\treturn (\n\t\t\t<div>\n\t\t\t\t<label \thtmlFor={this.props.fieldName}>{this.props.label}</label>\n\t\t\t\t<Field \tid={this.props.fieldName}\n\t\t\t\t\t\tname={this.props.fieldName}\n\t\t\t\t\t\tcomponent='input'\n\t\t\t\t\t\ttype='hidden'/>\n\n\t\t\t\t<DayPickerInput\tclassName=\"styleEditor_input\"\n\t\t\t\t\t\t\t\tformatDate={this.props.formatDate}\n\t\t\t\t\t\t\t\tparseDate={this.props.parseDate}\n\t\t\t\t\t\t\t\tvalue={thisValue}\n\t\t\t\t\t\t\t\tonDayChange={(value)=>{this.props.onDayChange({target:{value:value,name:this.props.fieldName}})}}/>\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default (DatePicker);\n","import React, {Component} from 'react';\nimport {Field, reduxForm, change} from 'redux-form';\nimport {Tabs, TabList, Tab, TabPanel} from 'react-tabs';\nimport {connect} from 'react-redux';\nimport {setUnsavedChanges, updateRecordCache, removeRecordFromCache} from '../../actions';\nimport ColorPicker from '../ColorPicker'\nimport DatePicker from '../DatePicker';\nimport {strings} from '../../i18nLibrary';\nimport {formatDate, parseDate} from 'react-day-picker/moment';\nimport 'react-day-picker/lib/style.css';\nimport Slider from 'react-rangeslider';\nimport 'react-rangeslider/lib/index.css';\nimport moment from 'moment';\nimport {bindActionCreators} from 'redux';\n\nconst defaultValues = {\n\t'o:fill_color': '#00aeff',\n\t'o:fill_color_select': '#00aeff',\n\t'o:stroke_color': '#000000',\n\t'o:stroke_color_select': '#000000',\n\t'o:fill_opacity': 0.3,\n\t'o:fill_opacity_select': 0.4,\n\t'o:stroke_opacity': 0.9,\n\t'o:stroke_opacity_select': 1,\n\t'o:stroke_width': 2,\n\t'o:point_radius': 10\n};\n\nclass RecordForm extends Component {\n\n\tconstructor(props) {\n\t\tsuper(props);\n\t\t// console.log(props);\n\t\t// Mapping to this\n\t\tthis.change = change;\n\t\tthis.handleSubmit = props.handleSubmit;\n\t\tthis.submitLabel = props.submitLabel;\n\t\tthis.disabled = props.disabled;\n\t\tthis.showDelete = props.showDelete;\n\t\tthis.handleDelete = props.handleDelete;\n\n\t\tthis.slider = {\n\t\t\tfieldName: '',\n\t\t\tvalue: ''\n\t\t};\n\n\t\tthis.state = {\n\t\t\tstrings,\n\t\t\texhibitType: 'map',\n\t\t\tcolorPickerVisible: false,\n\t\t\tcolorPickerTop: 0,\n\t\t\tcolorPickerCurrentColor: '000000',\n\t\t\tcolorPickerCurrentField: '',\n\t\t\tcolorPickerDefaultColor: '#000000',\n\t\t\tsliderValues: {}\n\t\t};\n\t\tthis.cacheInitialized = false;\n\t}\n\n\tcomponentDidMount() {\n\t\t// For the sliders, setup initial values\n\t\tlet initialSliderValues = {\n\t\t\t'o:fill_opacity': isNaN(parseFloat(this.props.initialValues['o:fill_opacity']))?0:parseFloat(this.props.initialValues['o:fill_opacity']),\n\t\t\t'o:stroke_opacity': isNaN(parseFloat(this.props.initialValues['o:stroke_opacity']))?0:parseFloat(this.props.initialValues['o:stroke_opacity']),\n\t\t\t'o:stroke_opacity_select': isNaN(parseFloat(this.props.initialValues['o:stroke_opacity_select']))?0:parseFloat(this.props.initialValues['o:stroke_opacity_select']),\n\t\t\t'o:stroke_width': isNaN(parseFloat(this.props.initialValues['o:stroke_width']))?0:parseFloat(this.props.initialValues['o:stroke_width']),\n\t\t\t'o:fill_opacity_select': isNaN(parseFloat(this.props.initialValues['o:fill_opacity_select']))?0:parseFloat(this.props.initialValues['o:fill_opacity_select'])\n\t\t}\n\t\tthis.setState({sliderValues: initialSliderValues});\n\t}\n\n\tcomponentWillReceiveProps(nextprops) {\n\t\t// Update the cache if the record changed or not yet initialized\n\t\tif (!this.cacheInitialized || (nextprops.initialValues['o:id'] !== this.props.initialValues['o:id'])) {\n\t\t\tthis.props.updateRecordCache({setValues: nextprops.initialValues});\n\t\t\tthis.setState({recordID: nextprops.initialValues['o:id']});\n\t\t\tthis.cacheInitialized = true;\n\t\t}\n\t}\n\n\t// Sets the unsaved changes flag\n\t// FIXME: this event handler is overloaded\n\tmarkUnsaved = (event) => {\n\t\tif (typeof event !== 'undefined') {\n\t\t\t// Converting moment into string for storage\n\t\t\tif (event.target.name.includes(\"date\")) {\n\t\t\t\tevent.target.value = moment(event.target.value).format('YYYY-MM-DD');\n\t\t\t}\n\t\t\tthis.props.updateRecordCache({\n\t\t\t\tsetValues: {\n\t\t\t\t\t'o:id': this.props.initialValues['o:id'],\n\t\t\t\t\t[event.target.name]: event.target.value\n\t\t\t\t}\n\t\t\t});\n\t\t}\n    if (!this.props.mapCache.hasUnsavedChanges)\n\t   this.props.setUnsavedChanges({hasUnsavedChanges: true});\n\t}\n\n\t// Delete a record\n\tdeleteRecord = () => {\n\t\tconsole.log('delete Record', this.props.initialValues['o:id'])\n\t\tthis.props.removeRecordFromCache({recordID: this.props.initialValues['o:id']});\n\t\tthis.handleDelete();\n\t}\n\n\tscrollEvent = (event) =>{\n\t\tthis.hideColorPicker(event);\n\t}\n\trender() {\n\n\t\tlet thisRecord = this.props.mapCache.cache[this.props.initialValues['o:id']];\n\t\tlet isSelected = (this.props.selectedRecord && this.state.recordID === this.props.selectedRecord[\"o:id\"]);\n\n\t\tif(this.props.userSignedIn){\n\t\t\treturn (\n\t\t\t\t<form className='ps_n3_exhibit-form' onSubmit={this.handleSubmit}>\n\n\t\t\t\t<ColorPicker color={this.state.colorPickerCurrentColor} isVisible={this.state.colorPickerVisible} \n\t\t\t\t// top={this.state.colorPickerTop} \n\t\t\t\ttop=\"30px\"\n\t\t\t\thandleChange={this.handleColorChange}/>\n\t\t\t\t<Tabs>\n\n\t\t\t\t\t<TabList>\n\t\t\t\t\t\t<Tab>{strings.text}</Tab>\n\t\t\t\t\t\t<Tab>{strings.style}</Tab>\n\t\t\t\t\t</TabList>\n\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<TabPanel>\n\t\t\t\t\t\t\t<div className=\"ps_n3_recordFormContainer\" onScroll={this.scrollEvent}>\n\t\t\t\t\t\t\t\t<fieldset disabled={this.disabled} style={{border: 'none', padding: '0' }}>\n\t\t\t\t\t\t\t\t\t<legend><h4>Text Description</h4></legend>\n\t\t\t\t\t\t\t\t\t<div className='field'>\n\t\t\t\t\t\t\t\t\t\t<label \thtmlFor='o:title'>{strings.title}</label>\n\t\t\t\t\t\t\t\t\t\t<div className='ui input'>\n\t\t\t\t\t\t\t\t\t\t<Field \tid='o:title'\n\t\t\t\t\t\t\t\t\t\t\t\tname='o:title'\n\t\t\t\t\t\t\t\t\t\t\t\tcomponent='textarea'\n\t\t\t\t\t\t\t\t\t\t\t\tonChange={this.markUnsaved}/>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div className='field'>\n\t\t\t\t\t\t\t\t\t\t<label \thtmlFor='o:slug'>{strings.slug}</label>\n\t\t\t\t\t\t\t\t\t\t<div className='ui input'>\n\t\t\t\t\t\t\t\t\t\t<Field \tid='o:slug'\n\t\t\t\t\t\t\t\t\t\t\t\tname='o:slug'\n\t\t\t\t\t\t\t\t\t\t\t\tcomponent='input'\n\t\t\t\t\t\t\t\t\t\t\t\ttype='text'\n\t\t\t\t\t\t\t\t\t\t\t\tonChange={this.markUnsaved}/>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div className='field'>\n\t\t\t\t\t\t\t\t\t\t<label \thtmlFor='o:body'>{strings.body}</label>\n\t\t\t\t\t\t\t\t\t\t<div className='ui input'>\n\t\t\t\t\t\t\t\t\t\t<Field \tid='o:body'\n\t\t\t\t\t\t\t\t\t\t\t\tname='o:body'\n\t\t\t\t\t\t\t\t\t\t\t\tcomponent='textarea'\n\t\t\t\t\t\t\t\t\t\t\t\tonChange={this.markUnsaved}/>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</fieldset>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</TabPanel>\n\t\t\t\t\t\t<TabPanel>\n\t\t\t\t\t\t\t<div className=\"ps_n3_recordFormContainer\" onScroll={this.scrollEvent} >\n\t\t\t\t\t\t\t\t\t{(typeof this.state.recordID === 'undefined') && <div>\n\t\t\t\t\t\t\t\t\t\t<i>save record before editing style</i>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t{(typeof this.state.recordID !== 'undefined') && <div>\n\t\t\t\t\t\t\t\t\t\t<fieldset id=\"scrollArea_stylePropertyPicker\" disabled={this.disabled} style={{border: 'none', padding: '0' }}>\n\t\t\t\t\t\t\t\t\t\t\t<div className={!isSelected ? \"ps_n3_highlight\":\"\"}>\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"ps_n3_optionHeader\">{strings.colors}</div>\n\t\t\t\t\t\t\t\t\t\t\t\t<div className='field'>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<label \thtmlFor='o:fill_color'>{strings.fill_color}</label>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div className='ui input'>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Field \tclassName=\"styleEditor_input\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tid='o:fill_color'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tname='o:fill_color'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcomponent='input'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype='text'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdata-enforce='hex'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonChange={this.inputEnforce}/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div \tclassName=\"ps_n3_inputColorSwatch\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdata-initialcolor={this.props.initialValues['o:fill_color']}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdata-fieldname='o:fill_color'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={(event) => this.showColorPicker(event, 'o:fill_color')}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle={{backgroundColor:(typeof thisRecord !== 'undefined')?thisRecord['o:fill_color']:'#0000FF'}}/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t<div className='field'>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<label \thtmlFor='o:stroke_color'>{strings.stroke_color}</label>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div className='ui input'>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Field \tclassName=\"styleEditor_input\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tid='o:stroke_color'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tname='o:stroke_color'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcomponent='input'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype='text'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdata-enforce='hex'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonChange={this.inputEnforce}/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div \tclassName=\"ps_n3_inputColorSwatch\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdata-fieldname='o:stroke_color'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdata-initialcolor={this.props.initialValues['o:stroke_color']}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={(event) => this.showColorPicker(event, 'o:stroke_color')}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle={{backgroundColor:(typeof thisRecord !== 'undefined')?thisRecord['o:stroke_color']:'#0000FF'}}\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<label htmlFor='o:fill_opacity'>{strings.fill_opacity}</label>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Slider value={this.state.sliderValues['o:fill_opacity']}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tmin={0.1} max={1.0} step={0.01}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\torientation=\"horizontal\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonChangeStart={() => this.slider_changeStart('o:fill_opacity')}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonChange={this.slider_change}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonChangeComplete={this.slider_changeComplete}/>\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Field \tid='o:fill_opacity'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tname='o:fill_opacity'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcomponent='input'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype='hidden'/>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<label htmlFor='o:stroke_opacity'>{strings.stroke_opacity}</label>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Slider value={this.state.sliderValues['o:stroke_opacity']}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tmin={0.1} max={1.0} step={0.01}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\torientation=\"horizontal\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonChangeStart={() => this.slider_changeStart('o:stroke_opacity')}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonChange={this.slider_change}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonChangeComplete={this.slider_changeComplete}/>\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Field \tid='o:stroke_opacity'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tname='o:fill_opacity'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcomponent='input'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype='hidden'/>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t<div className={isSelected\n\t\t\t\t\t\t\t\t\t\t\t\t\t? \"ps_n3_highlight\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t: \"\"}>\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"ps_n3_optionHeader\">{strings.selected}</div>\n\t\t\t\t\t\t\t\t\t\t\t\t<div className='field' style={{background:'none'}}>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<label htmlFor='o:fill_color_select'>{strings.selected_fill_color}</label>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div className='ui input'>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Field \tclassName=\"styleEditor_input\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tid='o:fill_color_select'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tname='o:fill_color_select'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcomponent='input'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype='text'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdata-enforce='hex'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonChange={this.inputEnforce}/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div \tonClick={(event) => this.showColorPicker(event, 'o:fill_color_select')}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"ps_n3_inputColorSwatch\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdata-initialcolor={this.props.initialValues['o:fill_color_select']}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdata-fieldname='o:fill_color_select'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle={{backgroundColor:(typeof thisRecord !== 'undefined')?thisRecord['o:fill_color_select']:'#0000FF'}}/>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t<div className='field' style={{background:'none'}}>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<label htmlFor='o:stroke_color_select'>{strings.selected_stroke_color}</label>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"ui input\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Field \tclassName=\"styleEditor_input\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tid='o:stroke_color_select'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tname='o:stroke_color_select'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcomponent='input'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype='text'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdata-enforce='hex'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonChange={this.inputEnforce}/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div \tonClick={(event) => this.showColorPicker(event, 'o:stroke_color_select')}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"ps_n3_inputColorSwatch\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdata-initialcolor={this.props.initialValues['o:stroke_color_select']}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdata-fieldname='o:stroke_color_select'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle={{backgroundColor:(typeof thisRecord !== 'undefined')?thisRecord['o:stroke_color_select']:'#0000FF'}}/>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<label htmlFor='o:stroke_opacity_select'>{strings.selected_stroke_opacity}</label>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Slider value={this.state.sliderValues['o:stroke_opacity_select']}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tmin={0.1} max={1.0} step={0.01}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\torientation=\"horizontal\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonChangeStart={() => this.slider_changeStart('o:stroke_opacity_select')}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonChange={this.slider_change}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonChangeComplete={this.slider_changeComplete}/>\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Field \tid='o:stroke_opacity_select'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tname='o:stroke_opacity_select'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcomponent='input'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype='hidden'/>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<label htmlFor='o:fill_opacity_select'>{strings.selected_fill_opacity}</label>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Slider value={this.state.sliderValues['o:fill_opacity_select']}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tmin={0.1} max={1.0} step={0.01}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\torientation=\"horizontal\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonChangeStart={() => this.slider_changeStart('o:fill_opacity_select')}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonChange={this.slider_change}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonChangeComplete={this.slider_changeComplete}/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Field \tid='o:fill_opacity_select'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tname='o:fill_opacity_select'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcomponent='input'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype='hidden'/>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"ps_n3_optionHeader\">{strings.dimensions}</div>\n\t\t\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t\t\t<label htmlFor='o:stroke_width'>{strings.stroke_width}</label>\n\t\t\t\t\t\t\t\t\t\t\t\t<Slider value={this.state.sliderValues['o:stroke_width']}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tmin={0} max={20} step={0.01}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\torientation=\"horizontal\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tonChangeStart={() => this.slider_changeStart('o:stroke_width')}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tonChange={this.slider_change}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tonChangeComplete={this.slider_changeComplete}/>\n\t\t\t\t\t\t\t\t\t\t\t\t<Field \tid='o:stroke_width'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tname='o:stroke_width'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcomponent='hidden'/>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t<div className='field'>\n\t\t\t\t\t\t\t\t\t\t\t\t<label htmlFor='o:point_radius'>{strings.point_radius}</label>\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"ui input\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Field \tclassName=\"styleEditor_input\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tid='o:point_radius'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tname='o:point_radius'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcomponent='input'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype='number'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdata-enforce='float'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tonChange={this.inputEnforce}/>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t<div className='field'>\n\t\t\t\t\t\t\t\t\t\t\t\t<label htmlFor='o:zindex'>{strings.z_index}</label>\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"ui input\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Field \tclassName=\"styleEditor_input\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tid='o:zindex'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tname='o:zindex'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcomponent='input'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype='number'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdata-enforce='float'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tonChange={this.inputEnforce}/>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t<div className='field'>\n\t\t\t\t\t\t\t\t\t\t\t\t<label htmlFor='o:weight'>{strings.order_weight}</label>\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"ui input\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Field \tclassName=\"styleEditor_input\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tid='o:weight'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tname='o:weight'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcomponent='input'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype='number'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdata-enforce='float'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tonChange={this.inputEnforce}/>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"ps_n3_optionHeader\">{strings.dates}</div>\n\t\t\t\t\t\t\t\t\t\t\t<div className='field'>\n\t\t\t\t\t\t\t\t\t\t\t\t<DatePicker fieldName='o:start_date'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue={(typeof thisRecord !== 'undefined')? thisRecord['o:start_date']: ''}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tlabel={strings.start_date}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tformatDate={formatDate}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tparseDate={parseDate}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonDayChange={this.markUnsaved}/>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t<div className='field'>\n\t\t\t\t\t\t\t\t\t\t\t\t<DatePicker fieldName='o:end_date'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue={(typeof thisRecord !== 'undefined')? thisRecord['o:end_date']: ''}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tlabel={strings.end_date}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tformatDate={formatDate}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tparseDate={parseDate}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonDayChange={this.markUnsaved}/>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t<div className='field'>\n\t\t\t\t\t\t\t\t\t\t\t\t<DatePicker fieldName='o:after_date' value={(typeof thisRecord !== 'undefined')? thisRecord['o:after_date']: ''}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tlabel={strings.after_date}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tformatDate={formatDate}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tparseDate={parseDate}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonDayChange={this.markUnsaved}/>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t<div className='field'>\n\t\t\t\t\t\t\t\t\t\t\t\t<DatePicker fieldName='o:before_date'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue={(typeof thisRecord !== 'undefined')? thisRecord['o:before_date']: ''}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tlabel={strings.before_date}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tformatDate={formatDate}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tparseDate={parseDate}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonDayChange={this.markUnsaved}/>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"ps_n3_optionHeader\">{strings.imagery}</div>\n\t\t\t\t\t\t\t\t\t\t\t<div className='field'>\n\t\t\t\t\t\t\t\t\t\t\t\t<label htmlFor='o:point_image'>{strings.point_image}</label>\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"ui input\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Field \tclassName=\"styleEditor_input\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tid='o:point_image'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tname='o:point_image'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcomponent='input'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype='text'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tonChange={this.markUnsaved}/>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t<div className='field'>\n\t\t\t\t\t\t\t\t\t\t\t\t<label htmlFor='o:wms_address'>{strings.wms_address}</label>\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"ui input\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Field \tclassName=\"styleEditor_input\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tid='o:wms_address'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tname='o:wms_address'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcomponent='input'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype='text'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tonChange={this.markUnsaved}/>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t<div className='field'>\n\t\t\t\t\t\t\t\t\t\t\t\t<label htmlFor='o:wms_layers'>{strings.wms_layers}</label>\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"ui input\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Field \tclassName=\"styleEditor_input\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tid='o:wms_layers'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tname='o:wms_layers'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcomponent='input'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype='text'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tonChange={this.markUnsaved}/>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t{/*\n\t\t\t\t\t\t\t\t\t\t\t\tZoom/Visibility disabled for alpha\n\t\t\t\t\t\t\t\t\t\t\t\tIssue: https://github.com/performant-software/neatline-3/issues/30\n\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"ps_n3_optionHeader\">{strings.visibility}</div>\n\t\t\t\t\t\t\t\t\t\t\t\t<div className='field'>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<label htmlFor='o:min_zoom'>{strings.min_zoom}</label>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"ui input\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Field className=\"styleEditor_input\" id='o:min_zoom' name='o:min_zoom' component='input' type='number' onChange={this.markUnsaved}/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t<div className='field'>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<label htmlFor='o:max_zoom'>{strings.max_zoom}</label>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"ui input\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Field className=\"styleEditor_input\" id='o:max_zoom' name='o:max_zoom' component='input' type='number' onChange={this.markUnsaved}/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t<div className='field'>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<label htmlFor='o:map_zoom'>{strings.default_zoom}</label>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"ui input\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Field className=\"styleEditor_input\" id='o:map_zoom' name='o:map_zoom' component='input' type='number' onChange={this.markUnsaved}/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t<div className='field'>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<label htmlFor='o:map_focus'>{strings.default_focus}</label>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"ui input\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Field className=\"styleEditor_input\" id='o:map_focus' name='o:map_focus' component='input' type='text' onChange={this.markUnsaved}/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t*/}\n\t\t\t\t\t\t\t\t\t\t</fieldset>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</TabPanel>\n\t\t\t\t\t</div>\n\n\t\t\t\t</Tabs>\n\t\t\t\t<Field className=\"styleEditor_input\" name='o:coverage' component='input' type='hidden'/>\n\t\t\t\t<Field className=\"styleEditor_input\" name='o:is_coverage' component='input' type='hidden'/>\n\t\t\t\t<Field className=\"styleEditor_input\" name='o:exhibit_id' component='input' type='hidden'/>\n\n\t\t\t</form>)\n\t\t}else{\n\t\t\treturn(<div>{thisRecord['o:body']}</div>);\n\t\t}\n\t}\n\n\t// FIXME: Factor out ColorPicker\n\t_colorPickerListener = (event) => {\n\t\tlet targetElement = event.target;\n\t\tlet el = document.getElementById('colorPickerComponent');\n\t\t// Walk the DOM\n\t\tdo {\n\t\t\t// This is a click inside. Do nothing, just return.\n\t\t\tif (targetElement === el) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\ttargetElement = targetElement.parentNode;\n\t\t} while (targetElement);\n\n\t\t// this. is a click outside.\n\t\tif (this.state.colorPickerVisible) {\n\t\t\tthis.hideColorPicker(event);\n\t\t};\n\t}\n\n\tcolorPickerEventHandler = (enable) => {\n\t\tif (enable) {\n\t\t\tdocument.addEventListener(\"click\", this._colorPickerListener);\n\t\t} else {\n\t\t\tdocument.removeEventListener(\"click\", this._colorPickerListener);\n\t\t}\n\t}\n\n\tshowColorPicker = (event, propertyToColor) => {\n\t\tlet parentEl = document.getElementById(\"scrollArea_stylePropertyPicker\");\n\t\tlet top = (event.target.offsetTop - parentEl.scrollTop);\n\t\ttop +=8;\n\t\tthis.setState({colorPickerCurrentColor: event.target.dataset.initialcolor, colorPickerCurrentField: event.target.dataset.fieldname, colorPickerCurrentlyEditing: propertyToColor, colorPickerVisible: true, colorPickerTop: `${top}px`});\n\n\t\tthis.colorPickerEventHandler(true);\n\t}\n\n\thideColorPicker = (event) => {\n\t\tthis.setState({colorPickerVisible: false});\n\t\tthis.colorPickerEventHandler(false);\n\n\t\t// Update the form\n\t\tthis.props.dispatch(this.change(this.props.form, this.state.colorPickerCurrentField, this.state.colorPickerCurrentColor));\n\t}\n\n\thandleColorChange = (color, event) => {\n\n\t\tlet property = this.state.colorPickerCurrentlyEditing;\n\t\tlet value = color.hex;\n\n\t\tthis.setState({colorPickerCurrentColor: value, [property]: value});\n\n\t\tif (typeof property === 'undefined') {\n\t\t\tdebugger\n\t\t\tconsole.error('Cannot update cache with undefined prop!:' + value);\n\t\t} else {\n\t\t\tthis.props.updateRecordCache({\n\t\t\t\tsetValues: {\n\t\t\t\t\t'o:id': this.props.initialValues['o:id'],\n\t\t\t\t\t[property]: value\n\t\t\t\t}\n\t\t\t});\n\t\t\tthis.markUnsaved();\n\t\t}\n\n\t}\n\n\t// FIXME: Factor out Slider\n\tslider_changeStart = (fieldName) => {\n\t\t// Register the name of the field we're adjusting\n\t\tthis.slider.fieldName = fieldName;\n\t}\n\n\tslider_change = (value) => {\n\t\tif (this.slider.fieldName.length > 0) {\n\t\t\t// Hold the changed value\n\t\t\tthis.slider.value = value.toFixed(2);\n\n\t\t\t// Set the state (updates the UI)\n\t\t\tlet updatedSliderValues = {\n\t\t\t\t...this.state.sliderValues,\n\t\t\t\t[this.slider.fieldName]: parseFloat(this.slider.value)\n\t\t\t}\n\t\t\tthis.setState({sliderValues: updatedSliderValues});\n\n\t\t\t// Fake a blur event to update the value (updates the map)\n\t\t\tthis.markUnsaved({\n\t\t\t\ttarget: {\n\t\t\t\t\tvalue: this.slider.value,\n\t\t\t\t\tname: this.slider.fieldName\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tslider_changeComplete = (event) => {\n\t\t// Change the hidden form field\n\t\tthis.props.dispatch(this.change(this.props.form, this.slider.fieldName, this.slider.value));\n\n\t\t// Flag the map needs saving\n\t\tthis.markUnsaved({\n\t\t\ttarget: {\n\t\t\t\tvalue: this.slider.value,\n\t\t\t\tname: this.slider.fieldName\n\t\t\t}\n\t\t});\n\n\t\tthis.slider = {\n\t\t\tfieldName: '',\n\t\t\tvalue: ''\n\t\t}\n\t}\n\n\t// FIXME: Factor out inputenforcer (NOTE: should probably remove)\n\tinputEnforce = (event) => {\n\t\tlet enforcementType = event.target.dataset.enforce;\n\t\tlet currentVal = event.target.value;\n\t\tlet currentField = event.target.name;\n\t\tlet forcedValue = null;\n\t\tswitch (enforcementType) {\n\n\t\t\tcase 'float':\n\t\t\t\tif (/[^.\\d]/.test(currentVal)) {\n\t\t\t\t\tforcedValue = parseFloat(currentVal);\n\t\t\t\t\tforcedValue = isNaN(forcedValue)\n\t\t\t\t\t\t? \"\"\n\t\t\t\t\t\t: forcedValue.toString();\n\t\t\t\t};\n\t\t\t\tbreak;\n\n\t\t\tcase 'normal':\n\t\t\t\tif (/[^.\\d]/.test(currentVal)) {\n\t\t\t\t\tforcedValue = parseFloat(currentVal);\n\t\t\t\t} else {\n\t\t\t\t\tforcedValue = currentVal;\n\t\t\t\t}\n\t\t\t\tforcedValue = (forcedValue > 1)\n\t\t\t\t\t? 1\n\t\t\t\t\t: forcedValue;\n\t\t\t\tforcedValue = (forcedValue < 0)\n\t\t\t\t\t? 0\n\t\t\t\t\t: forcedValue;\n\t\t\t\tforcedValue = isNaN(forcedValue)\n\t\t\t\t\t? \"\"\n\t\t\t\t\t: forcedValue.toString();\n\t\t\t\tbreak;\n\n\t\t\tcase 'hex':\n\t\t\t\t// If the input is 7 chars or over, or if it is at least 1 but doesn't start with #\n\t\t\t\tif ((currentVal.length >= 7) || (currentVal.length > 0 && (currentVal.substring(0, 1) !== '#'))) {\n\n\t\t\t\t\t// Check to see if it's a valid hex\n\t\t\t\t\tif (!/^#+([a-fA-F0-9]{6}|[a-fA-F0-9]{3})$/.test(currentVal)) {\n\t\t\t\t\t\t// Fixme... this detects but does not handle bad hex that matches\n\t\t\t\t\t\t// the format. For example #00X0000 is invalid but passes through\n\t\t\t\t\t\tif (currentVal.substring(0, 1) !== '#') {\n\t\t\t\t\t\t\tforcedValue = \"#\" + currentVal.substring(0, 6);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tforcedValue = currentVal.substring(0, 7);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tconsole.log(\"RecordForm inputEnforce: I don't know how to enforce: \" + enforcementType);\n\t\t}\n\t\tif (forcedValue !== null) {\n\t\t\t// FIXME: time delay workaround because this doesn't get dispatched until next click\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.props.dispatch(this.change(this.props.form, currentField, forcedValue));\n\t\t\t}, 100);\n\t\t}\n\t\tthis.markUnsaved();\n\t}\n\n}\n\nRecordForm = reduxForm({ form: 'record', enableReinitialize: true})(RecordForm);\nconst mapStateToProps = state => ({\n\trecord: state.record,\n\tuserSignedIn: state.user.userSignedIn,\n\tmapCache: state.mapCache,\n\tselectedRecord: state.exhibitShow.selectedRecord,\n\tinitialValues: state.exhibitShow.editorRecord\n\t\t? state.exhibitShow.editorRecord\n\t\t: {\n\t\t\t...defaultValues,\n\t\t\t'o:exhibit': {\n\t\t\t\t'o:id': state.exhibitShow.exhibit['o:id']\n\t\t\t}\n\t\t}\n});\n\nconst mapDispatchToProps = dispatch => bindActionCreators({\n  setUnsavedChanges,\n  updateRecordCache,\n  removeRecordFromCache\n}, dispatch);\n\nexport default connect(mapStateToProps, mapDispatchToProps)(RecordForm);\n","import React, {Component} from 'react';\nimport RecordForm from '../../components/RecordForm';\nimport {bindActionCreators} from 'redux';\nimport {connect} from 'react-redux';\nimport {createRecord, selectRecord} from '../../actions';\nimport {strings} from '../../i18nLibrary';\nimport { Breadcrumb } from 'semantic-ui-react';\n\n\nclass RecordCreate extends Component {\n\n\trender() {\n\t\treturn (\n\t\t\t<div>\n\t\t\t\t<Breadcrumb>\n\t\t\t\t\t<Breadcrumb.Section onClick={() => { this.props.setShowRecords(true); this.props.setRecordEditorType(''); this.props.deselect() }}>Records</Breadcrumb.Section>\n\t\t\t\t\t<Breadcrumb.Divider icon='right angle' />\n\t\t\t\t\t<Breadcrumb.Section active>New Record</Breadcrumb.Section>\n\t\t\t\t</Breadcrumb>\n\t\t\t\t<RecordForm onSubmit={this.props.submit}\n\t\t\t\t\tsubmitLabel={strings.create}\n\t\t\t\t\tdisabled={this.props.record.loading}\n\t\t\t\t/>\n\t\t\t\t<p>{this.props.record.error}</p>\n\t\t\t</div>\n\t\t)\n\t}\n}\n\nconst mapStateToProps = state => ({record: state.record});\n\nconst mapDispatchToProps = dispatch => bindActionCreators({\n\tsubmit: createRecord,\n\tselectRecord,\n}, dispatch);\n\nexport default connect(mapStateToProps, mapDispatchToProps,)(RecordCreate);\n","import React, {Component} from 'react';\nimport RecordForm from '../../components/RecordForm';\nimport {bindActionCreators} from 'redux';\nimport {connect} from 'react-redux';\nimport {updateRecord, deleteRecord} from '../../actions';\nimport {strings} from '../../i18nLibrary';\nimport { Breadcrumb } from 'semantic-ui-react';\n\nclass RecordUpdate extends Component {\n\trender() {\n\t\tconst {record, submit, loading, deleteRecord, deselect, setShowRecords, setRecordEditorType} = this.props;\n\t\tif (record) {\n\t\t\treturn (\n\t\t\t<div>\n\t\t\t\t<Breadcrumb>\n\t\t\t\t\t<Breadcrumb.Section onClick={() => { setShowRecords(true); setRecordEditorType(''); deselect(); }}>Records</Breadcrumb.Section>\n\t\t\t\t\t<Breadcrumb.Divider icon='right angle' />\n\t\t\t\t\t<Breadcrumb.Section active>{record['o:title']}</Breadcrumb.Section>\n\t\t\t\t</Breadcrumb>\n\t\t\t\t\t<RecordForm onSubmit={submit} submitLabel={strings.save_record} disabled={loading} showDelete={true} handleDelete={() => {deleteRecord(record); setShowRecords(true); setRecordEditorType('')}}/>\n\t\t\t\t<p>{record.error}</p>\n\t\t\t</div>);\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t}\n}\n\nconst mapStateToProps = state => ({\n  record: state.exhibitShow.editorRecord,\n  exhibit: state.exhibitShow.exhibit,\n});\n\nconst mapDispatchToProps = dispatch => bindActionCreators({\n\tsubmit: updateRecord,\n\tdeleteRecord\n}, dispatch);\n\nexport default connect(mapStateToProps, mapDispatchToProps)(RecordUpdate);\n","import React, {Component} from 'react';\n\n\nclass LockOverlay extends Component {\n\trender() {\n\t\treturn (\n\t\t\t<div id=\"lockOverlay_container\" className={this.props.isVisible?\"lockOverlay_container\":\"lockOverlay_container hidden\"}>\n\t\t\t\t<div className={this.props.error?\"hidden\":\"lockOverlay\"}>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t);\n\t}\n}\n\nexport default LockOverlay;\n","import React, {Component} from 'react';\n\n\nclass SpinnerOverlay extends Component {\n\trender() {\n\t\treturn (\n\t\t\t<div id=\"spinner_container\" className={this.props.isVisible?\"spinner_container\":\"spinner_container hidden\"}>\n\t\t\t\t<div className={this.props.error?\"hidden\":\"spinner\"}>\n\t\t\t\t\t<div className=\"bounce1\"></div>\n\t\t\t\t\t<div className=\"bounce2\"></div>\n\t\t\t\t\t<div className=\"bounce3\"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default SpinnerOverlay;\n","import React from 'react';\nimport {Icon} from 'semantic-ui-react';\n\nclass AlertBar extends React.Component {\n\trender() {\n\t\treturn (\n\t\t\t<div className={this.props.isVisible?\"ps_n3_mapStatus_warning\": \"ps_n3_mapStatus_warning ps_n3_hidden\"}>\n\t\t\t\t<Icon name=\"warning circle\" />\n\t\t\t\t{this.props.message}\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default (AlertBar);\n","import 'react-tabs/style/react-tabs.css';\nimport React, {Component} from 'react';\nimport {bindActionCreators} from 'redux';\nimport {connect} from 'react-redux';\nimport {Link} from 'react-router-dom';\nimport {fetchExhibits, setTabIndex, deselectRecord,fetchRecordsBySlug,updateRecordCache} from '../../actions';\nimport ExhibitUpdate from './update';\nimport ExhibitPublicMap from '../../components/ExhibitPublicMap';\nimport Timeline from '../../components/Timeline';\nimport NarrativePanel from '../../components/NeatlineText/NarrativePanel';\nimport RecordInfoPanel from '../../components/info';\nimport Records from '../records';\nimport RecordCreate from '../records/create';\nimport RecordUpdate from '../records/update';\n// import { strings } from '../../i18nLibrary';\nimport {recordCacheToDatabase, updateExhibitCache, clearRecordCache, setShowExhibitSettings, setShowRecords, setRecordEditorType} from '../../actions';\nimport LockOverlay from '../../components/LockOverlay';\nimport SpinnerOverlay from '../../components/SpinnerOverlay';\nimport AlertBar from '../../components/AlertBar';\nimport { Grid, Menu, Button, Icon, Card } from 'semantic-ui-react';\n\nconst ExhibitShowHeader = props => (\n\t<div>\n\t\t{props.userSignedIn &&\n\t\t\t<div className=\"ps_n3_button save\" onClick={props.onSave}>Save</div>}\n\t\t<h3><Link to={`${window.baseRoute}/`}>Neatline</Link> | {props.children}</h3>\n\t</div>\n);\n\nconst ExhibitPanelContent = props => {\n\tif (props.userSignedIn) {\n\t\treturn <ExhibitUpdate exhibit={props.exhibit}/>;\n\t} else {\n\t\treturn <p>{props.exhibit['o:narrative']}</p>;\n\t}\n}\n\n\nclass ExhibitShow extends Component {\n\tconstructor(props) {\n\t\tsuper(props)\n\t\tconst viewMode = this.props.userSignedIn ? 'editing' : 'signedOut'\n\t\tthis.state = {\n\t\t\trecords: this.props.filteredRecords,\n\t\t\tviewMode: viewMode\n\t\t}\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.props.fetchExhibits();\n\t\tthis.cacheIntitialized=false;\n\t\tthis.exhibitCacheInitialized=false;\n\t\tthis.props.dispatch(clearRecordCache());\n\n\t}\n\n\tsaveAll = (event) => {\n\t\tthis.props.dispatch(recordCacheToDatabase());\n\t}\n\n\tcomponentDidUpdate = (prevProps) =>{\n\t\tif(\ttypeof this.props.filteredRecords === 'undefined' &&\n\t\t\ttypeof this.props.match.params.slug !== 'undefined' &&\n\t\t\t!this.props.recordsLoading){\n\t\t\t\tthis.props.fetchRecordsBySlug(this.props.match.params.slug);\n\t\t\t}\n\t\tif (this.props.filteredRecords !== prevProps.filteredRecords){\n\t\t\tthis.setState({records: this.props.filteredRecords});\n\t\t\tthis.props.dispatch(this.props.updateRecordCache(this.props.filteredRecords));\n\t\t}\n\t}\n\n\tshowRecords = () => {\n\t\treturn (this.props.showRecords ?\n\t\t\t\t\t<Records exhibitShowURL={this.props.match.url}\n\t\t\t\t\t\tuserSignedIn={this.props.userSignedIn}\n\t\t\t\t\t\tsetShowRecords={this.props.setShowRecords}\n\t\t\t\t\t\tsetRecordEditorType={this.props.setRecordEditorType}\n\t\t\t\t\t\tviewMode={this.state.viewMode} /> :\n\t\t\t\t\t(this.props.recordEditorType === 'new' ? <RecordCreate setShowRecords={this.props.setShowRecords} deselect={this.props.deselectRecord} setRecordEditorType={this.props.setRecordEditorType} /> : <RecordUpdate setShowRecords={this.props.setShowRecords} deselect={this.props.deselectRecord} setRecordEditorType={this.props.setRecordEditorType}/>\n\t\t\t\t)\n\t\t);\n\t}\n\n\tshowExhibitPanel = () => {\n\t\t// Should only show panel if signed in or out/ not for public viewing of exhibit\n\t\treturn (\n\t\t\t\tthis.props.showExhibitSettings ?\n\t\t\t\t\t<ExhibitPanelContent\n\t\t\t\t\t\texhibit={this.props.exhibit}\n\t\t\t\t\t\tuserSignedIn={this.props.userSignedIn} />\n\t\t\t\t\t:\n\t\t\t\t\tthis.showRecords()\n\t\t)\n\t}\n\n\tsetViewExhibitEditing = () => {\n\t\tthis.setState({viewingExhibitEdit: !this.state.viewingExhibitEdit})\n\t}\n\n\tsetViewMode = (val) => this.setState({viewMode: val})\n\n\n\trender() {\n\t\tconst props = this.props;\n\t\tconst {exhibit} = props;\n\n\t\tconst showFullViewLink = window.containerFullMode === false && window.containerFullModeBaseRoute;\n\t\tconst showReturnLink = !showFullViewLink && window.containerFullMode === true && window.containerReturnBaseRoute;\n\n\t\tlet exhibitDisplay;\n\t\tif (exhibit) {\n\t\t\texhibitDisplay = (\n\t\t\t\t<div>\n\t\t\t\t<Menu stackable>\n\t\t\t\t\t<Menu.Item header as={Link} to={`${window.baseRoute}/`}>\n\t\t\t\t\t\t<span className=\"neatline-subhead\">Neatline</span>\n\t\t\t\t\t</Menu.Item>\n\t\t\t\t\t<Menu.Item>\n\t\t\t\t\t\t<h1 className=\"neatline-title\">{exhibit['o:title']}</h1>\n\t\t\t\t\t</Menu.Item>\n\t\t\t\t\t<Menu.Item>\n\t\t\t\t\t\t{showFullViewLink &&\n\t\t\t\t\t\t<a title=\"Fullscreen Editor\" href={`${window.containerFullModeBaseRoute}/show/${exhibit['o:slug']}`} aria-label=\"Fullscreen Editor\"><Icon name='external alternate' size='large'/></a>\n\t\t\t\t\t\t}\n\t\t\t\t\t\t{showReturnLink &&\n\t\t\t\t\t\t<a title=\"Return to Omeka Admin\" href={`${window.containerReturnBaseRoute}/show/${exhibit['o:slug']}`} aria-label=\"Return to Omeka Admin\"><Icon name='compress' size='large'/></a>\n\t\t\t\t\t\t}\n\t\t\t\t\t</Menu.Item>\n\t\t\t\t\t<Menu.Item position='right'>\n\t\t\t\t\t\t{this.props.userSignedIn ?\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<Button icon toggle basic\n\t\t\t\t\t\t\t\tcolor={this.props.showExhibitSettings ? 'blue' : null}\n\t\t\t\t\t\t\t\tactive={this.props.showExhibitSettings}\n\t\t\t\t\t\t\t\tonClick={()=>{\n\t\t\t\t\t\t\t\t\tthis.props.setShowExhibitSettings(true);\n\t\t\t\t\t\t\t\t\tthis.setViewMode('editing');\n\t\t\t\t\t\t\t\t\tthis.props.setShowRecords(true);\n\t\t\t\t\t\t\t\t\tthis.props.deselectRecord();\n\t\t\t\t\t\t\t\t\t}}>\n\t\t\t\t\t\t\t\tExhibit Settings <Icon name=\"settings\" />\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t<Button icon toggle basic\n\t\t\t\t\t\t\t\tcolor={(!this.props.showExhibitSettings && this.state.viewMode === 'editing') ? 'blue' : null}\n\t\t\t\t\t\t\t\tactive={!this.props.showExhibitSettings && this.state.viewMode === 'editing'}\n\t\t\t\t\t\t\t\tonClick={() => { this.props.setShowExhibitSettings(false); this.setViewMode('editing')}}>\n\t\t\t\t\t\t\t\tRecords <Icon name=\"list\" />\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t<Button icon toggle basic\n\t\t\t\t\t\t\t\tcolor={this.state.viewMode === 'publicView' ? 'blue' : null}\n\t\t\t\t\t\t\t\tactive={this.state.viewMode === 'publicView'}\n\t\t\t\t\t\t\t\tonClick={() => { this.props.setShowExhibitSettings(false); this.setViewMode('publicView'); this.props.setRecordEditorType(''); this.props.setShowRecords(true); this.props.deselectRecord()}}>\n\t\t\t\t\t\t\t\tPublic View <Icon name=\"eye\" />\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t<Button icon\n\t\t\t\t\t\t\t\tonClick={this.saveAll}>\n\t\t\t\t\t\t\t\tSave <Icon name=\"save\" />\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t</div> \n\t\t\t\t\t\t\t:\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\ticon\n\t\t\t\t\t\t\t\t\ttoggle\n\t\t\t\t\t\t\t\t\tbasic\n\t\t\t\t\t\t\t\t\tcolor={this.props.showExhibitSettings ? 'blue' : null}\n\t\t\t\t\t\t\t\t\tactive={this.props.showExhibitSettings}\n\t\t\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\t\t\tthis.props.setShowExhibitSettings(true);\n\t\t\t\t\t\t\t\t\t\tthis.props.setShowRecords(true);\n\t\t\t\t\t\t\t\t\t\tthis.props.deselectRecord();\n\t\t\t\t\t\t\t\t\t}}>\n\t\t\t\t\t\t\t\t\tExhibit Information <Icon name=\"info\" />\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\ticon\n\t\t\t\t\t\t\t\t\ttoggle\n\t\t\t\t\t\t\t\t\tbasic\n\t\t\t\t\t\t\t\t\tcolor={!this.props.showExhibitSettings ? 'blue' : null}\n\t\t\t\t\t\t\t\t\tactive={!this.props.showExhibitSettings}\n\t\t\t\t\t\t\t\t\tonClick={() => this.props.setShowExhibitSettings(false)}>\n\t\t\t\t\t\t\t\t\tView Exhibit <Icon name=\"list\" />\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t}\n\t\t\t\t\t</Menu.Item>\n\t\t\t\t</Menu>\n\t\t\t\t<Grid stackable>\n\t\t\t\t\t<Grid.Row style={{background : 'none'}}>\n\t\t\t\t\t\t{this.props.userSignedIn ?\n\t\t\t\t\t\t\t(this.props.showExhibitSettings ?\n\t\t\t\t\t\t\t\t<Grid.Column width={5}>\n\t\t\t\t\t\t\t\t\t<ExhibitPanelContent\n\t\t\t\t\t\t\t\t\t\texhibit={this.props.exhibit}\n\t\t\t\t\t\t\t\t\t\tuserSignedIn={this.props.userSignedIn} />\n\t\t\t\t\t\t\t\t</Grid.Column>\n\t\t\t\t\t\t\t\t\t\t:\n\t\t\t\t\t\t\t\t<Grid.Column width={5}>\n\t\t\t\t\t\t\t\t\t{this.showRecords()}\n\t\t\t\t\t\t\t\t</Grid.Column>\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t:\n\t\t\t\t\t\t\t(this.props.showExhibitSettings?\n\t\t\t\t\t\t\t\t<Grid.Column width={15}>\n\t\t\t\t\t\t\t\t\t<Card\n\t\t\t\t\t\t\t\t\t\tfluid\n\t\t\t\t\t\t\t\t\t\tstyle={{height: '80vh'}}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<Card.Content>\n\t\t\t\t\t\t\t\t\t\t\t<Card.Header>{exhibit['o:title']}</Card.Header>\n\t\t\t\t\t\t\t\t\t\t</Card.Content>\n\t\t\t\t\t\t\t\t\t\t<Card.Content>\n\t\t\t\t\t\t\t\t\t\t\t<Card.Description>{exhibit['o:narrative']}</Card.Description>\n\t\t\t\t\t\t\t\t\t\t</Card.Content>\n\t\t\t\t\t\t\t\t\t</Card>\n\t\t\t\t\t\t\t\t</Grid.Column> :\n\t\t\t\t\t\t\t\t<Grid.Column width={5}>\n\t\t\t\t\t\t\t\t\t<Records exhibitShowURL={this.props.match.url}\n\t\t\t\t\t\t\t\t\t\tuserSignedIn={this.props.userSignedIn}\n\t\t\t\t\t\t\t\t\t\tsetShowRecords={this.props.setShowRecords}\n\t\t\t\t\t\t\t\t\t\tsetRecordEditorType={this.props.setRecordEditorType}\n\t\t\t\t\t\t\t\t\t\tviewMode={'signedOut'} />\n\t\t\t\t\t\t\t\t</Grid.Column>\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t}\n              {!(!this.props.userSignedIn && this.props.showExhibitSettings) &&\n  \t\t\t\t\t\t\t<Grid.Column floated='right' width={10}>\n\t\t\t\t\t\t\t\t<div className=\"nl-container\" >\n\t\t\t\t\t\t\t\t\t<div className=\"neatline-exhibit item-map\" style={{marginBottom:\"1rem\", \"position\":\"relative\",height: '500px'}} >\n\t\t\t\t\t\t\t\t\t\t<ExhibitPublicMap\n\t\t\t\t\t\t\t\t\t\tuserSignedIn={this.props.userSignedIn}\n\t\t\t\t\t\t\t\t\t\tmapCache={this.props.mapCache}\n\t\t\t\t\t\t\t\t\t\texhibit={this.props.exhibit}\n\t\t\t\t\t\t\t\t\t\trecords={this.state.records}\n\t\t\t\t\t\t\t\t\t\tselectedRecord={this.props.selectedRecord}\n\t\t\t\t\t\t\t\t\t\tpreviewedRecord={this.props.previewedRecord}\n\t\t\t\t\t\t\t\t\t\teditorRecord={this.props.editorRecord}\n\t\t\t\t\t\t\t\t\t\teditorNewRecord={this.props.editorNewRecord}\n\t\t\t\t\t\t\t\t\t\tleafletState={this.props.leaflet}\n\t\t\t\t\t\t\t\t\t\texhibitShowURL={this.props.match.url}\n\t\t\t\t\t\t\t\t\t\thasWarning={this.props.mapCache.hasUnsavedChanges}\n\t\t\t\t\t\t\t\t\t\tisEditing={this.props.recordEditorType === 'edit' ? true : false}\n\t\t\t\t\t\t\t\t\t\tshowExhibitSettings={this.props.showExhibitSettings}\n\t\t\t\t\t\t\t\t\t\tviewMode={this.state.viewMode}\n\t\t\t\t\t\t\t\t\t\tsetRecordEditorType={this.props.setRecordEditorType}\n\t\t\t\t\t\t\t\t\t\tsetShowRecords={this.props.setShowRecords}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t<RecordInfoPanel isVisible={!this.props.showExhibitSettings && !this.props.leaflet.isEditing} />\n\t\t\t\t\t\t\t\t\t<Timeline />\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div className=\"item-narrative\" style={{marginBottom:\"1rem\", \"position\":\"relative\"}}>\n\t\t\t\t\t\t\t\t\t<NarrativePanel />\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n  \t\t\t\t\t\t</Grid.Column>\n            }\n\t\t\t\t\t</Grid.Row>\n\t\t\t\t</Grid>\n\t\t\t</div>);\n\n\t\t} else if (props.exhibitsLoading) {\n\t\t\texhibitDisplay = <ExhibitShowHeader userSignedIn={props.userSignedIn}>Loading...</ExhibitShowHeader>;\n\t\t} else if (props.exhibitsErrored) {\n\t\t\texhibitDisplay = <ExhibitShowHeader userSignedIn={props.userSignedIn}>*ERROR*</ExhibitShowHeader>;\n\t\t} else if (props.exhibitNotFound) {\n\t\t\texhibitDisplay = <ExhibitShowHeader userSignedIn={props.userSignedIn}>Exhibit with identifier \"{props.match.params.slug}\" not found</ExhibitShowHeader>;\n\t\t}\n\t\treturn (\n\t\t\t<div className=\"ps_n3_exhibitShowContainer\" style={{width:'100%',position:'relative'}}>\n\t\t\t\t<AlertBar isVisible={this.props.mapCache.hasUnsavedChanges} message=\"You have unsaved changes\"/>\n\t\t\t\t<SpinnerOverlay isVisible={this.props.leaflet.isSaving || this.props.recordsLoading}/>\n\t\t\t\t<LockOverlay isVisible={this.props.leaflet.isEditing}/>\n\t\t\t\t\t  {exhibitDisplay}\n\t\t\t</div>);\n\t}\n}\n\nconst mapStateToProps = state => ({\n\tuserSignedIn: state.user.userSignedIn,\n\texhibit: state.exhibitShow.exhibit,\n\texhibits: state.exhibits,\n\tleaflet: state.leaflet,\n\tfilteredRecords: state.exhibitShow.filteredRecords,\n\trecordsLoading: state.exhibitShow.loading,\n\trecordsErrored: state.exhibitShow.errored,\n\texhibitNotFound: state.exhibitShow.exhibitNotFound,\n\tselectedRecord: state.exhibitShow.selectedRecord,\n\teditorRecord: state.exhibitShow.editorRecord,\n\teditorNewRecord: state.exhibitShow.editorNewRecord,\n\ttabIndex: state.exhibitShow.tabIndex,\n\tmapCache: state.mapCache,\n\texhibitCache: state.exhibitCache,\n\trecordEditorType: state.exhibitShow.recordEditorType,\n\tshowExhibitSettings: state.exhibitShow.showExhibitSettings,\n\tshowRecords: state.exhibitShow.showRecords,\n});\n\nconst mapDispatchToProps = dispatch => bindActionCreators({\n\tfetchExhibits,\n\tsetTabIndex,\n\tdeselectRecord,\n\tfetchRecordsBySlug,\n\tupdateRecordCache,\n\tupdateExhibitCache,\n\tsetRecordEditorType,\n\tsetShowExhibitSettings,\n\tsetShowRecords,\n\tdispatch\n}, dispatch);\n\nexport default connect(\n\tmapStateToProps,\n\tmapDispatchToProps\n)(ExhibitShow);\n","import React, {Component} from 'react';\nimport {Link} from 'react-router-dom';\nimport ExhibitForm from '../../components/ExhibitForm';\nimport {createExhibit} from '../../actions';\nimport {bindActionCreators} from 'redux';\nimport {connect} from 'react-redux';\nimport {strings} from '../../i18nLibrary';\nimport { Menu, Icon, Breadcrumb, Button } from 'semantic-ui-react'\n\n\nclass ExhibitCreate extends Component {\n\tcomponentWillMount() {\n\t\tthis.props.location.pathname.includes('add') ? this.setState({open: true}) : this.setState({open:false})\n\t}\n\trender() {\n\t\tconst changeLanguage = lng => {\n\t\t\tstrings.setLanguage(lng);\n\t\t\tthis.setState({});\n\t\t}\n\t\tconst allLanguages = strings.getAvailableLanguages();\n\t\tconst lngButtons = allLanguages.map((lng) =>\n\t\t\t<Button key={lng} onClick={() => changeLanguage(lng)}>{lng}</Button>\n\t\t);\n\t\tconst showFullViewLink = window.containerFullMode === false && window.containerFullModeBaseRoute;\n\t\tconst showReturnLink = !showFullViewLink && window.containerFullMode === true && window.containerReturnBaseRoute;\n\n\t\tconst props = this.props;\n\t\treturn (\n\t\t\t<div>\n\t\t\t\t<Menu stackable>\n\t\t\t\t\t<Menu.Item header as={Link} to={`${window.baseRoute}/`}>\n\t\t\t\t\t\t<span className=\"neatline-subhead\">Neatline</span>\n\t\t\t\t\t</Menu.Item>\n\t\t\t\t\t<Menu.Item>\n\t\t\t\t\t\t<h1 className=\"neatline-title\">{strings.createExhibit}</h1>\n\t\t\t\t\t</Menu.Item>\n\t\t\t\t\t{showReturnLink &&\n\t\t\t\t\t<Menu.Item>\n\t\t\t\t\t\t<a title=\"Return to Omeka Admin\" href={`${window.containerReturnBaseRoute}/add`} aria-label=\"Return to Omeka Admin\"><Icon name='compress' size='large'/></a>\n\t\t\t\t\t</Menu.Item>\n\t\t\t\t\t}\n\t\t\t\t\t{/* {showFullViewLink &&\n\t\t\t\t\t<Menu.Item>\n\t\t\t\t\t\t<a title=\"Fullscreen Editor\" href={`${window.containerFullModeBaseRoute}`} aria-label=\"Fullscreen Editor\"><Icon name='external alternate' size='large'/></a>\n\t\t\t\t\t</Menu.Item>\n\t\t\t\t\t} */}\n\t\t\t\t\t<Menu.Item position='right'><div>\n\t\t\t\t\t\t{lngButtons}\n\t\t\t\t\t</div></Menu.Item>\n\t\t\t\t</Menu>\n\t\t\t\t<Breadcrumb>\n\t\t\t\t\t<Breadcrumb.Section href={`${window.baseRoute}/`}>Neatline</Breadcrumb.Section>\n\t\t\t\t\t<Breadcrumb.Divider icon='right angle' />\n\t\t\t\t\t<Breadcrumb.Section active>New Exhibit</Breadcrumb.Section>\n\t\t\t\t</Breadcrumb>\n\t\t\t\t<ExhibitForm onSubmit={props.submit}\n\t\t\t\t\tsubmitLabel={strings.create_exhibit}\n\t\t\t\t\tdisabled={props.loading} \n\t\t\t\t\tfullscreen={true}\n\t\t\t\t/>\n\t\t\t\t{props.errored && <p>{strings.create_exhibit_error}</p>}\n\t\t\t</div>\n\t\t);\n\t}\n};\n\n\n\nconst mapStateToProps = state => ({\n\tloading: state.exhibits.exhibit.loading,\n\terrored: state.exhibits.exhibit.errored}\n);\n\nconst mapDispatchToProps = dispatch =>\nbindActionCreators({\n\tsubmit: createExhibit\n}, dispatch);\n\nexport default connect(mapStateToProps, mapDispatchToProps)(ExhibitCreate);\n","import React from 'react';\nimport Exhibits from '../exhibits';\nimport ExhibitShow from '../exhibits/show';\nimport ExhibitCreate from '../exhibits/create';\nimport {Router, Route, Switch} from 'react-router-dom';\nimport history from '../../history';\n\nconst App = () => (\n\t<main className=\"neatline\">\n\t<Router history={history}>\n\t\t<Switch>\n\t\t\t<Route exact path={`${window.baseRoute}/`} component={Exhibits}/>\n\t\t\t<Route path={`${window.baseRoute}/add`} component={ExhibitCreate}/>\n\t\t\t<Route path={`${window.baseRoute}/show/:slug`} component={ExhibitShow}/>\n\t\t</Switch>\n\t</Router>\n\t</main>\n);\nexport default App;\n","import React from 'react';\nimport {render} from 'react-dom';\nimport {Provider} from 'react-redux';\nimport store from './store';\nimport App from './views/app';\nimport './main.css';\n// import 'semantic-ui-css/semantic.min.css';\n\nconst target = document.getElementById('root');\nrender(\n\t<Provider store={store}>\n\t\t<App/>\n\t</Provider>,\ntarget);\n"],"sourceRoot":""}