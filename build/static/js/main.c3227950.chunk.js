(this.webpackJsonpneatline=this.webpackJsonpneatline||[]).push([[0],{441:function(e,t,a){e.exports=a(781)},670:function(e,t,a){},671:function(e,t,a){},780:function(e,t,a){},781:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),i=a(103),o=a(30),l=a(15),s=a(361),c=a(387),d=a(357),u={userSignedIn:null!==window.jwt&&"null"!==window.jwt&&void 0!==window.jwt},p=a(6),m={loading:!1,errored:!1},h="exhibitShow/EXHIBIT_LOADED",b="exhibitShow/RECORD_SELECTED",_="exhibitShow/RECORD_DESELECTED",E="exhibitShow/RECORD_ADDED",f="recordCreate/RECORD_CREATE",y="recordDelete/RECORD_DELETE",g="recordUpdate/RECORD_UPDATE",v="exhibitUpdate/EXHIBIT_POST_SUCCESS",w="exhibits/EXHIBITS_LOADING",x={exhibit:null,loading:!1,errored:!1,exhibitNotFound:!1,selectedRecord:null,previewedRecord:null,editorRecord:null,editorNewRecord:!1,tabIndex:0,showExhibitSettings:!0,recordEditorType:"",showRecords:!0},R={exhibits:[],loading:!1,errored:!1,newExhibit:{},exhibit:{changedExhibit:null,loading:!1,errored:!1}},O={cache:{}};var S={changedRecord:null,newRecord:null,loading:!1,error:""},C=a(362),k=new(a.n(C).a)({en:{createExhibit:"Create an Exhibit",browseExhibit:"Browse Exhibits",refreshExhibits:"Refresh Exhibits",exhibit:"Exhibit",title:"Title",full:"Full window view",contained:"Contained view",created:"Created",owner:"Owner",public:"Public",delete:"Delete",exhibit_delete_confirmation:"Are you sure you want to delete the Neatline exhibit? This will delete the exhibit and its associated metadata.",yes:"Yes",no:"No",create_exhibit_error:"Error: failed to create exhibit",update_exhibit_error:"Error: failed to update exhibit",delete_exhibit_error:"Error: exhibit failed to delete",slug:"URL Slug",narrative:"Narrative",accessible_url:"Alternative Accessible URL",default_spatial_layer:"Default Spatial Layer",additional_spatial_layers:"Additional Spatial Layers",image_layer:"Image Layer",zoom_levels:"Zoom Levels",wms_address:"WMS Address",wms_layers:"WMS Layers",spatial_querying:"Spatial Querying",create_exhibit:"Create exhibit",records:"Records",new_record:"New Record",save_record:"Save Record",save_exhibit:"Save Exhibit",text:"Text",style:"Style",text_description:"Text Description",loading:"Loading...",body:"Body",colors:"Colors",fill_color:"Fill Color",stroke_color:"Stroke Color",fill_opacity:"Fill Opacity",stroke_opacity:"Stroke Opacity",selected:"Selected",selected_fill_color:"Selected - Fill Color",selected_stroke_color:"Selected - Stroke Color",selected_stroke_opacity:"Selected - Stroke Opacity",selected_fill_opacity:"Selected - Fill Opacity",dimensions:"Dimensions",stroke_width:"Stroke Width",point_radius:"Point Radius",z_index:"Z-Index",order_weight:"Order/Weight",dates:"Dates",start_date:"Start Date",end_date:"End Date",after_date:"After Date",before_date:"Before Date",imagery:"Imagery",point_image:"Point Image",visibility:"Visibility",min_zoom:"Min Zoom",max_zoom:"Max Zoom",default_zoom:"Default Zoom",default_focus:"Default Focus",create:"Create",unsaved_changes:"You have unsaved changes!",update_record_error:"Error updating record",delete_record_error:"Error deleting record",create_record_error:"Error creating record",record_delete_confirmation:"Are you sure you want to delete the Neatline record?"},es:{createExhibit:"Crear una presentaci\xf3n",browseExhibit:"Ver presentaci\xf3n",refreshExhibits:"Actualizar las presentaciones",exhibit:"Presentaci\xf3n",title:"T\xedtulo",created:"Creado",owner:"Owner",public:"P\xfablico",delete:"Borrar",exhibit_delete_confirmation:"Est\xe1 seguro que quiere borrar la presentaci\xf3n {0}? Esta acci\xf3n va a borrar la presentaci\xf3n y su metadata asociada.",yes:"S\xed",no:"No",create_exhibit_error:"Error: no pudo crear una presentaci\xf3n",update_exhibit_error:"Error: no pudo actualizar la presentaci\xf3n",delete_exhibit_error:"Error: no pudo deletar la presentaci\xf3n",slug:"URL slug",narrative:"Narraci\xf3n",accessible_url:"URL accesible alternativo",default_spatial_layer:"Valor por el defecto para capa espacial",additional_spatial_layers:"Capas espaciales adicionales",image_layer:"Capa del imagen",zoom_levels:"Nivel del zoom",wms_layers:"Capa del WMS",wms_address:"Direcci\xf3n del WMS",spatial_querying:"Pregunta espacial",create_exhibit:"Crear la presentaci\xf3n",records:"Archivos",new_record:"Un archivo nuevo",save_record:"Grabar el archivo",save_exhibit:"Grabar la presentaci\xf3n",text:"Texto",style:"Estilo",text_description:"Descripci\xf3n del texto",loading:"Cargando...",body:"Cuerpo",colors:"Colores",fill_color:"Color llenado",stroke_color:"Color del trazo",fill_opacity:"Opacidad llenada",stroke_opacity:"Opacidad del trazo",selected:"Seleccionado",selected_fill_color:"Color llenado",selected_stroke_color:"Color del trazo",selected_stroke_opacity:"Opacidad llenada",selected_fill_opacity:"Opacidad del trazo",dimensions:"Dimensiones",stroke_width:"Ancho del trazo",point_radius:"Radio del punto",z_index:"indice Z",order_weight:"Orden/peso",dates:"Fechas",start_date:"Fecha del comienzo",end_date:"Fecha del fin",after_date:"Fecha despu\xe9s",before_date:"Fecha antes",imagery:"Imaginer\xeda",point_image:"Imagen del punto",visibility:"Visibilidad",min_zoom:"Zoom m\xednimo",max_zoom:"Zoom m\xe1ximo",default_zoom:"Valor por el defecto para zoom",default_focus:"Valor por el defecto para enfoque",create:"Crear",unsaved_changes:"\xa1Tiene cambios que no est\xe1n grabados!",update_record_error:"Error: no pudo actualizar el archivo",delete_record_error:"Error: no pudo deletar el archivo",create_record_error:"Error: no pudo crear el archivo",record_delete_confirmation:"\xbfEst\xe1 seguro que quiere borrar el archivo {0}?"}}),j=Object.freeze({UNDEFINED:-1,MAP:0,IMAGE:1}),N=Object.freeze({MAP:"MAP",IMAGE:"IMAGE",WMS:"WMS",TILE:"TILE"}),D=Object.freeze({"o:spatial_layer":"0","o:spatial_layers":[],"o:zoom_levels":20,"o:spatial_querying":!0}),I={cache:[],selectedRecordID:null,isEditingWithPreview:!0,hasUnsavedChanges:!1,current:{type:N.MAP,tileLayer:{tile_address:"",slug:"OpenStreetMap",displayName:"Open Street Map",deprecated:!1,attribution:"&amp;copy <a href=&quot;http://osm.org/copyright&quot;>OpenStreetMap</a> contributors",url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"},basemapOptions:[{slug:"OpenStreetMap",displayName:"DEFAULT Open Street Map",deprecated:!1,attribution:"&amp;copy <a href=&quot;http://osm.org/copyright&quot;>OpenStreetMap</a> contributors",url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}]},default:{geometryStyles:{"o:stroke_width":2,"o:stroke_color":"#000000","o:stroke_color_select":"#000000","o:stroke_opacity":1,"o:stroke_opacity_select":1,"o:fill_opacity":.5,"o:fill_color":"#00aeff","o:fill_color_select":"#00aeff"}},available:{baseMaps:[{type:N.MAP,slug:"OpenStreetMap",displayName:"Open Street Map",deprecated:!1,attribution:"&amp;copy <a href=&quot;http://osm.org/copyright&quot;>OpenStreetMap</a> contributors",url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"},{type:N.MAP,slug:"StamenToner",displayName:"Stamen: Toner",deprecated:!1,attribution:'Map tiles by <a href="http://stamen.com">Stamen Design</a>, under <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>. Data by <a href="http://openstreetmap.org">OpenStreetMap</a>, under <a href="http://www.openstreetmap.org/copyright">ODbL</a>.',url:"http://tile.stamen.com/toner/{z}/{x}/{y}.png"},{type:N.MAP,slug:"StamenWatercolor",displayName:"Stamen: Watercolor",deprecated:!1,attribution:'Map tiles by <a href="http://stamen.com">Stamen Design</a>, under <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>. Data by <a href="http://openstreetmap.org">OpenStreetMap</a>, under <a href="http://creativecommons.org/licenses/by-sa/3.0">CC BY SA</a>.',url:"http://tile.stamen.com/watercolor/{z}/{x}/{y}.png"},{type:N.MAP,slug:"StamenTerrain",displayName:"Stamen: Terrain",deprecated:!1,attribution:'Map tiles by <a href="http://stamen.com">Stamen Design</a>, under <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>. Data by <a href="http://openstreetmap.org">OpenStreetMap</a>, under <a href="http://www.openstreetmap.org/copyright">ODbL</a>.',url:"http://tile.stamen.com/terrain/{z}/{x}/{y}.png"},{type:N.MAP,slug:"GooglePhysical",displayName:"Google: Physical",deprecated:!0,attribution:"&amp;copy <a href=&quot;http://osm.org/copyright&quot;>OpenStreetMap</a> contributors",url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"},{type:N.MAP,slug:"GoogleStreets",displayName:"Google: Streets",deprecated:!0,attribution:"&amp;copy <a href=&quot;http://osm.org/copyright&quot;>OpenStreetMap</a> contributors",url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"},{type:N.MAP,slug:"GoogleHybrid",displayName:"Google: Hybrid",deprecated:!0,attribution:"&amp;copy <a href=&quot;http://osm.org/copyright&quot;>OpenStreetMap</a> contributors",url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"},{type:N.MAP,slug:"GoogleSatellite",displayName:"Google: Satellite",deprecated:!0,attribution:"&amp;copy <a href=&quot;http://osm.org/copyright&quot;>OpenStreetMap</a> contributors",url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}]}};var T={isEditing:!1,isSaving:!1},A=Object(l.c)({form:d.a,leaflet:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:T,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LEAFLET_IS_EDITING":return Object(p.a)(Object(p.a)({},e),{},{isEditing:t.payload});case"LEAFLET_IS_SAVING":return Object(p.a)(Object(p.a)({},e),{},{isSaving:t.payload});default:return e}},user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u,t=arguments.length>1?arguments[1]:void 0;return t.type,e},exhibits:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:R,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case w:return Object(p.a)(Object(p.a)({},e),{},{loading:t.loading});case"exhibits/EXHIBITS_ERRORED":return console.log(t),Object(p.a)(Object(p.a)({},e),{},{errored:t.errored});case"exhibits/EXHIBITS_FETCH_SUCCESS":return Object(p.a)(Object(p.a)({},e),{},{exhibits:t.payload});case"exhibitUpdate/EXHIBIT_CREATED":return Object(p.a)(Object(p.a)({},e),{},{loading:!0,changedExhibit:t.exhibit});case v:return Object(p.a)(Object(p.a)({},e),{},{loading:!1,changedExhibit:R.changedExhibit});case"exhibitUpdate/EXHIBIT_POST_ERRORED":return Object(p.a)(Object(p.a)({},e),{},{errored:!0});default:return e}},exhibitShow:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:x,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"exhibitShow/EXHIBIT_LOADING":return Object(p.a)(Object(p.a)({},e),{},{loading:t.loading});case"exhibitShow/EXHIBIT_ERRORED":return Object(p.a)(Object(p.a)({},e),{},{errored:t.errored});case"RECORDS_LOADING":return Object(p.a)(Object(p.a)({},e),{},{loading:t.payload});case"RECORDS_FETCH_SUCCESS":return Object(p.a)(Object(p.a)({},e),{},{records:t.payload,loading:!1});case"RECORDS_FILTER":return Object(p.a)(Object(p.a)({},e),{},{filteredRecords:t.payload});case"exhibitShow/EXHIBIT_RESET":return x;case h:return Object(p.a)(Object(p.a)({},e),{},{exhibit:t.payload,exhibitNotFound:!1});case"exhibitShow/EXHIBIT_NOT_FOUND":return Object(p.a)(Object(p.a)({},e),{},{exhibitNotFound:!0});case"SHOW_RECORDS":return Object(p.a)(Object(p.a)({},e),{},{showRecords:t.payload});case"SHOW_EXHIBIT_SETTINGS":return Object(p.a)(Object(p.a)({},e),{},{showExhibitSettings:t.payload});case"RECORD_EDITOR_TYPE":return Object(p.a)(Object(p.a)({},e),{},{recordEditorType:t.payload});case b:var a=t.payload.record;return"undefined"!==typeof a&&null!==a?Object(p.a)(Object(p.a)({},e),{},{selectedRecord:a,editorRecord:a,editorNewRecord:!1,tabIndex:2}):Object(p.a)({},e);case _:return Object(p.a)(Object(p.a)({},e),{},{editorRecord:null,selectedRecord:null,editorNewRecord:!1,tabIndex:Math.min(e.tabIndex,1)});case"RECORD_PREVIEWED":return Object(p.a)(Object(p.a)({},e),{},{previewedRecord:t.record});case"RECORD_UNPREVIEWED":return Object(p.a)(Object(p.a)({},e),{},{previewedRecord:null});case"exhibitShow/EDITOR_NEW_RECORD":return Object(p.a)(Object(p.a)({},e),{},{editorNewRecord:!0,editorRecord:null,selectedRecord:null,tabIndex:2});case"exhibitShow/EDITOR_CLOSE_NEW_RECORD":return Object(p.a)(Object(p.a)({},e),{},{editorNewRecord:!1,recordEditorType:""});case"exhibitShow/TAB_INDEX":return Object(p.a)(Object(p.a)({},e),{},{tabIndex:t.payload});case E:return Object(p.a)(Object(p.a)({},e),{},{records:e.records.concat(t.record),editorRecord:t.record,selectedRecord:t.record,filteredRecords:e.filteredRecords.concat(t.record)});case"exhibitShow/RECORD_REPLACED":return Object(p.a)(Object(p.a)({},e),{},{records:e.records.filter((function(e){return e["o:id"].toString()!==t.record["o:id"].toString()})).concat(t.record),filteredRecords:e.filteredRecords.filter((function(e){return e["o:id"].toString()!==t.record["o:id"].toString()})).concat(t.record)});case"exhibitShow/RECORD_REMOVED":return Object(p.a)(Object(p.a)({},e),{},{records:e.records.filter((function(e){return e["o:id"].toString()!==t.record["o:id"].toString()})),editorRecord:null,selectedRecord:null,tabIndex:1,filteredRecords:e.filteredRecords.filter((function(e){return e["o:id"].toString()!==t.record["o:id"].toString()}))});case"exhibitShow/RECORD_COVERAGE_SET":if(null!==e.editorRecord){var r=e.editorRecord;return r["o:coverage"]=t.coverage,Object(p.a)(Object(p.a)({},e),{},{editorRecord:r})}return e;default:return e}},exhibitDelete:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"exhibitDelete/EXHIBIT_DELETED":return Object(p.a)(Object(p.a)({},e),{},{loading:!0});case"exhibitDelete/EXHIBIT_DELETE_SUCCESS":return Object(p.a)(Object(p.a)({},e),{},{loading:!1});case"exhibitDelete/EXHIBIT_DELETE_ERRORED":return Object(p.a)(Object(p.a)({},e),{},{errored:!0});default:return e}},record:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:S,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case f:return Object(p.a)(Object(p.a)({},e),{},{loading:!0,newRecord:t.payload});case"CREATE_RECORD_RESPONSE_RECEIVED":return"undefined"!==typeof t.payload.errors?(console.error("CREATE_RECORD_ERROR: ".concat(t.payload.errors.error)),Object(p.a)(Object(p.a)({},e),{},{error:k.create_record_error})):Object(p.a)(Object(p.a)({},e),{},{loading:!1,error:"",newRecord:t.record});case y:return Object(p.a)(Object(p.a)({},e),{},{loading:!0});case"DELETE_RECORD_RESPONSE_RECEIVED":return"undefined"!==typeof t.payload.jsonResponse.errors?(console.error("DELETE_RECORD_ERROR: ".concat(t.payload.jsonResponse.errors.error)),Object(p.a)(Object(p.a)({},e),{},{error:k.delete_record_error})):Object(p.a)(Object(p.a)({},e),{},{loading:!1,error:""});case"UPDATE_RECORD_RESPONSE_RECEIVED":return"undefined"!==typeof t.payload.errors?(console.error("UPDATE_RECORD_ERROR: ".concat(t.payload.errors.error)),Object(p.a)(Object(p.a)({},e),{},{error:k.update_record_error})):Object(p.a)(Object(p.a)({},e),{},{loading:!1,changedRecord:t.payload,error:"",isEditing:!1});case"RECORD_ERROR":return console.error("RECORD_ERROR: ".concat(t.payload.error)),Object(p.a)(Object(p.a)({},e),{},{error:t.payload.message});case"recordCreate/NEW_RECORD_RESET":return S;default:return e}},mapCache:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:I,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"RECORD_CACHE_UPDATE":if("undefined"===typeof t.payload)return;var a=[];Array.isArray(t.payload)?a=t.payload:a.push(t.payload.setValues);var r=a;return a.length>0&&(r=e.cache,a.forEach((function(e){var t=e["o:id"];"undefined"===typeof t&&(t=-1),"undefined"===typeof r[t]&&(r[t]={});for(var a=e,n=Object.keys(a),i=0;i<n.length;i++){var o=n[i],l=a[o];"o:"!==o.substring(0,2)&&"@"!==o.substring(0,1)||(r[t][o]=l)}}))),Object(p.a)(Object(p.a)({},e),{},{cache:r});case"RECORD_CACHE_REMOVE_BY_ID":return delete(r=e.cache)[t.payload],Object(p.a)(Object(p.a)({},e),{},{cache:r});case"RECORD_CACHE_CLEAR_UNSAVED":return delete(r=e.cache)[-1],Object(p.a)(Object(p.a)({},e),{},{cache:r});case"RECORD_CACHE_REMOVE_RECORD":return delete(r=e.cache)[t.payload.recordID],Object(p.a)(Object(p.a)({},e),{},{cache:r});case"RECORD_CACHE_CLEAR":return Object(p.a)(Object(p.a)({},e),{},{cache:[]});case"HAS_UNSAVED_CHANGES":return Object(p.a)(Object(p.a)({},e),{},{hasUnsavedChanges:t.payload.hasUnsavedChanges});case v:return Object(p.a)(Object(p.a)({},e),{},{hasUnsavedChanges:!1});case"PREVIEW_BASELAYER":return Object(p.a)(Object(p.a)({},e),{},{current:Object(p.a)(Object(p.a)(Object(p.a)({},e.current),t.payload),{},{tileLayer:e.available.baseMaps[t.payload.id]})});case"SET_AVAILABLE_TILELAYERS":var n=[];return t.payload.ids.forEach((function(t,a,r){n.push(e.available.baseMaps[t])})),Object(p.a)(Object(p.a)({},e),{},{current:Object(p.a)(Object(p.a)({},e.current),{},{basemapOptions:n})});default:return e}},exhibitCache:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"EXHIBIT_CACHE_UPDATE":for(var a=e.cache,r=t.payload.setValues,n=Object.keys(r),i=0;i<n.length;i++){var o=n[i],l=r[o];"o:"!==o.substring(0,2)&&"@"!==o.substring(0,1)||(a[o]=l)}return Object(p.a)(Object(p.a)({},e),{},{cache:a});default:return e}}}),L=a(28),M=a.n(L),P=a(248),F=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r="/api/";window.jwt&&!t.hasOwnProperty("jwt")&&null!==window.jwt&&"null"!==window.jwt&&(t.jwt=window.jwt);var n=new URLSearchParams(t),i=r+e;a&&(i+="/"+a);var o=n.toString();return o.length>0&&(i+="?"+o),i},V=function(e){"o:owner"in e&&(e["o:owner"]=e["o:owner"]["@id"]),"o:added"in e&&(e["o:added"]=Object(P.format)(e["o:added"]["@value"],"MMM D, YYYY")),"o:coverage"in e&&(e["o:coverage"]=JSON.parse(e["o:coverage"]))},U=a(10),z=a(194),H=Object(z.a)(),B=M.a.mark(ue),G=M.a.mark(pe),X=M.a.mark(me),W=M.a.mark(he),Y=M.a.mark(be),q=M.a.mark(_e),J=M.a.mark(Ee),Z=M.a.mark(fe),K=M.a.mark(ye),Q=M.a.mark(we),$=M.a.mark(xe),ee=M.a.mark(Re),te=M.a.mark(Oe),ae=M.a.mark(Se),re=M.a.mark(Ce),ne=M.a.mark(ke),ie=M.a.mark(je),oe=M.a.mark(Ne),le={Accept:"application/json","Content-Type":"application/json"},se=function(e){return e.exhibits.exhibits},ce=function(e){return e.exhibitCache.cache},de=function(e){return e.mapCache.cache};function ue(){return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(U.a)([Object(U.d)(f,pe),Object(U.d)("CREATE_RECORD_RESPONSE_RECEIVED",be),Object(U.d)(y,_e),Object(U.d)("DELETE_RECORD_RESPONSE_RECEIVED",Ee),Object(U.d)(g,fe),Object(U.d)("UPDATE_RECORD_RESPONSE_RECEIVED",ye),Object(U.d)("EXHIBIT_FETCH",we),Object(U.d)("EXHIBIT_FETCH_RESPONSE_RECEIVED",xe),Object(U.d)("RECORDS_FETCH",Ce),Object(U.d)("RECORDS_FETCH_RESPONSE_RECEIVED",ke),Object(U.d)("RECORD_FETCH_BY_SLUG",Se),Object(U.d)("EXHIBIT_UPDATE",Re),Object(U.d)("EXHIBIT_UPDATE_RESPONSE_RECEIVED",Oe),Object(U.d)(b,me),Object(U.d)(_,he),Object(U.d)("RECORD_CACHE_UPDATE_AND_SAVE",je),Object(U.d)("EXHIBIT_CACHE_SAVE",Ne),Object(U.d)("EVENT_REFRESH_MAP_GEOMETRY",ge),Object(U.d)("EVENT_REFRESH_MAP",ve)]);case 2:case"end":return e.stop()}}),B)}function pe(e){var t,a,r;return M.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,t=F("neatline_records"),n.next=4,fetch(t,{method:"POST",headers:le,body:JSON.stringify(e.payload)});case 4:return a=n.sent,n.next=7,a.json();case 7:return r=n.sent,n.next=10,Object(U.b)({type:"CREATE_RECORD_RESPONSE_RECEIVED",payload:r});case 10:n.next=16;break;case 12:return n.prev=12,n.t0=n.catch(0),n.next=16,Object(U.b)({type:"RECORD_ERROR",payload:{record:"",message:k.create_record_error,error:n.t0}});case 16:case"end":return n.stop()}}),G,null,[[0,12]])}function me(e){var t,a,r;return M.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(U.c)(ce);case 2:t=n.sent,a=t["o:slug"],r="undefined"!==typeof window.baseRoute?"".concat(window.baseRoute):"",r+="/show/".concat(a,"/edit/").concat(e.payload.record["o:id"]),H.replace(r);case 7:case"end":return n.stop()}}),X)}function he(){var e,t,a;return M.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Object(U.c)(ce);case 2:return e=r.sent,t=e["o:slug"],a="undefined"!==typeof window.baseRoute?"".concat(window.baseRoute):"",a+="/show/".concat(t),H.replace(a),r.next=9,Object(U.b)({type:"EVENT_REFRESH_MAP_GEOMETRY"});case 9:case"end":return r.stop()}}),W)}function be(e){return M.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("undefined"!==typeof e.payload.errors){t.next=11;break}return t.next=3,Object(U.b)({type:"RECORD_CACHE_UPDATE",payload:{setValues:{"o:id":e.payload["o:id"],"o:coverage":e.payload["o:coverage"],"o:is_coverage":e.payload["o:is_coverage"],"o:fill_color":"FF00FF"}}});case 3:return t.next=5,Object(U.b)({type:"exhibitShow/EDITOR_CLOSE_NEW_RECORD"});case 5:return t.next=7,Object(U.b)({type:E,record:e.payload});case 7:return t.next=9,Object(U.b)({type:b,payload:{record:e.payload}});case 9:t.next=12;break;case 11:console.log("!! failure response received for createRecord");case 12:case"end":return t.stop()}}),Y)}function _e(e){var t,a,r,n;return M.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(t=e.payload,!window.confirm(k.formatString(k.record_delete_confirmation,t["o:title"]))){i.next=18;break}return i.prev=2,i.next=5,fetch(F("neatline_records",{},t["o:id"]),{method:"DELETE"});case 5:return a=i.sent,i.next=8,a.json();case 8:return r=i.sent,n={jsonResponse:r,record:e.payload},i.next=12,Object(U.b)({type:"DELETE_RECORD_RESPONSE_RECEIVED",payload:n});case 12:i.next=18;break;case 14:return i.prev=14,i.t0=i.catch(2),i.next=18,Object(U.b)({type:"RECORD_ERROR",payload:{record:t,message:k.delete_record_error,error:i.t0}});case 18:case"end":return i.stop()}}),q,null,[[2,14]])}function Ee(e){return M.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("undefined"!==typeof e.payload.jsonResponse.errors){t.next=5;break}return t.next=3,Object(U.b)({type:"exhibitShow/RECORD_REMOVED",record:e.payload.record});case 3:return t.next=5,Object(U.b)({type:"RECORD_CACHE_REMOVE_BY_ID",payload:e.payload.record["o:id"]});case 5:return t.next=7,Object(U.b)({type:_});case 7:case"end":return t.stop()}}),J)}function fe(e){var t,a,r,n;return M.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return t=e.payload,i.prev=1,a=F("neatline_records",{},t["o:id"]),i.next=5,fetch(a,{method:"PATCH",headers:le,body:JSON.stringify(t)});case 5:return r=i.sent,i.next=8,r.json();case 8:return n=i.sent,i.next=11,Object(U.b)({type:"UPDATE_RECORD_RESPONSE_RECEIVED",payload:n});case 11:i.next=17;break;case 13:return i.prev=13,i.t0=i.catch(1),i.next=17,Object(U.b)({type:"RECORD_ERROR",payload:{record:t,message:k.update_record_error,error:i.t0}});case 17:case"end":return i.stop()}}),Z,null,[[1,13]])}function ye(e){return M.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("undefined"!==typeof e.payload.errors){t.next=3;break}return t.next=3,Object(U.b)({type:"exhibitShow/RECORD_REPLACED",record:e.payload});case 3:return t.next=5,Object(U.b)({type:"LEAFLET_IS_EDITING",payload:!1});case 5:case"end":return t.stop()}}),K)}function ge(e){var t=new CustomEvent("refreshMapGeometry");document.dispatchEvent(t)}function ve(e){var t=new CustomEvent("refreshMap");document.dispatchEvent(t)}function we(e){var t,a;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(U.b)({type:w,payload:{loading:!0}});case 3:return t=F("neatline_exhibits"),e.next=6,fetch(t);case 6:return a=e.sent,e.next=9,Object(U.b)({type:"EXHIBIT_FETCH_RESPONSE_RECEIVED",payload:{response:a}});case 9:e.next=18;break;case 11:return e.prev=11,e.t0=e.catch(0),console.log(e.t0),e.next=16,Object(U.b)({type:w,payload:{loading:!1}});case 16:return e.next=18,Object(U.b)({type:"exhibits/EXHIBITS_ERRORED",payload:e.t0});case 18:case"end":return e.stop()}}),Q,null,[[0,11]])}function xe(e){var t;return M.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Object(U.b)({type:w,payload:{loading:!1}});case 2:if(200!==e.payload.response.status){a.next=10;break}return a.next=5,e.payload.response.json().then((function(e){return e.forEach((function(e){"o:owner"in e&&(e["o:owner"]=e["o:owner"]["@id"]),"o:added"in e&&(e["o:added"]=Object(P.format)(e["o:added"]["@value"],"MMM D, YYYY"))})),e}));case 5:return t=a.sent,a.next=8,Object(U.b)({type:"exhibits/EXHIBITS_FETCH_SUCCESS",payload:t});case 8:a.next=12;break;case 10:return a.next=12,Object(U.b)({type:"exhibits/EXHIBITS_ERRORED",payload:e.payload.response});case 12:case"end":return a.stop()}}),$)}function Re(e){var t,a,r;return M.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,t=e.payload,a=F("neatline_exhibits",{},t["o:id"]),n.next=5,fetch(a,{headers:{Accept:"application/json","Content-Type":"application/json"},method:"PATCH",body:JSON.stringify(t)});case 5:return r=n.sent,n.next=8,Object(U.b)({type:"EXHIBIT_UPDATE_RESPONSE_RECEIVED",payload:{response:r,exhibit:t}});case 8:n.next=14;break;case 10:return n.prev=10,n.t0=n.catch(0),n.next=14,Object(U.b)({type:"RECORD_ERROR",payload:{error:n.t0}});case 14:case"end":return n.stop()}}),ee,null,[[0,10]])}function Oe(e){var t;return M.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(t=e.payload.exhibit,"undefined"!==typeof e.payload.errors){a.next=10;break}return a.next=4,Object(U.b)({type:v});case 4:return a.next=6,Object(U.b)({type:h,payload:t});case 6:return a.next=8,Object(U.b)({type:"EXHIBIT_FETCH"});case 8:a.next=13;break;case 10:return a.next=12,Object(U.b)({type:"exhibitUpdate/EXHIBIT_POST_ERRORED"});case 12:throw Error(e.payload.response.statusText);case 13:case"end":return a.stop()}}),te)}function Se(e){var t,a,r,n;return M.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return t=e.payload,i.next=3,Object(U.c)(se);case 3:if(!((a=i.sent)&&a.length>0)){i.next=26;break}return r=a.filter((function(e){return e["o:slug"]===t}))[0],i.next=8,Object(U.b)({type:"RECORDS_LOADING",payload:!0});case 8:return i.next=10,Object(U.b)({type:h,payload:r});case 10:return i.next=12,Object(U.b)({type:"EXHIBIT_CACHE_UPDATE",payload:{setValues:r}});case 12:return i.next=14,Object(U.b)({type:"RECORDS_FETCH",payload:r});case 14:n="MAP",i.t0=r["o:exhibit_type"],i.next=1===i.t0?18:2===i.t0?20:3===i.t0?22:24;break;case 18:return n="IMAGE",i.abrupt("break",24);case 20:return n="WMS",i.abrupt("break",24);case 22:return n="TILE",i.abrupt("break",24);case 24:return i.next=26,Object(U.b)({type:"PREVIEW_BASELAYER",payload:{id:r["o:exhibit_type"],image_address:r["o:image_layer"],image_attribution:r["o:image_attribution"],image_layer:r["o:image_layer"],tile_address:r["o:tile_address"],tile_attribution:r["o:tile_attribution"],type:n,wms_address:r["o:wms_address"],wms_attribution:r["o:wms_attribution"],wms_layers:r["o:wms_layers"]}});case 26:case"end":return i.stop()}}),ae)}function Ce(e){var t,a;return M.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Object(U.b)({type:"RECORDS_LOADING",payload:!0});case 2:return r.prev=2,t=F("neatline_records",{exhibit_id:e.payload["o:id"]}),r.next=6,fetch(t);case 6:return a=r.sent,r.next=9,Object(U.b)({type:"RECORDS_FETCH_RESPONSE_RECEIVED",payload:{response:a}});case 9:r.next=15;break;case 11:return r.prev=11,r.t0=r.catch(2),r.next=15,Object(U.b)({type:"RECORD_ERROR",payload:{message:"error",error:r.t0}});case 15:case"end":return r.stop()}}),re,null,[[2,11]])}function ke(e){var t;return M.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if("undefined"!==typeof e.payload.errors){a.next=12;break}return a.next=3,e.payload.response.json().then((function(e){return e.forEach(V),e}));case 3:return t=a.sent,a.next=6,Object(U.b)({type:"RECORD_CACHE_UPDATE",payload:t});case 6:return a.next=8,Object(U.b)({type:"RECORDS_FETCH_SUCCESS",payload:t});case 8:return a.next=10,Object(U.b)({type:"RECORDS_FILTER",payload:t});case 10:a.next=15;break;case 12:return a.next=14,Object(U.b)({type:"RECORD_ERROR"});case 14:throw Error(e.payload.response.statusText);case 15:case"end":return a.stop()}}),ne)}function je(e){return M.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(U.b)({type:"RECORD_CACHE_UPDATE",payload:e.payload});case 2:return t.next=4,Object(U.b)({type:"EXHIBIT_CACHE_SAVE",payload:e.payload});case 4:return t.next=6,Object(U.b)({type:"EVENT_REFRESH_MAP_GEOMETRY"});case 6:case"end":return t.stop()}}),ie)}function Ne(e){var t,a,r,n,i,o,l;return M.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,Object(U.b)({type:"LEAFLET_IS_SAVING",payload:!0});case 2:return s.next=4,Object(U.c)(ce);case 4:return t=s.sent,s.next=7,Object(U.c)(de);case 7:if(a=s.sent,r=e.payload.selectedRecord,n=!1,"undefined"===typeof a[-1]){s.next=16;break}if(n=!0,"undefined"===(i=a[-1])["o:exhibit"]){s.next=16;break}return s.next=16,Object(U.b)({type:f,payload:i});case 16:return s.next=18,Object(U.b)({type:"RECORD_CACHE_CLEAR_UNSAVED"});case 18:o=0;case 19:if(!(o<a.length)){s.next=27;break}if("undefined"===typeof(l=a[o])){s.next=24;break}return s.next=24,Object(U.b)({type:g,payload:l});case 24:o++,s.next=19;break;case 27:if("undefined"===typeof t){s.next=30;break}return s.next=30,Object(U.b)({type:"EXHIBIT_UPDATE",payload:t});case 30:if("undefined"===typeof r||null===r||n){s.next=35;break}return s.next=33,Object(U.b)({type:_});case 33:return s.next=35,Object(U.b)({type:b,payload:{record:r}});case 35:return s.next=37,Object(U.b)({type:"RECORDS_FETCH",payload:t});case 37:return s.next=39,Object(U.b)({type:"LEAFLET_IS_SAVING",payload:!1});case 39:case"end":return s.stop()}}),oe)}var De=[s.a],Ie=Object(c.a)(),Te=l.d.apply(void 0,[l.a.apply(void 0,De),Object(l.a)(Ie)].concat([])),Ae=Object(l.e)(A,{},Te);Ie.run(ue);var Le=Ae,Me=a(24),Pe=a(25),Fe=a(27),Ve=a(26),Ue=a(789),ze=a(782),He=a(388),Be=a(91);function Ge(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return{type:e,payload:t}}var Xe=function(e){return Ge("SET_AVAILABLE_TILELAYERS",e)},We=function(e){return Ge(f,e)},Ye=function(e){return Ge(g,e)},qe=function(e){return Ge(y,e)},Je=function(e){return Ge("HAS_UNSAVED_CHANGES",e)},Ze=function(e){return Ge("RECORD_CACHE_UPDATE",e)},Ke=function(e){return Ge("RECORD_CACHE_UPDATE_AND_SAVE",e)},Qe=function(e){return Ge("EXHIBIT_CACHE_UPDATE",e)},$e=function(e){return Ge("RECORD_CACHE_REMOVE_RECORD",e)},et=function(e){return Ge("LEAFLET_IS_EDITING",e)},tt=function(e){return Ge("LEAFLET_IS_SAVING",e)},at=function(){return Ge("EXHIBIT_FETCH")},rt=function(){return Ge("exhibitShow/EXHIBIT_RESET")},nt=function(){return Ge("RECORD_UNPREVIEWED")},it=function(e){return Ge("exhibitShow/TAB_INDEX",e)},ot=function(e){return Ge(b,e)},lt=function(e){return Ge(_,e)},st=function(e){return Ge("RECORD_FETCH_BY_SLUG",e)},ct=function(e){return Ge("RECORDS_FILTER",e)},dt=function(e){return Ge("SHOW_RECORDS",e)},ut=function(e){return Ge("SHOW_EXHIBIT_SETTINGS",e)},pt=function(e){return Ge("RECORD_EDITOR_TYPE",e)},mt=function(e){return function(t){window.confirm(k.formatString(k.exhibit_delete_confirmation,e["o:title"]))&&(t({type:"exhibitDelete/EXHIBIT_DELETED",exhibit:e}),fetch(F("neatline_exhibits",{},e["o:id"]),{method:"DELETE"}).then((function(e){if(!e.ok)throw Error(e.statusText)})).then((function(){return t({type:"exhibitDelete/EXHIBIT_DELETE_SUCCESS"})})).then((function(){return t(at())})).catch((function(){return t({type:"exhibitDelete/EXHIBIT_DELETE_ERRORED"})})))}},ht=function(e){return function(t){t({type:"exhibitCreate/EXHIBIT_CREATED",exhibit:e}),fetch(F("neatline_exhibits"),{headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",body:JSON.stringify(e)}).then((function(e){if(!e.ok)throw Error(e.statusText)})).then((function(){return t({type:"exhibitCreate/EXHIBIT_POST_SUCCESS"})})).then((function(){return H.push("".concat(window.baseRoute,"/"))})).catch((function(){return t({type:"exhibitCreate/EXHIBIT_POST_ERRORED"})}))}},bt=a(364),_t=a.n(bt),Et=function(e){Object(Fe.a)(a,e);var t=Object(Ve.a)(a);function a(){var e;Object(Me.a)(this,a);for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(e=t.call.apply(t,[this].concat(n))).createExhibitView=function(){H.push("".concat(window.baseRoute,"/add"))},e.handleSort=function(t){return function(){var a=e.state,r=a.column,n=a.direction;r===t?e.setState({exhibits:e.props.exhibits.reverse(),direction:"ascending"===n?"descending":"ascending"}):e.setState({column:t,exhibits:e.props.exhibits.sort((function(e,a){return"o:title"===t||"o:owner"===t?e[t].toUpperCase().localeCompare(a[t].toUpperCase()):"o:added"===t?new Date(e[t])-new Date(a[t]):"o:public"===t?e[t]===a[t]?0:e[t]?-1:1:new Date(e["o:added"])-new Date(a["o:added"])})),direction:"ascending"})}},e}return Object(Pe.a)(a,[{key:"componentWillMount",value:function(){this.props.dispatch(at()),this.props.dispatch(rt()),this.setState({column:null,direction:null})}},{key:"render",value:function(){var e=this,t=this.props,a=this.state,r=k.getAvailableLanguages().map((function(t){return n.a.createElement(ze.a,{key:t,onClick:function(){return function(t){k.setLanguage(t),e.setState({})}(t)}},t)})),i=!1===window.containerFullMode&&window.containerFullModeBaseRoute,o=!i&&!0===window.containerFullMode&&window.containerReturnBaseRoute;return n.a.createElement("div",null,n.a.createElement(He.a,{stackable:!0},n.a.createElement(He.a.Item,{header:!0,as:Ue.a,to:"".concat(window.baseRoute,"/")},n.a.createElement("span",{className:"neatline-subhead"},"Neatline")),n.a.createElement(He.a.Item,null,n.a.createElement("h1",{className:"neatline-title"},k.browseExhibit)),o&&n.a.createElement(He.a.Item,null,n.a.createElement("a",{title:"Return to Omeka Admin",href:"".concat(window.containerReturnBaseRoute),"aria-label":"Return to Omeka Admin"},n.a.createElement(Be.a,{name:"compress",size:"large"}))),n.a.createElement(He.a.Item,{position:"right"},n.a.createElement("div",null,t.userSignedIn&&n.a.createElement(ze.a,{icon:!0,onClick:this.createExhibitView},k.createExhibit,n.a.createElement(Be.a,{name:"plus"})),r))),n.a.createElement("table",{className:"tablesaw neatline tablesaw-stack"},n.a.createElement("thead",null,n.a.createElement("tr",null,n.a.createElement("th",{className:"o:title"===a.column?a.direction:null,onClick:this.handleSort("o:title")},k.title," "),n.a.createElement("th",{className:"o:added"===a.column?a.direction:null,onClick:this.handleSort("o:added")},k.created," "),n.a.createElement("th",{className:"o:public"===a.column?a.direction:null,onClick:this.handleSort("o:public")},k.public," "),n.a.createElement("th",{className:"o:owner"===a.column?a.direction:null,onClick:this.handleSort("o:owner")},k.owner," "))),n.a.createElement("tbody",null,_t.a.map(t.exhibits,(function(e,a){return n.a.createElement("tr",{key:a},n.a.createElement("td",null,n.a.createElement("b",{className:"tablesaw-cell-label"},k.title),n.a.createElement("span",{className:"tablesaw-cell-content"},n.a.createElement(Ue.a,{className:"ps_n3_exhibitTitle",to:"".concat(window.baseRoute,"/show/").concat(e["o:slug"])},e["o:title"]),n.a.createElement("ul",{className:"actions neatline"},i&&n.a.createElement("li",null,n.a.createElement("a",{title:"Fullscreen Editor",href:"".concat(window.containerFullModeBaseRoute,"/show/").concat(e["o:slug"]),"aria-label":"Fullscreen Editor"},n.a.createElement(Be.a,{name:"external alternate"}))),n.a.createElement("li",null,n.a.createElement("a",{title:"Edit",href:"".concat(window.baseRoute,"/show/").concat(e["o:slug"]),"aria-label":"Edit"},n.a.createElement(Be.a,{name:"pencil alternate"}))),t.userSignedIn&&n.a.createElement("li",null,n.a.createElement("a",{onClick:function(){t.deleteExhibit(e)},disabled:t.deleteInProgress},n.a.createElement(Be.a,{name:"trash alternate"})))))),n.a.createElement("td",null,n.a.createElement("b",{className:"tablesaw-cell-label"},k.created),n.a.createElement("span",{className:"tablesaw-cell-content"},e["o:added"])),n.a.createElement("td",null,n.a.createElement("b",{className:"tablesaw-cell-label"},k.public),n.a.createElement("span",{className:"tablesaw-cell-content"},e["o:public"]?k.yes:k.no)),n.a.createElement("td",null,n.a.createElement("b",{className:"tablesaw-cell-label"},k.owner),n.a.createElement("span",{className:"tablesaw-cell-content"},e["o:owner"])))})))),t.deleteErrored&&n.a.createElement("p",null,k.delete_exhibit_error))}}]),a}(r.Component),ft=Object(o.b)((function(e){return{userSignedIn:e.user.userSignedIn,exhibits:e.exhibits.exhibits,exhibitsLoading:e.exhibits.loading,exhibitsErrored:e.exhibits.errored,deleteInProgress:e.exhibitDelete.loading,deleteErrored:e.exhibitDelete.errored}}),(function(e){return Object(l.b)({fetchExhibits:at,resetExhibit:rt,deleteExhibit:mt,dispatch:e},e)}))(Et),yt=(a(655),a(57)),gt=a(356),vt=a(355),wt=a(358),xt=a(53),Rt=a(791),Ot=function(e){Object(Fe.a)(a,e);var t=Object(Ve.a)(a);function a(e){var r;return Object(Me.a)(this,a),(r=t.call(this,e)).onSpatialLayerInfoChange=function(e){var t={spatial_layer:"o:spatial_layer"===e.target.name?e.target.value:St(r.props.state,"o:spatial_layer"),wms_address:"o:wms_address"===e.target.name?e.target.value:St(r.props.state,"o:wms_address"),wms_layers:"o:wms_layers"===e.target.name?e.target.value:St(r.props.state,"o:wms_layers"),wms_attribution:"o:wms_attribution"===e.target.name?e.target.value:St(r.props.state,"o:wms_attribution"),image_address:"o:image_layer"===e.target.name?e.target.value:St(r.props.state,"o:image_layer"),image_attribution:"o:image_attribution"===e.target.name?e.target.value:St(r.props.state,"o:image_attribution"),tile_address:"o:tile_address"===e.target.name?e.target.value:St(r.props.state,"o:tile_address"),tile_attribution:"o:tile_attribution"===e.target.name?e.target.value:St(r.props.state,"o:tile_attribution")};"o:image_layer"!==e.target.name&&"o:image_attribution"!==e.target.name||(t.spatial_layer=N.IMAGE),r.updateLayerPreview(t),r.markUnsaved(e,{name:e.target.name,value:e.target.value})},r.updateLayerPreview=function(e){var t=e.spatial_layer;isNaN(e.spatial_layer)||(t=N.MAP),r.setState({baseLayerType:t}),r.props.dispatch(function(e){return Ge("PREVIEW_BASELAYER",e)}({type:t,id:e.spatial_layer,wms_address:e.wms_address,wms_layers:e.wms_layers,wms_attribution:e.wms_attribution,image_layer:e.image_layer,image_address:e.image_address,image_attribution:e.image_attribution,tile_address:e.tile_address,tile_attribution:e.tile_attribution}))},r.enabledSpatialLayerPreview=function(e,t){r.props.dispatch(r.set_availableTileLayers({ids:t})),r.markUnsaved(e,{name:"o:spatial_layers",value:t})},r.exhibitTypeSwitch=function(e){"image"===e.target.name?(r.setState({baseLayerType:N.IMAGE,exhibitType:j.IMAGE}),r.onSpatialLayerInfoChange({target:{name:"o:spatial_layer",value:N.IMAGE}}),r.props.change("o:exhibit_type",j.IMAGE)):(r.setState({baseLayerType:N.MAP,exhibitType:j.MAP}),r.onSpatialLayerInfoChange({target:{name:"o:spatial_layer",value:0}}),r.props.change("o:exhibit_type",j.MAP))},r.markUnsaved=function(e){"undefined"!==typeof e?r.props.dispatch(Qe({setValues:Object(yt.a)({},e.target.name,e.target.value)})):console.log("Skipping cache update"),r.props.dispatch(Je({hasUnsavedChanges:!0}))},r.layerTYPE=function(){var e=[],t=r.props.mapCache.available.baseMaps;return Object.keys(t).forEach((function(a){var r=t[a];r.deprecated||e.push(r)})),e},r.buildLayerTypeOptions=function(){var e=[],t=r.layerTYPE();return Object.keys(t).forEach((function(a){var r=t[a],i="layerTypeOption-".concat(a);e.push(n.a.createElement("option",{value:a,key:i},r.displayName))})),e},r.set_availableTileLayers=Xe,r.exhibit=e.exhibit,r.handleSubmit=e.handleSubmit,r.submitLabel=e.submitLabel,r.disabled=e.disabled,r.layerTypeOptions=r.buildLayerTypeOptions(),r.currentSlug="",r.state={exhibitType:j.MAP,baseLayerType:N.MAP,isNewExhibit:!0},r}return Object(Pe.a)(a,[{key:"componentDidMount",value:function(){var e="undefined"===typeof this.props.initialValues["o:exhibit_type"],t="undefined"===typeof this.props.initialValues["o:exhibit_type"]?j.MAP:this.props.initialValues["o:exhibit_type"];this.props.change("o:exhibit_type",t),this.updateLayerPreview({exhibit_type:this.props.initialValues["o:exhibit_type"],spatial_layer:t===j.MAP?this.props.initialValues["o:spatial_layer"]:N.IMAGE,wms_address:this.props.initialValues["o:wms_address"],wms_layers:this.props.initialValues["o:wms_layers"],wms_attribution:this.props.initialValues["o:wms_attribution"],image_layer:this.props.initialValues["o:image_layer"],image_address:this.props.initialValues["o:image_layer"],image_attribution:this.props.initialValues["o:image_attribution"],tile_address:this.props.initialValues["o:tile_address"],tile_attribution:this.props.initialValues["o:tile_attribution"]}),this.setState({exhibitType:t,isNewExhibit:e}),this.setState({currentSlug:this.props.initialValues["o:slug"]}),this.props.dispatch(Je({hasUnsavedChanges:!1}))}},{key:"componentWillReceiveProps",value:function(e){if("undefined"!==typeof e.exhibit){var t=e.exhibit["o:slug"];this.currentSlug!==t&&t.length>0&&(this.setState({currentSlug:t}),H.push(window.baseRoute+"/show/"+t),this.currentSlug=t)}}},{key:"render",value:function(){return n.a.createElement("div",{className:"ps_n3_exhibitFormContainer"},n.a.createElement(Rt.a,{onSubmit:this.handleSubmit},n.a.createElement("fieldset",{disabled:this.disabled},n.a.createElement("legend",null,this.state.isNewExhibit?n.a.createElement("h2",null,"New Exhibit"):n.a.createElement("h4",null,"Exhibit Settings")),n.a.createElement("div",{className:"field"},n.a.createElement("label",{htmlFor:"o:title"},"Title"),n.a.createElement("div",{className:"ui input"},n.a.createElement(gt.a,{id:"o:title",name:"o:title",component:"input",type:"text",placeholder:"Enter exhibit title",onChange:this.markUnsaved}))),n.a.createElement("div",{className:"field"},n.a.createElement("label",{htmlFor:"o:slug"},"URL Slug"),n.a.createElement("div",{className:"ui input"},n.a.createElement(gt.a,{id:"o:slug",name:"o:slug",component:"input",type:"text",placeholder:"Enter url slug",onChange:this.markUnsaved}))),n.a.createElement("div",{className:"field"},n.a.createElement("label",{htmlFor:"o:narrative"},"Narrative"),n.a.createElement("div",{className:"ui input"},n.a.createElement(gt.a,{id:"o:narrative",name:"o:narrative",component:"textarea",placeholder:"Enter exhibit narrative",onChange:this.markUnsaved}))),n.a.createElement("div",{className:"field"},n.a.createElement("label",{htmlFor:"o:accessible_url"},"Alternative Accessible URL"),n.a.createElement("div",{className:"ui input"},n.a.createElement(gt.a,{id:"o:accessible_url",name:"o:accessible_url",component:"input",type:"text",placeholder:"Enter alternative url",onChange:this.markUnsaved}))),this.state.isNewExhibit?n.a.createElement("div",null,n.a.createElement("div",{className:"field"},n.a.createElement("label",{htmlFor:"o:public"},"Public"),n.a.createElement("div",{className:"ui checkbox toggle ps_n3_checkbox"},n.a.createElement(gt.a,{id:"o:public",name:"o:public",component:"input",type:"checkbox"}),n.a.createElement("label",null,"Check here to publish exhibit to the public site."))),n.a.createElement("div",{className:"grouped fields"},n.a.createElement("label",null,n.a.createElement("h3",null,"Select Map Type")),n.a.createElement("div",{className:"field"},n.a.createElement("div",{className:"ui radio checkbox"},n.a.createElement(gt.a,{id:"map-radio",name:"map",type:"radio",component:"input",checked:this.state.exhibitType===j.MAP,onChange:this.exhibitTypeSwitch,value:0}),n.a.createElement("label",{htmlFor:"map-radio"},"Map"))),n.a.createElement("div",{className:"field"},n.a.createElement("div",{className:"ui radio checkbox"},n.a.createElement(gt.a,{id:"image-radio",name:"image",type:"radio",component:"input",checked:this.state.exhibitType===j.IMAGE,onChange:this.exhibitTypeSwitch,value:1}),n.a.createElement("label",{htmlFor:"image-radio"},"Image"))))):null,this.state.exhibitType===j.MAP&&n.a.createElement("div",{className:"field"},n.a.createElement("label",{htmlFor:"o:spatial_layer"},"Base Layer"),n.a.createElement(gt.a,{id:"o:spatial_layer",name:"o:spatial_layer",component:"select",onChange:this.onSpatialLayerInfoChange},n.a.createElement("optgroup",{label:"Default Layers"},this.layerTypeOptions,n.a.createElement("option",{value:N.TILE},"Custom: Tile Layer"),n.a.createElement("option",{value:N.WMS},"Custom: WMS Layer")))),this.state.exhibitType===j.IMAGE&&n.a.createElement("div",null,n.a.createElement("div",null,n.a.createElement("div",{className:"field"},n.a.createElement("label",{htmlFor:"o:image_layer"},"Image URL"),n.a.createElement(gt.a,{id:"o:image_layer",name:"o:image_layer",component:"input",type:"text",onChange:this.onSpatialLayerInfoChange})),n.a.createElement("div",{className:"field"},n.a.createElement("label",{htmlFor:"o:image_attribution"},"Attribution"),n.a.createElement(gt.a,{id:"o:image_attribution",name:"o:image_attribution",component:"input",type:"text",onChange:this.onSpatialLayerInfoChange})))),this.state.baseLayerType===N.TILE&&n.a.createElement("div",{className:"ps_n3_sub_options"},n.a.createElement("div",{className:"field"},n.a.createElement("label",{htmlFor:"o:tile_address"},"Tile URL"),n.a.createElement(gt.a,{id:"o:tile_address",name:"o:tile_address",component:"input",type:"text",onChange:this.onSpatialLayerInfoChange})),n.a.createElement("div",{className:"field"},n.a.createElement("label",{htmlFor:"o:tile_attribution"},"Attribution"),n.a.createElement(gt.a,{id:"o:tile_attribution",name:"o:tile_attribution",component:"input",type:"text",onChange:this.onSpatialLayerInfoChange}))),this.state.baseLayerType===N.WMS&&n.a.createElement("div",{className:"ps_n3_sub_options"},n.a.createElement("div",{className:"field"},n.a.createElement("label",{htmlFor:"o:wms_address"},"WMS URL"),n.a.createElement(gt.a,{id:"o:wms_address",name:"o:wms_address",component:"input",type:"text",onChange:this.onSpatialLayerInfoChange})),n.a.createElement("div",{className:"field"},n.a.createElement("label",{htmlFor:"o:wms_layers"},"WMS Layers"),n.a.createElement(gt.a,{id:"o:wms_layers",name:"o:wms_layers",component:"input",type:"text",onChange:this.onSpatialLayerInfoChange})),n.a.createElement("div",{className:"field"},n.a.createElement("label",{htmlFor:"o:wms_attribution"},"Attribution"),n.a.createElement(gt.a,{id:"o:wms_attribution",name:"o:wms_attribution",component:"input",type:"text",onChange:this.onSpatialLayerInfoChange}))),this.state.exhibitType===j.MAP&&n.a.createElement("div",null,n.a.createElement("div",{className:"field"},n.a.createElement("label",{htmlFor:"o:spatial_layers"},"Additional Layers"),n.a.createElement(gt.a,{id:"o:spatial_layers",name:"o:spatial_layers",component:"select",multiple:"multiple",onChange:this.enabledSpatialLayerPreview},this.layerTypeOptions)),n.a.createElement("div",{className:"field"},n.a.createElement("label",{htmlFor:"o:zoom_levels"},"Zoom Levels"),n.a.createElement(gt.a,{id:"o:zoom_levels",name:"o:zoom_levels",component:"input",type:"number",onChange:this.markUnsaved}))),n.a.createElement("div",{className:"ps_n3_checkboxPair"},n.a.createElement(gt.a,{id:"o:spatial_querying",name:"o:spatial_querying",component:"input",type:"hidden",onChange:this.markUnsaved})),this.exhibit&&this.exhibit["o:id"]&&n.a.createElement(gt.a,{name:"o:id",component:"input",type:"hidden"}),n.a.createElement(gt.a,{name:"o:exhibit_type",component:"input",type:"hidden"})),this.state.isNewExhibit&&n.a.createElement(ze.a,{type:"submit"},"Create Exhibit")))}}]),a}(r.Component);Ot=Object(vt.a)({form:"exhibit",enableReinitialize:!0})(Ot);var St=Object(wt.a)("exhibit"),Ct=Object(o.b)((function(e){return{state:e,mapCache:e.mapCache,initialValues:e.exhibitShow.exhibit?e.exhibitShow.exhibit:D}}),(function(e){return Object(l.b)({change:xt.a,dispatch:e},e)}))(Ot),kt={"o:track_height":16},jt=function(e){Object(Fe.a)(a,e);var t=Object(Ve.a)(a);function a(e){var r;return Object(Me.a)(this,a),(r=t.call(this,e)).markUnsaved=function(e){"undefined"!==typeof e?r.props.dispatch(Qe({setValues:Object(yt.a)({},e.target.name,e.target.value)})):console.log("Skipping cache update"),r.props.dispatch(Je({hasUnsavedChanges:!0}))},r.exhibit=e.exhibit,r.handleSubmit=e.handleSubmit,r.submitLabel=e.submitLabel,r.disabled=e.disabled,r}return Object(Pe.a)(a,[{key:"render",value:function(){return n.a.createElement("div",{className:"ps_n3_exhibitFormContainer"},n.a.createElement(Rt.a,{onSubmit:this.handleSubmit},n.a.createElement("fieldset",{disabled:this.disabled},n.a.createElement("legend",null,n.a.createElement("h4",null,"Timeline Settings")),n.a.createElement("div",{className:"field"},n.a.createElement("label",{htmlFor:"o:timeline_toggle"},"Show Timeline"),n.a.createElement("div",{className:"ui checkbox"},n.a.createElement(gt.a,{id:"o:timeline_toggle",name:"o:timeline_toggle",component:"input",type:"checkbox",onChange:this.markUnsaved}))),n.a.createElement("div",{className:"field"},n.a.createElement("label",{htmlFor:"o:track_height"},"Track Height"),n.a.createElement(gt.a,{className:"styleEditor_input",id:"o:track_height",name:"o:track_height",component:"input",type:"number","data-enforce":"float",onChange:this.markUnsaved})))))}}]),a}(r.Component);jt=Object(vt.a)({form:"exhibit",enableReinitialize:!0})(jt);Object(wt.a)("exhibit");var Nt=Object(o.b)((function(e){return{state:e,mapCache:e.mapCache,initialValues:e.exhibitShow.exhibit?e.exhibitShow.exhibit:Object(p.a)({},kt)}}),(function(e){return Object(l.b)({change:xt.a,dispatch:e},e)}))(jt),Dt=a(109),It=a(380),Tt=a.n(It),At=function(e){Object(Fe.a)(a,e);var t=Object(Ve.a)(a);function a(e){var r;return Object(Me.a)(this,a),(r=t.call(this,e)).exhibit=e.exhibit,r.handleSubmit=e.handleSubmit,r.submitLabel=e.submitLabel,r.disabled=e.disabled,r.state={data:e.initialValues["o:narrative"]},r.onEditorChange=r.onEditorChange.bind(Object(Dt.a)(r)),r}return Object(Pe.a)(a,[{key:"onEditorChange",value:function(e){this.setState({data:e.editor.getData()})}},{key:"renderEditor",value:function(e){var t=e.input;return n.a.createElement(Tt.a,{data:t.value,onChange:function(e){return console.log(e.editor.getData())}})}},{key:"render",value:function(){return console.log(this.state.data),n.a.createElement("div",{className:"ps_n3_exhibitFormContainer"},n.a.createElement(Rt.a,{onSubmit:this.handleSubmit},n.a.createElement("fieldset",{disabled:this.disabled},n.a.createElement("legend",null,n.a.createElement("h4",null,"NeatlineText Settings")),n.a.createElement("div",{className:"field"},n.a.createElement("label",{htmlFor:"o:text_toggle"},"Show Exhibit Narrative"),n.a.createElement("div",{className:"ui checkbox"},n.a.createElement(gt.a,{id:"o:text_toggle",name:"o:text_toggle",component:"input",type:"checkbox"}))),n.a.createElement("div",{className:"field"},n.a.createElement("label",{htmlFor:"o:narrative"},"Narrative"),n.a.createElement("div",{className:"ui input"},n.a.createElement(gt.a,{id:"o:narrative",name:"o:narrative",component:this.renderEditor}))),this.exhibit&&this.exhibit["o:id"]&&n.a.createElement(gt.a,{name:"o:id",component:"input",type:"hidden"}))),n.a.createElement(Lt,{data:this.state.data}))}}]),a}(r.Component),Lt=function(e){Object(Fe.a)(a,e);var t=Object(Ve.a)(a);function a(){return Object(Me.a)(this,a),t.apply(this,arguments)}return Object(Pe.a)(a,[{key:"render",value:function(){return n.a.createElement("div",{className:"editor-preview"},n.a.createElement("div",{dangerouslySetInnerHTML:{__html:this.props.data}}))}}]),a}(r.Component);Lt.defaultProps={data:""},At=Object(vt.a)({form:"exhibit-text",enableReinitialize:!0})(At);Object(wt.a)("exhibit-text");var Mt=Object(o.b)((function(e){return{state:e,mapCache:e.mapCache,initialValues:e.exhibitShow.exhibit?e.exhibitShow.exhibit:{"o:narrative":{"o:narrative":e.exhibitShow.exhibit["o:narrative"]}}}}),(function(e){return Object(l.b)({change:xt.a,dispatch:e},e)}))(At),Pt=a(793),Ft=function(e){Object(Fe.a)(a,e);var t=Object(Ve.a)(a);function a(){return Object(Me.a)(this,a),t.apply(this,arguments)}return Object(Pe.a)(a,[{key:"render",value:function(){var e=this.props,t=[{menuItem:"Settings",render:function(){return n.a.createElement(Pt.a.Pane,{attached:!1},n.a.createElement(Ct,{exhibit:e.exhibit,submitLabel:k.save_exhibit,disabled:e.loading}),e.errored&&n.a.createElement("p",null,k.update_exhibit_error))}},{menuItem:"Timeline",render:function(){return n.a.createElement(Pt.a.Pane,{attached:!1},n.a.createElement(Nt,{exhibit:e.exhibit,submitLabel:k.save_exhibit,disabled:e.loading}))}},{menuItem:"NeatlineText",render:function(){return n.a.createElement(Pt.a.Pane,{attached:!1},n.a.createElement(Mt,{exhibit:e.exhibit,submitLabel:k.save_exhibit,disabled:e.loading}),e.errored&&n.a.createElement("p",null,k.update_exhibit_error))}}];return n.a.createElement("div",null,n.a.createElement(Pt.a,{menu:{secondary:!0,pointing:!0},panes:t}))}}]),a}(r.Component),Vt=Object(o.b)((function(e){return{loading:e.exhibits.exhibit.loading,errored:e.exhibits.exhibit.errored}}),(function(e){return Object(l.b)({},e)}))(Ft),Ut=a(43),zt=a.n(Ut),Ht=a(381),Bt=a.n(Ht),Gt={drawingOptions:function(e,t){return{draw:{circlemarker:!1,marker:{},rectangle:{showArea:t,showRadius:t,feet:e,metric:!e,nautic:!1},polygon:{showArea:t,showLength:t,showRadius:t,feet:e,metric:!e,nautic:!1},polyline:{showLength:t,feet:e,metric:!e,nautic:!1},circle:!1}}},invertCoordinateOrder:function(e){var t=[];if(Array.isArray(e[0])){var a=e[0];e.length>2&&(a=e),a.forEach((function(e){t.push([e[1],e[0]])})),t=[t]}else t.push([e[1],e[0]]);return t},convertToVector:function(e,t,a){if("undefined"===typeof e||null===e)return console.error("Cannot convert empty geojson"),null;var r=[];return"undefined"!==typeof e.features&&e.features.forEach((function(e,n){var i=Object(p.a)(Object(p.a)({},t),{},{dashArray:4}),o=Gt.invertCoordinateOrder(e.geometry.coordinates),l=o[0];switch(e.geometry.type){case"Polygon":var s=zt.a.polygon(o,i);s.on("click",a),s.options.editing||(s.options.editing={}),r.push(s);break;case"Point":case"Circle":var c=zt.a.marker(l,i);c.on("click",a),r.push(c);break;case"LineString":case"MultiLineString":i=Object(p.a)(Object(p.a)({},i),{},{fillColor:"transparent"});var d=zt.a.polyline(o,i);d.on("click",a),d.options.editing||(d.options.editing={}),r.push(d);break;default:console.error("I don't know how to handle geometries of type: "+e.geometry.type)}})),r},removeExistingHandlers:function(e){e.off("draw:created"),e.off("draw:deleted"),e.off("draw:deletestart"),e.off("draw:deletestop"),e.off("draw:editstart"),e.off("draw:editstop"),e.off("draw:edited"),e.off("draw:drawstart"),e.off("draw:drawstop")},clearGeometry:function(e){e.eachLayer((function(t){"undefined"!==typeof t.feature&&e.removeLayer(t)}))}},Xt=Gt,Wt=function(e){Object(Fe.a)(a,e);var t=Object(Ve.a)(a);function a(e){var r;return Object(Me.a)(this,a),(r=t.call(this,e)).componentDidUpdate=function(e){r.mapInitialized||r.ls_mapInit(),"undefined"!==typeof(e.records||r.props.records)&&r.props.records!==e.records&&r.ls_mapUpdate(),(r.firstUpdate||e.selectedRecord!==r.props.selectedRecord)&&r.ls_mapUpdate(),r.props.hasWarning?document.getElementById("leafletMap").classList.add("ps_n3_mapComponent_withWarning"):document.getElementById("leafletMap").classList.remove("ps_n3_mapComponent_withWarning")},r.ls_mapInit=function(){document.getElementById("leafletMap").classList.add("ps_n3_leafletMap"),"undefined"===typeof r.map?r.map=zt.a.map("leafletMap"):"undefined"!==typeof r.initialBaselayer&&r.initialBaselayer.remove();var e=r.props.mapCache.current.type,t=r.props.mapCache.current,a={};switch(e){case N.MAP:case N.TILE:"undefined"!==typeof t.tileLayer&&(a[t.tileLayer.displayName]=zt.a.tileLayer(t.tileLayer.url,{attribution:t.tileLayer.attribution}),r.initialBaselayer=a[t.tileLayer.displayName]);break;case N.IMAGE:r.props.leafletIsSaving(!0);var n=new Image;n.src=t.image_address,n.onerror=function(){alert("Invalid Image URL"),r.props.leafletIsSaving(!1)},n.onload=function(){var e=n.width,a=n.height,i=r.map.unproject([0,a],3),o=r.map.unproject([e,0],3),l=new zt.a.LatLngBounds(i,o),s=r.map;s.eachLayer((function(e){e._image&&s.removeLayer(e)})),zt.a.imageOverlay(t.image_address,l,{attribution:t.image_attribution}).addTo(r.map),r.map.attributionControl.addAttribution(t.image_attribution),r.map.setMaxBounds(l),r.map.setZoom(1),r.map.setMaxZoom(4),r.props.leafletIsSaving(!1)};break;case N.WMS:null!==t.wms_address&&(a[t.wms_address]=zt.a.tileLayer(t.wms_address,{attribution:t.wms_attribution,layers:t.wms_layers}),r.initialBaselayer=a[t.wms_address]);break;default:console.error("Unknown baselayer type: "+t.type)}t.basemapOptions.forEach((function(e){"undefined"!==typeof t.tileLayer&&e.slug!==t.tileLayer.slug&&(a[e.displayName]=zt.a.tileLayer(e.url,{attribution:e.attribution}))})),Object.keys(a).length>0&&("undefined"!==typeof r.layerControl&&r.layerControl.remove(),r.layerControl=zt.a.control.layers(a,{}).addTo(r.map)),"undefined"!==typeof r.initialBaselayer&&r.initialBaselayer.addTo(r.map),r.map.off("click").on("click",(function(e){r.onMapClick(e)})),r.map.setView(r.state.map_center,r.state.map_zoom),"undefined"===typeof r.ls_fg&&(r.ls_fg=new zt.a.FeatureGroup,r.ls_fg.addTo(r.map),r.ls_drawControl=new zt.a.Control.Draw(Object(p.a)(Object(p.a)({},Xt.drawingOptions()),{},{edit:{featureGroup:r.ls_fg}}))),r.mapInitialized=!0},r.ls_mapUpdate=function(){var e=r.map,t=r.props.selectedRecord,a=r.syncDrawWithReact,n=r.ls_geometrySetup();"undefined"!==typeof n&&(r.ls_fg.eachLayer((function(e){r.ls_fg.removeLayer(e)})),n.editable.forEach((function(e){r.ls_fg.addLayer(e)})),Xt.clearGeometry(e),e.removeControl(r.ls_drawControl),n.uneditable.forEach((function(t){t.addTo(e)})),"editing"===r.props.viewMode&&!1===r.props.showExhibitSettings&&("undefined"!==typeof t&&null!==t||r.props.editorNewRecord)&&e.addControl(r.ls_drawControl),Xt.removeExistingHandlers(e),e.on("draw:created",(function(e){r.ls_fg.addLayer(e.layer);var n=r.ls_fg.toGeoJSON();a(t,n)})),e.on("draw:deleted",(function(e){r.ls_hasEditToSave=!0})),e.on("draw:deletestart",(function(e){r.allowRender=!1,r.props.leafletIsEditing(!0),r.isDrawing=!0,r.ls_hasEditToSave=!1})),e.on("draw:deletestop",(function(e){if(r.props.leafletIsEditing(!1),r.isDrawing=!1,r.ls_hasEditToSave){var n=r.ls_fg.toGeoJSON();0===n.features.length&&(n={type:"MultiLineString",coordinates:[]}),a(t,n)}r.allowRender=!0})),e.on("draw:editstart",(function(e){r.allowRender=!1,r.props.leafletIsEditing(!0),r.isDrawing=!0,r.ls_hasEditToSave=!1})),e.on("draw:editstop",(function(e){if(r.props.leafletIsEditing(!1),r.isDrawing=!1,r.ls_hasEditToSave){var n=r.ls_fg.toGeoJSON();a(t,n)}r.allowRender=!0})),e.on("draw:edited",(function(e){r.ls_hasEditToSave=!0})),e.on("draw:drawstart",(function(e){r.allowRender=!1,r.props.leafletIsEditing(!0),r.isDrawing=!0})),e.on("draw:drawstop",(function(e){r.props.leafletIsEditing(!1),window.setTimeout(function(){this.isDrawing=!1}.bind(Object(Dt.a)(r)),200),r.allowRender=!0})))},r.ls_geometrySetup=function(){if("undefined"!==typeof r.props.records){var e=r.onGeometryClick,t=r.props.selectedRecord,a=r.props.recordMouseEnter,n=r.props.recordMouseLeave,i=[],o=[];return r.props.mapCache.cache.map((function(l){var s=null!==l&&null!==t&&l["o:id"]===t["o:id"];if(l["o:is_wms"]);else if(l["o:is_coverage"]){var c=l["o:coverage"];"string"===typeof c&&(c=JSON.parse(c));var d=r.props.mapCache.default.geometryStyles,u=l["o:id"],p=d;u in r.props.mapCache.cache?null===(p=r.props.mapCache.cache[u])["o:fill_color"]&&(console.log("**** BROKEN STYLE CACHE - USING DEFAULT"),p=d):console.log("**** MISSING STYLE CACHE - USING DEFAULT");var m=function(){return{stroke:!0,fill:!0,weight:p["o:stroke_width"],color:s?p["o:stroke_color_select"]:p["o:stroke_color"],opacity:s?p["o:stroke_opacity_select"]:p["o:stroke_opacity"],fillColor:s?p["o:fill_color_select"]:p["o:fill_color"],fillOpacity:s?p["o:fill_opacity_select"]:p["o:fill_opacity"]}};if(s)i=Xt.convertToVector(c,m(),(function(t){e(t,l)}));else{var h=zt.a.geoJSON();h.addData(c),h.on("click",(function(t){e(t,l)})),h.on("mouseover",(function(){a(l)})),h.on("mouseout",(function(){n(l)})),h.setStyle((function(e,t){var a=m();return"LineString"!==e.geometry.type&&"MultiLineString"!==e.geometry.type||(a.fillColor="transparent"),a})),o.push(h)}}return null})),{editable:i,uneditable:o}}},r.syncDrawWithReact=function(e,t){if("undefined"!==typeof r.props.records){var a="undefined"!==typeof e&&null!==e&&e["o:id"]?e["o:id"]:-1;r.props.change("record","o:coverage",t),r.props.change("record","o:is_coverage",!0),r.props.deselectRecord(),r.props.updateRecordCacheAndSave({setValues:{"o:id":a,"o:coverage":t,"o:is_coverage":!0},selectedRecord:e}),console.log("sync",r.props)}},r.event_refreshMap=function(e){r.mapInitialized=!1,r.event_refreshMapGeometry(e)},r.event_refreshMapGeometry=function(e){r.cacheInitialized=!1,r.ls_mapUpdate(),r.forceUpdate(),r.props.leafletIsEditing(!1),r.allowRender=!0},r.onGeometryClick=function(e,t){"undefined"===typeof r.props.records||r.isDrawing||(zt.a.DomEvent.stop(e),r.props.selectRecord({record:t}),"editing"===r.props.viewMode&&(r.props.setShowRecords(!1),r.props.setShowExhibitSettings(!1),r.props.setRecordEditorType("edit")),r.forceUpdate())},r.onMapClick=function(e){zt.a.DomEvent.stop(e),"undefined"===typeof r.props.records||r.isDrawing||(r.map.removeControl(r.ls_drawControl),r.props.setShowRecords(!0),r.props.deselectRecord(),r.forceUpdate())},r.state={map_center:[51.505,-.09],map_zoom:13},r.cacheInitialized=!1,r.mapInitialized=!1,r.allowRender=!0,r.isDrawing=!1,r.Draw=Bt.a,r.geoClick=!1,r}return Object(Pe.a)(a,[{key:"render",value:function(){return n.a.createElement("div",{id:"leafletMap"})}},{key:"shouldComponentUpdate",value:function(){return this.allowRender}},{key:"componentDidMount",value:function(){document.addEventListener("refreshMapGeometry",this.event_refreshMapGeometry),document.addEventListener("refreshMap",this.event_refreshMap),this.firstUpdate=!0,this.forceUpdate()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("refreshMapGeometry",this.event_refreshMapGeometry),document.removeEventListener("refreshMap",this.event_refreshMap)}}]),a}(r.Component),Yt=Object(o.b)(null,(function(e){return Object(l.b)({selectRecord:ot,leafletIsEditing:et,deselectRecord:lt,recordMouseEnter:function(e){return Ge("RECORD_PREVIEWED",e)},recordMouseLeave:nt,change:xt.a,dispatch:e,leafletIsSaving:tt,updateRecordCacheAndSave:Ke,setShowRecords:dt,setShowExhibitSettings:ut},e)}))(Wt),qt=a(35),Jt=(a(670),function(e){var t=e.domain,a=e.range,i=e.timeEntries,o=e.spanHeight,l=qt.d,s=Object(r.useRef)(),c=Object(r.useRef)(),d=o/4,u=qt.g().key((function(e){return null!=e.tier?e.tier:e.id})).entries(i).sort((function(e,t){return e.key-t.key}));return Object(r.useEffect)((function(){var e=qt.h().domain(t).range(a).nice(),r=qt.j().on("zoom",(function(){var t=qt.b.transform,a=t.rescaleX(e).interpolate(qt.c);_.call(v,a),b.selectAll("rect").attr("x",(function(e){return t.applyX(p(e))})).attr("width",(function(e){return t.k*m(e)})),b.selectAll("circle").attr("cx",(function(e){return t.applyX(p(e))})),b.selectAll("text.span").attr("x",(function(a){return t.applyX(e(l(a.end_date)))})),b.selectAll("text.point").attr("x",(function(e){return t.applyX(p(e))+d}))})),n=qt.i(s.current),i=qt.i(c.current),p=function(t){return e(l(t.start_date))},m=function(t){return e(l(t.end_date))-e(l(t.start_date))},h=function(e){return qt.i(this).selectAll("circle").data((function(e){return e.values.filter((function(e){return null===e.end_date}))})).enter().append("circle").attr("cx",(function(e){return p(e)})).attr("cy",o/2).attr("r",d).attr("fill",(function(e){return e.fill_color})).style("cursor","pointer").on("click",(function(e){return console.log("start: "+e.start_date+" end: "+e.end_date)}))},b=qt.i(".tl-main").selectAll("svg").data(u).enter().append("svg").attr("class","tl-item").attr("height",o).each((function(e){return qt.i(this).selectAll("rect").data((function(e){return e.values.filter((function(e){return null!=e.end_date}))})).enter().append("rect").attr("x",(function(e){return p(e)})).attr("y",0).attr("width",(function(e){return m(e)})).attr("height",o).attr("fill",(function(e){return e.fill_color})).style("cursor","pointer").on("click",(function(e){return console.log("start: "+e.start_date+" end: "+e.end_date)}))}),h).each(h).each((function(t){return qt.i(this).selectAll("text .span").data((function(e){return e.values.filter((function(e){return null!=e.end_date}))})).enter().append("text").attr("class","span").attr("x",(function(t){return e(l(t.end_date))})).attr("y",o/2+5).text((function(e){return e.title}))})).each((function(e){return qt.i(this).selectAll("text .point").data((function(e){return e.values.filter((function(e){return null===e.end_date}))})).enter().append("text").attr("class","point").attr("x",(function(e){return p(e)+d})).attr("y",o/2+5).text((function(e){return e.title}))})),_=i.append("svg"),E=qt.i("#reset"),f=qt.i("#zoomIn"),y=qt.i("#zoomOut"),g=o*u.length+22,v=function(e,t){return e.attr("color","#333").attr("height",g+22).style("font-size","0.9rem").call(qt.a(t).ticks(12).tickSize(g)).call((function(e){return e.select(".domain").attr("display","none")})).call((function(e){return e.selectAll(".tick").selectAll("line").attr("stroke","#D8D8D8").style("stroke-dasharray","5 5")}))};E.on("click",(function(){n.transition().duration(1e3).call(r.transform,qt.k)})),f.on("click",(function(){n.transition().call(r.scaleBy,2)})),y.on("click",(function(){n.transition().call(r.scaleBy,.5)})),n.call(r).call(r.transform,qt.k)}),[]),n.a.createElement("div",{className:"nl-timeline-container"},n.a.createElement("div",{className:"tl-controls"},n.a.createElement("span",{id:"zoomIn",className:"tl-controls-button"},n.a.createElement(Be.a,{name:"search plus"})),n.a.createElement("span",{id:"zoomOut",className:"tl-controls-button"},n.a.createElement(Be.a,{name:"search minus"})),n.a.createElement("span",{id:"reset",className:"tl-controls-button"},n.a.createElement(Be.a,{name:"undo alternate"}))),n.a.createElement("div",{className:"tl-main",ref:s}),n.a.createElement("div",{className:"tl-axis",ref:c}))}),Zt=function(){var e=qt.d,t=[{tier:"1",id:"69",owner_id:"2",item_id:null,exhibit_id:"5",added:"2020-04-29 15:06:48",modified:"2020-04-29 04:10:49",is_coverage:"1",is_wms:"0",slug:null,title:"Lynn Carol Allen",item_title:null,body:null,coverage:"0x00000000010700000001000000010100000016bd53bcb36c62c1f26327f5287c5041",tags:"sportsmaker",widgets:"Simile",presenter:"StaticBubble",fill_color:"#00aeff",fill_color_select:"#00aeff",stroke_color:"white",stroke_color_select:"black",fill_opacity:"0.80",fill_opacity_select:"1.00",stroke_opacity:"0.80",stroke_opacity_select:"1.00",stroke_width:"2",point_radius:"6",zindex:null,weight:null,start_date:"1951-10-22",end_date:"1954-10-22",after_date:null,before_date:null,point_image:null,wms_address:null,wms_layers:null,min_zoom:null,max_zoom:null,map_zoom:"5",map_focus:"-10767225.550863,4172850.2475636"},{tier:"1",id:"60",owner_id:"2",item_id:null,exhibit_id:"5",added:"2020-04-29 15:26:15",modified:"2020-04-29 04:10:36",is_coverage:"1",is_wms:"0",slug:null,title:"Katherine Bennett",item_title:null,body:null,coverage:"0x000000000107000000010000000101000000a3a366e0e62e60c188380ccb33905041",tags:"sportsmaker",widgets:"Simile",presenter:"StaticBubble",fill_color:"#98df8a",fill_color_select:"#00aeff",stroke_color:"white",stroke_color_select:"black",fill_opacity:"0.80",fill_opacity_select:"1.00",stroke_opacity:"0.80",stroke_opacity_select:"1.00",stroke_width:"2",point_radius:"6",zindex:null,weight:null,start_date:"1932-10-17",end_date:"1933-10-17",after_date:null,before_date:null,point_image:null,wms_address:null,wms_layers:null,min_zoom:null,max_zoom:null,map_zoom:"5",map_focus:"-10767225.550863,4172850.2475636"},{tier:null,id:"61",owner_id:"2",item_id:null,exhibit_id:"5",added:"2020-04-29 15:31:03",modified:"2020-04-29 04:10:24",is_coverage:"1",is_wms:"0",slug:null,title:"Evie Garrett Dennis",item_title:null,body:null,coverage:"0x00000000010700000001000000010100000070057991b01163c113fa4f5ad55c4d41",tags:"sportsmaker",widgets:"Simile",presenter:"StaticBubble",fill_color:"#00aeff",fill_color_select:"#00aeff",stroke_color:"white",stroke_color_select:"black",fill_opacity:"0.80",fill_opacity_select:"1.00",stroke_opacity:"0.80",stroke_opacity_select:"1.00",stroke_width:"2",point_radius:"6",zindex:null,weight:null,start_date:"1944-9-8",end_date:"1945-9-8",after_date:null,before_date:null,point_image:null,wms_address:null,wms_layers:null,min_zoom:null,max_zoom:null,map_zoom:"5",map_focus:"-10767225.550863,4172850.2475636"},{tier:null,id:"62",owner_id:"2",item_id:null,exhibit_id:"5",added:"2020-04-29 15:37:26",modified:"2020-04-29 04:10:04",is_coverage:"1",is_wms:"0",slug:null,title:"Benita Fitzgerald Mosley",item_title:null,body:null,coverage:"0x0000000001070000000100000001010000008399c0e49b6a60c1541f48280cd15141",tags:"sportsmaker",widgets:"Simile",presenter:"StaticBubble",fill_color:"#00aeff",fill_color_select:"#00aeff",stroke_color:"white",stroke_color_select:"black",fill_opacity:"0.80",fill_opacity_select:"1.00",stroke_opacity:"0.80",stroke_opacity_select:"1.00",stroke_width:"2",point_radius:"6",zindex:null,weight:null,start_date:"1961-7-6",end_date:null,after_date:null,before_date:null,point_image:null,wms_address:null,wms_layers:null,min_zoom:null,max_zoom:null,map_zoom:"5",map_focus:"-10767225.550863,4172850.2475636"},{tier:null,id:"63",owner_id:"2",item_id:null,exhibit_id:"5",added:"2020-04-29 16:02:32",modified:"2020-04-29 04:09:45",is_coverage:"1",is_wms:"0",slug:null,title:"Dionne Warwick",item_title:null,body:null,coverage:"0x0000000001070000000100000001010000005ae553a2ec825fc1f5eb18b7acfc5241",tags:"musicmaker",widgets:"Simile",presenter:"StaticBubble",fill_color:"#98df8a",fill_color_select:"#98df8a",stroke_color:"white",stroke_color_select:"black",fill_opacity:"0.80",fill_opacity_select:"1.00",stroke_opacity:"0.80",stroke_opacity_select:"1.00",stroke_width:"2",point_radius:"6",zindex:null,weight:null,start_date:null,end_date:null,after_date:null,before_date:null,point_image:null,wms_address:null,wms_layers:null,min_zoom:null,max_zoom:null,map_zoom:"5",map_focus:"-10767225.550863,4172850.2475636"},{tier:"2",id:"64",owner_id:"2",item_id:null,exhibit_id:"5",added:"2020-04-29 16:20:40",modified:"2020-04-29 04:56:55",is_coverage:"1",is_wms:"0",slug:null,title:"Billie Allen",item_title:null,body:null,coverage:"0x000000000107000000010000000101000000acdc70718f7160c144db31d9f7375141",tags:"artmaker",widgets:"Simile",presenter:"StaticBubble",fill_color:"#f781bf",fill_color_select:"#f781bf",stroke_color:"white",stroke_color_select:"black",fill_opacity:"0.80",fill_opacity_select:"1.00",stroke_opacity:"0.80",stroke_opacity_select:"1.00",stroke_width:"2",point_radius:"6",zindex:null,weight:null,start_date:"1925-1-13",end_date:null,after_date:null,before_date:null,point_image:null,wms_address:null,wms_layers:null,min_zoom:null,max_zoom:null,map_zoom:"5",map_focus:"-10767225.550863,4172850.2475636"},{tier:null,id:"65",owner_id:"2",item_id:null,exhibit_id:"5",added:"2020-04-29 17:00:08",modified:"2020-04-29 05:01:11",is_coverage:"1",is_wms:"0",slug:null,title:"Madeleine Moore Burrell",item_title:null,body:null,coverage:"0x000000000107000000010000000101000000be2951ddc0675fc1b284b5c953ec5241",tags:"mediamaker",widgets:"Simile",presenter:"StaticBubble",fill_color:"#f0027f",fill_color_select:"#f0027f",stroke_color:"white",stroke_color_select:"black",fill_opacity:"0.80",fill_opacity_select:"1.00",stroke_opacity:"0.80",stroke_opacity_select:"1.00",stroke_width:"2",point_radius:"6",zindex:null,weight:null,start_date:"1940-9-10",end_date:null,after_date:null,before_date:null,point_image:null,wms_address:null,wms_layers:null,min_zoom:null,max_zoom:null,map_zoom:"5",map_focus:"-10767225.550863,4172850.2475636"},{tier:"2",id:"66",owner_id:"2",item_id:null,exhibit_id:"5",added:"2020-04-29 17:22:08",modified:"2020-04-29 05:23:23",is_coverage:"1",is_wms:"0",slug:null,title:"Anna Langford",item_title:null,body:null,coverage:"0x00000000010700000001000000010100000013765b65eacb61c1c3c8dc7c1a845241",tags:"lawmaker",widgets:"Simile",presenter:"StaticBubble",fill_color:"#ffbb78",fill_color_select:"#ffbb78",stroke_color:"white",stroke_color_select:"black",fill_opacity:"0.80",fill_opacity_select:"1.00",stroke_opacity:"0.80",stroke_opacity_select:"1.00",stroke_width:"2",point_radius:"6",zindex:null,weight:null,start_date:"1917-10-27",end_date:null,after_date:null,before_date:null,point_image:null,wms_address:null,wms_layers:null,min_zoom:null,max_zoom:null,map_zoom:"5",map_focus:"-10767225.550863,4172850.2475636"},{tier:null,id:"67",owner_id:"2",item_id:null,exhibit_id:"5",added:"2020-04-30 17:55:38",modified:"2020-04-30 05:57:04",is_coverage:"1",is_wms:"0",slug:null,title:"Ruth Beckford",item_title:null,body:null,coverage:"0x000000000107000000010000000101000000bce7c093a9f669c10b4c02ce835d5141",tags:"artmaker",widgets:"Simile",presenter:"StaticBubble",fill_color:"#f781bf",fill_color_select:"#f781bf",stroke_color:"white",stroke_color_select:"black",fill_opacity:"0.80",fill_opacity_select:"1.00",stroke_opacity:"0.80",stroke_opacity_select:"1.00",stroke_width:"2",point_radius:"6",zindex:null,weight:null,start_date:"1925-12-7",end_date:null,after_date:null,before_date:null,point_image:null,wms_address:null,wms_layers:null,min_zoom:null,max_zoom:null,map_zoom:"5",map_focus:"-10767225.550863,4172850.2475636"}],a=qt.f(t,(function(t){return e(t.start_date)})),r=qt.e(t,(function(t){return e(t.end_date)})),i=t.filter((function(e){return null!=e.start_date})),o=qt.h().domain([a,r]).range([0,1e3]);return n.a.createElement(Jt,{domain:o.domain(),range:o.range(),timeEntries:i,spanHeight:16})},Kt=(a(671),function(e){Object(Fe.a)(a,e);var t=Object(Ve.a)(a);function a(){return Object(Me.a)(this,a),t.apply(this,arguments)}return Object(Pe.a)(a,[{key:"render",value:function(){return n.a.createElement("div",{className:"nl-narrative"},n.a.createElement("h2",null,"Rendered content"))}}]),a}(r.Component));var Qt=Object(o.b)((function(e){return{mapCache:e.mapCache,selectedRecord:e.exhibitShow.selectedRecord,previewedRecord:e.exhibitShow.previewedRecord}}),(function(e){return Object(l.b)({},e)}))((function(e){var t=e.selectedRecord,a=e.previewedRecord,r=t||a;if(r){var i=e.mapCache.hasUnsavedChanges?"ps_n3_info_component_withWarning":"ps_n3_info_component";return i=e.isVisible?i:"hidden",n.a.createElement("div",{className:i},n.a.createElement("div",{style:{marginRight:"20px"}},r["o:title"]),t&&n.a.createElement("div",null,n.a.createElement("hr",null),n.a.createElement("p",null,r["o:body"])))}return null})),$t=a(794),ea=a(792),ta=function(e){Object(Fe.a)(a,e);var t=Object(Ve.a)(a);function a(e){var r;return Object(Me.a)(this,a),(r=t.call(this,e)).resetSearch=function(){return r.setState({results:r.props.filteredRecords,column:null,direction:null,searchTerm:""})},r.searchChange=function(e,t){if(t.value.length<1)return r.resetSearch();r.setState({searchTerm:t.value})},r.handleSort=function(e){return function(){var t=r.state,a=t.column,n=t.results,i=t.direction;a===e?r.setState({results:r.props.filteredRecords.reverse(),direction:"ascending"===i?"descending":"ascending"}):r.setState({column:e,results:n.sort((function(t,a){return null!=t[e]&&null!=a[e]?"o:title"===e?t[e].toUpperCase().localeCompare(a[e].toUpperCase()):"o:added"===e?new Date(t[e])-new Date(a[e]):new Date(t["o:added"])-new Date(a["o:added"]):new Date(t["o:added"])-new Date(a["o:added"])})),direction:"ascending"})}},r.mouseClick=function(e,t){if(13===e.keyCode){var a=r.props.records.filter((function(e){return(e["o:title"]||"").includes(r.state.searchTerm)}));return r.props.filterRecords(a)}},r.setActiveCard=function(e){r.setState({activeCard:e})},r.state={activeCard:null},r}return Object(Pe.a)(a,[{key:"componentWillMount",value:function(){this.setState({column:null,direction:null}),this.resetSearch()}},{key:"render",value:function(){var e=this,t=this.props,a=this.state;return n.a.createElement("div",{className:"nl-records-editor"},"editing"===this.props.viewMode?n.a.createElement("div",null,n.a.createElement($t.a,{fluid:!0,onSearchChange:function(t,a){return e.searchChange(t,a)},showNoResults:!1,size:"small",onKeyDown:function(t,a){return e.mouseClick(t,a)},placeholder:"Press enter to submit"}),n.a.createElement(ze.a,{size:"medium",fluid:!0,icon:!0,color:"blue",onClick:function(){t.setRecordEditorType("new"),t.setShowRecords(!1)}},k.new_record," ",n.a.createElement(Be.a,{name:"sticky note outline"}))):null,"editing"===this.props.viewMode?n.a.createElement("table",{className:"tablesaw neatline tablesaw-stack neatline-records"},n.a.createElement("thead",null,n.a.createElement("tr",null,n.a.createElement("th",{className:"o:title"===a.column?a.direction:null,onClick:this.handleSort("o:title")},"Record Title"),n.a.createElement("th",{className:"o:added"===a.column?a.direction:null,onClick:this.handleSort("o:added")},"Record Created"))),n.a.createElement("tbody",null,t.filteredRecords.map((function(a){return n.a.createElement("tr",{key:"record-"+a["o:id"]},n.a.createElement("td",{style:{fontWeight:a===t.selectedRecord?"bold":"normal"}},n.a.createElement("b",{className:"tablesaw-cell-label"},"Record Title"),n.a.createElement("span",{className:"tablesaw-cell-content"},n.a.createElement("a",{className:"ps_n3_exhibitTitle",onClick:function(){t.selectRecord({record:a}),t.setShowRecords(!1),t.setRecordEditorType("edit")}},null===a["o:title"]?"???":a["o:title"]),n.a.createElement("ul",{className:"actions neatline"},n.a.createElement("li",null,n.a.createElement("a",{title:"Edit Record",onClick:function(){t.selectRecord({record:a}),t.setShowRecords(!1),t.setRecordEditorType("edit")},"aria-label":"Edit Record"},n.a.createElement(Be.a,{name:"pencil alternate"}))),t.userSignedIn&&n.a.createElement("li",null,n.a.createElement("a",{onClick:function(){e.props.dispatch(e.props.removeRecordFromCache(a["o:id"])),e.props.deleteRecord(a)},disabled:t.deleteInProgress},n.a.createElement(Be.a,{name:"trash alternate"})))))),n.a.createElement("td",null,n.a.createElement("b",{className:"tablesaw-cell-label"},"Record Created"),n.a.createElement("span",{className:"tablesaw-cell-content"},null===a["o:added"]?"???":a["o:added"].toString())))})))):n.a.createElement("div",{className:"ps_n3_exhibitFormContainer"},t.filteredRecords.map((function(a){return n.a.createElement(ea.a,{style:{marginTop:"4px"},fluid:!0,key:a["o:id"],color:null!==e.props.selectedRecord&&a["o:id"]===e.props.selectedRecord["o:id"]?"blue":null},n.a.createElement(ea.a.Content,{onClick:function(){e.setActiveCard(a["o:id"]),t.selectRecord({record:a})}},n.a.createElement(ea.a.Header,null,a["o:title"]),n.a.createElement(ea.a.Description,{style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}},a["o:body"])))}))))}}]),a}(r.Component),aa=Object(o.b)((function(e){return{record:e.record,records:e.exhibitShow.records,selectedRecord:e.exhibitShow.selectedRecord,filteredRecords:e.exhibitShow.filteredRecords}}),(function(e){return Object(l.b)({selectRecord:ot,filterRecords:ct,deleteRecord:qe,removeRecordFromCache:$e,dispatch:e},e)}))(ta),ra=a(92),na=a(383),ia=function(e){Object(Fe.a)(a,e);var t=Object(Ve.a)(a);function a(){return Object(Me.a)(this,a),t.apply(this,arguments)}return Object(Pe.a)(a,[{key:"render",value:function(){return n.a.createElement("div",{id:"ps_n3_colorPickerComponent",style:{top:this.props.top,left:"30px"},className:this.props.isVisible?"ps_n3_colorPicker_picker":"ps_n3_colorPicker_picker ps_n3_hidden"},n.a.createElement(na.SketchPicker,{color:this.props.color,onChange:this.props.handleChange}))}}]),a}(n.a.Component),oa=a(384),la=a.n(oa),sa=a(141),ca=a.n(sa),da=function(e){Object(Fe.a)(a,e);var t=Object(Ve.a)(a);function a(){return Object(Me.a)(this,a),t.apply(this,arguments)}return Object(Pe.a)(a,[{key:"render",value:function(){var e=this,t=this.props.formatDate(this.props.value);return ca()(this.props.value).isValid()||(t=""),n.a.createElement("div",null,n.a.createElement("label",{htmlFor:this.props.fieldName},this.props.label),n.a.createElement(gt.a,{id:this.props.fieldName,name:this.props.fieldName,component:"input",type:"hidden"}),n.a.createElement(la.a,{className:"styleEditor_input",formatDate:this.props.formatDate,parseDate:this.props.parseDate,value:t,onDayChange:function(t){e.props.onDayChange({target:{value:t,name:e.props.fieldName}})}}))}}]),a}(n.a.Component),ua=a(68),pa=(a(774),a(118)),ma=a.n(pa),ha=(a(778),{"o:fill_color":"#00aeff","o:fill_color_select":"#00aeff","o:stroke_color":"#000000","o:stroke_color_select":"#000000","o:fill_opacity":.3,"o:fill_opacity_select":.4,"o:stroke_opacity":.9,"o:stroke_opacity_select":1,"o:stroke_width":2,"o:point_radius":10}),ba=function(e){Object(Fe.a)(a,e);var t=Object(Ve.a)(a);function a(e){var r;return Object(Me.a)(this,a),(r=t.call(this,e)).markUnsaved=function(e){"undefined"!==typeof e&&(e.target.name.includes("date")&&(e.target.value=ca()(e.target.value).format("YYYY-MM-DD")),r.props.updateRecordCache({setValues:Object(yt.a)({"o:id":r.props.initialValues["o:id"]},e.target.name,e.target.value)})),r.props.mapCache.hasUnsavedChanges||r.props.setUnsavedChanges({hasUnsavedChanges:!0})},r.deleteRecord=function(){console.log("delete Record",r.props.initialValues["o:id"]),r.props.removeRecordFromCache({recordID:r.props.initialValues["o:id"]}),r.handleDelete()},r.scrollEvent=function(e){r.hideColorPicker(e)},r._colorPickerListener=function(e){var t=e.target,a=document.getElementById("colorPickerComponent");do{if(t===a)return;t=t.parentNode}while(t);r.state.colorPickerVisible&&r.hideColorPicker(e)},r.colorPickerEventHandler=function(e){e?document.addEventListener("click",r._colorPickerListener):document.removeEventListener("click",r._colorPickerListener)},r.showColorPicker=function(e,t){var a=document.getElementById("scrollArea_stylePropertyPicker"),n=e.target.offsetTop-a.scrollTop;n+=8,r.setState({colorPickerCurrentColor:e.target.dataset.initialcolor,colorPickerCurrentField:e.target.dataset.fieldname,colorPickerCurrentlyEditing:t,colorPickerVisible:!0,colorPickerTop:"".concat(n,"px")}),r.colorPickerEventHandler(!0)},r.hideColorPicker=function(e){r.setState({colorPickerVisible:!1}),r.colorPickerEventHandler(!1),r.props.dispatch(r.change(r.props.form,r.state.colorPickerCurrentField,r.state.colorPickerCurrentColor))},r.handleColorChange=function(e,t){var a=r.state.colorPickerCurrentlyEditing,n=e.hex;r.setState(Object(yt.a)({colorPickerCurrentColor:n},a,n)),"undefined"===typeof a?console.error("Cannot update cache with undefined prop!:"+n):(r.props.updateRecordCache({setValues:Object(yt.a)({"o:id":r.props.initialValues["o:id"]},a,n)}),r.markUnsaved())},r.slider_changeStart=function(e){r.slider.fieldName=e},r.slider_change=function(e){if(r.slider.fieldName.length>0){r.slider.value=e.toFixed(2);var t=Object(p.a)(Object(p.a)({},r.state.sliderValues),{},Object(yt.a)({},r.slider.fieldName,parseFloat(r.slider.value)));r.setState({sliderValues:t}),r.markUnsaved({target:{value:r.slider.value,name:r.slider.fieldName}})}},r.slider_changeComplete=function(e){r.props.dispatch(r.change(r.props.form,r.slider.fieldName,r.slider.value)),r.markUnsaved({target:{value:r.slider.value,name:r.slider.fieldName}}),r.slider={fieldName:"",value:""}},r.inputEnforce=function(e){var t=e.target.dataset.enforce,a=e.target.value,n=e.target.name,i=null;switch(t){case"float":/[^.\d]/.test(a)&&(i=parseFloat(a),i=isNaN(i)?"":i.toString());break;case"normal":i=(i=(i=/[^.\d]/.test(a)?parseFloat(a):a)>1?1:i)<0?0:i,i=isNaN(i)?"":i.toString();break;case"hex":(a.length>=7||a.length>0&&"#"!==a.substring(0,1))&&(/^#+([a-fA-F0-9]{6}|[a-fA-F0-9]{3})$/.test(a)||(i="#"!==a.substring(0,1)?"#"+a.substring(0,6):a.substring(0,7)));break;default:console.log("RecordForm inputEnforce: I don't know how to enforce: "+t)}null!==i&&setTimeout((function(){r.props.dispatch(r.change(r.props.form,n,i))}),100),r.markUnsaved()},r.change=xt.a,r.handleSubmit=e.handleSubmit,r.submitLabel=e.submitLabel,r.disabled=e.disabled,r.showDelete=e.showDelete,r.handleDelete=e.handleDelete,r.slider={fieldName:"",value:""},r.state={strings:k,exhibitType:"map",colorPickerVisible:!1,colorPickerTop:0,colorPickerCurrentColor:"000000",colorPickerCurrentField:"",colorPickerDefaultColor:"#000000",sliderValues:{}},r.cacheInitialized=!1,r}return Object(Pe.a)(a,[{key:"componentDidMount",value:function(){var e={"o:fill_opacity":isNaN(parseFloat(this.props.initialValues["o:fill_opacity"]))?0:parseFloat(this.props.initialValues["o:fill_opacity"]),"o:stroke_opacity":isNaN(parseFloat(this.props.initialValues["o:stroke_opacity"]))?0:parseFloat(this.props.initialValues["o:stroke_opacity"]),"o:stroke_opacity_select":isNaN(parseFloat(this.props.initialValues["o:stroke_opacity_select"]))?0:parseFloat(this.props.initialValues["o:stroke_opacity_select"]),"o:stroke_width":isNaN(parseFloat(this.props.initialValues["o:stroke_width"]))?0:parseFloat(this.props.initialValues["o:stroke_width"]),"o:fill_opacity_select":isNaN(parseFloat(this.props.initialValues["o:fill_opacity_select"]))?0:parseFloat(this.props.initialValues["o:fill_opacity_select"])};this.setState({sliderValues:e})}},{key:"componentWillReceiveProps",value:function(e){this.cacheInitialized&&e.initialValues["o:id"]===this.props.initialValues["o:id"]||(this.props.updateRecordCache({setValues:e.initialValues}),this.setState({recordID:e.initialValues["o:id"]}),this.cacheInitialized=!0)}},{key:"render",value:function(){var e=this,t=this.props.mapCache.cache[this.props.initialValues["o:id"]],a=this.props.selectedRecord&&this.state.recordID===this.props.selectedRecord["o:id"];return this.props.userSignedIn?n.a.createElement("form",{className:"ps_n3_exhibit-form",onSubmit:this.handleSubmit},n.a.createElement(ia,{color:this.state.colorPickerCurrentColor,isVisible:this.state.colorPickerVisible,top:"30px",handleChange:this.handleColorChange}),n.a.createElement(ra.d,null,n.a.createElement(ra.b,null,n.a.createElement(ra.a,null,k.text),n.a.createElement(ra.a,null,k.style)),n.a.createElement("div",null,n.a.createElement(ra.c,null,n.a.createElement("div",{className:"ps_n3_recordFormContainer",onScroll:this.scrollEvent},n.a.createElement("fieldset",{disabled:this.disabled,style:{border:"none",padding:"0"}},n.a.createElement("legend",null,n.a.createElement("h4",null,"Text Description")),n.a.createElement("div",{className:"field"},n.a.createElement("label",{htmlFor:"o:title"},k.title),n.a.createElement("div",{className:"ui input"},n.a.createElement(gt.a,{id:"o:title",name:"o:title",component:"textarea",onChange:this.markUnsaved}))),n.a.createElement("div",{className:"field"},n.a.createElement("label",{htmlFor:"o:slug"},k.slug),n.a.createElement("div",{className:"ui input"},n.a.createElement(gt.a,{id:"o:slug",name:"o:slug",component:"input",type:"text",onChange:this.markUnsaved}))),n.a.createElement("div",{className:"field"},n.a.createElement("label",{htmlFor:"o:body"},k.body),n.a.createElement("div",{className:"ui input"},n.a.createElement(gt.a,{id:"o:body",name:"o:body",component:"textarea",onChange:this.markUnsaved})))))),n.a.createElement(ra.c,null,n.a.createElement("div",{className:"ps_n3_recordFormContainer",onScroll:this.scrollEvent},"undefined"===typeof this.state.recordID&&n.a.createElement("div",null,n.a.createElement("i",null,"save record before editing style")),"undefined"!==typeof this.state.recordID&&n.a.createElement("div",null,n.a.createElement("fieldset",{id:"scrollArea_stylePropertyPicker",disabled:this.disabled,style:{border:"none",padding:"0"}},n.a.createElement("div",{className:a?"":"ps_n3_highlight"},n.a.createElement("div",{className:"ps_n3_optionHeader"},k.colors),n.a.createElement("div",{className:"field"},n.a.createElement("label",{htmlFor:"o:fill_color"},k.fill_color),n.a.createElement("div",{className:"ui input"},n.a.createElement(gt.a,{className:"styleEditor_input",id:"o:fill_color",name:"o:fill_color",component:"input",type:"text","data-enforce":"hex",onChange:this.inputEnforce})),n.a.createElement("div",{className:"ps_n3_inputColorSwatch","data-initialcolor":this.props.initialValues["o:fill_color"],"data-fieldname":"o:fill_color",onClick:function(t){return e.showColorPicker(t,"o:fill_color")},style:{backgroundColor:"undefined"!==typeof t?t["o:fill_color"]:"#0000FF"}})),n.a.createElement("div",{className:"field"},n.a.createElement("label",{htmlFor:"o:stroke_color"},k.stroke_color),n.a.createElement("div",{className:"ui input"},n.a.createElement(gt.a,{className:"styleEditor_input",id:"o:stroke_color",name:"o:stroke_color",component:"input",type:"text","data-enforce":"hex",onChange:this.inputEnforce})),n.a.createElement("div",{className:"ps_n3_inputColorSwatch","data-fieldname":"o:stroke_color","data-initialcolor":this.props.initialValues["o:stroke_color"],onClick:function(t){return e.showColorPicker(t,"o:stroke_color")},style:{backgroundColor:"undefined"!==typeof t?t["o:stroke_color"]:"#0000FF"}})),n.a.createElement("div",null,n.a.createElement("label",{htmlFor:"o:fill_opacity"},k.fill_opacity),n.a.createElement(ma.a,{value:this.state.sliderValues["o:fill_opacity"],min:.1,max:1,step:.01,orientation:"horizontal",onChangeStart:function(){return e.slider_changeStart("o:fill_opacity")},onChange:this.slider_change,onChangeComplete:this.slider_changeComplete}),n.a.createElement(gt.a,{id:"o:fill_opacity",name:"o:fill_opacity",component:"input",type:"hidden"})),n.a.createElement("div",null,n.a.createElement("label",{htmlFor:"o:stroke_opacity"},k.stroke_opacity),n.a.createElement(ma.a,{value:this.state.sliderValues["o:stroke_opacity"],min:.1,max:1,step:.01,orientation:"horizontal",onChangeStart:function(){return e.slider_changeStart("o:stroke_opacity")},onChange:this.slider_change,onChangeComplete:this.slider_changeComplete}),n.a.createElement(gt.a,{id:"o:stroke_opacity",name:"o:fill_opacity",component:"input",type:"hidden"}))),n.a.createElement("div",{className:a?"ps_n3_highlight":""},n.a.createElement("div",{className:"ps_n3_optionHeader"},k.selected),n.a.createElement("div",{className:"field",style:{background:"none"}},n.a.createElement("label",{htmlFor:"o:fill_color_select"},k.selected_fill_color),n.a.createElement("div",{className:"ui input"},n.a.createElement(gt.a,{className:"styleEditor_input",id:"o:fill_color_select",name:"o:fill_color_select",component:"input",type:"text","data-enforce":"hex",onChange:this.inputEnforce})),n.a.createElement("div",{onClick:function(t){return e.showColorPicker(t,"o:fill_color_select")},className:"ps_n3_inputColorSwatch","data-initialcolor":this.props.initialValues["o:fill_color_select"],"data-fieldname":"o:fill_color_select",style:{backgroundColor:"undefined"!==typeof t?t["o:fill_color_select"]:"#0000FF"}})),n.a.createElement("div",{className:"field",style:{background:"none"}},n.a.createElement("label",{htmlFor:"o:stroke_color_select"},k.selected_stroke_color),n.a.createElement("div",{className:"ui input"},n.a.createElement(gt.a,{className:"styleEditor_input",id:"o:stroke_color_select",name:"o:stroke_color_select",component:"input",type:"text","data-enforce":"hex",onChange:this.inputEnforce})),n.a.createElement("div",{onClick:function(t){return e.showColorPicker(t,"o:stroke_color_select")},className:"ps_n3_inputColorSwatch","data-initialcolor":this.props.initialValues["o:stroke_color_select"],"data-fieldname":"o:stroke_color_select",style:{backgroundColor:"undefined"!==typeof t?t["o:stroke_color_select"]:"#0000FF"}})),n.a.createElement("div",null,n.a.createElement("label",{htmlFor:"o:stroke_opacity_select"},k.selected_stroke_opacity),n.a.createElement(ma.a,{value:this.state.sliderValues["o:stroke_opacity_select"],min:.1,max:1,step:.01,orientation:"horizontal",onChangeStart:function(){return e.slider_changeStart("o:stroke_opacity_select")},onChange:this.slider_change,onChangeComplete:this.slider_changeComplete}),n.a.createElement(gt.a,{id:"o:stroke_opacity_select",name:"o:stroke_opacity_select",component:"input",type:"hidden"})),n.a.createElement("div",null,n.a.createElement("label",{htmlFor:"o:fill_opacity_select"},k.selected_fill_opacity),n.a.createElement(ma.a,{value:this.state.sliderValues["o:fill_opacity_select"],min:.1,max:1,step:.01,orientation:"horizontal",onChangeStart:function(){return e.slider_changeStart("o:fill_opacity_select")},onChange:this.slider_change,onChangeComplete:this.slider_changeComplete}),n.a.createElement(gt.a,{id:"o:fill_opacity_select",name:"o:fill_opacity_select",component:"input",type:"hidden"}))),n.a.createElement("div",{className:"ps_n3_optionHeader"},k.dimensions),n.a.createElement("div",null,n.a.createElement("label",{htmlFor:"o:stroke_width"},k.stroke_width),n.a.createElement(ma.a,{value:this.state.sliderValues["o:stroke_width"],min:0,max:20,step:.01,orientation:"horizontal",onChangeStart:function(){return e.slider_changeStart("o:stroke_width")},onChange:this.slider_change,onChangeComplete:this.slider_changeComplete}),n.a.createElement(gt.a,{id:"o:stroke_width",name:"o:stroke_width",component:"hidden"})),n.a.createElement("div",{className:"field"},n.a.createElement("label",{htmlFor:"o:point_radius"},k.point_radius),n.a.createElement("div",{className:"ui input"},n.a.createElement(gt.a,{className:"styleEditor_input",id:"o:point_radius",name:"o:point_radius",component:"input",type:"number","data-enforce":"float",onChange:this.inputEnforce}))),n.a.createElement("div",{className:"field"},n.a.createElement("label",{htmlFor:"o:zindex"},k.z_index),n.a.createElement("div",{className:"ui input"},n.a.createElement(gt.a,{className:"styleEditor_input",id:"o:zindex",name:"o:zindex",component:"input",type:"number","data-enforce":"float",onChange:this.inputEnforce}))),n.a.createElement("div",{className:"field"},n.a.createElement("label",{htmlFor:"o:weight"},k.order_weight),n.a.createElement("div",{className:"ui input"},n.a.createElement(gt.a,{className:"styleEditor_input",id:"o:weight",name:"o:weight",component:"input",type:"number","data-enforce":"float",onChange:this.inputEnforce}))),n.a.createElement("div",{className:"ps_n3_optionHeader"},k.dates),n.a.createElement("div",{className:"field"},n.a.createElement(da,{fieldName:"o:start_date",value:"undefined"!==typeof t?t["o:start_date"]:"",label:k.start_date,formatDate:ua.formatDate,parseDate:ua.parseDate,onDayChange:this.markUnsaved})),n.a.createElement("div",{className:"field"},n.a.createElement(da,{fieldName:"o:end_date",value:"undefined"!==typeof t?t["o:end_date"]:"",label:k.end_date,formatDate:ua.formatDate,parseDate:ua.parseDate,onDayChange:this.markUnsaved})),n.a.createElement("div",{className:"field"},n.a.createElement(da,{fieldName:"o:after_date",value:"undefined"!==typeof t?t["o:after_date"]:"",label:k.after_date,formatDate:ua.formatDate,parseDate:ua.parseDate,onDayChange:this.markUnsaved})),n.a.createElement("div",{className:"field"},n.a.createElement(da,{fieldName:"o:before_date",value:"undefined"!==typeof t?t["o:before_date"]:"",label:k.before_date,formatDate:ua.formatDate,parseDate:ua.parseDate,onDayChange:this.markUnsaved})),n.a.createElement("div",{className:"ps_n3_optionHeader"},k.imagery),n.a.createElement("div",{className:"field"},n.a.createElement("label",{htmlFor:"o:point_image"},k.point_image),n.a.createElement("div",{className:"ui input"},n.a.createElement(gt.a,{className:"styleEditor_input",id:"o:point_image",name:"o:point_image",component:"input",type:"text",onChange:this.markUnsaved}))),n.a.createElement("div",{className:"field"},n.a.createElement("label",{htmlFor:"o:wms_address"},k.wms_address),n.a.createElement("div",{className:"ui input"},n.a.createElement(gt.a,{className:"styleEditor_input",id:"o:wms_address",name:"o:wms_address",component:"input",type:"text",onChange:this.markUnsaved}))),n.a.createElement("div",{className:"field"},n.a.createElement("label",{htmlFor:"o:wms_layers"},k.wms_layers),n.a.createElement("div",{className:"ui input"},n.a.createElement(gt.a,{className:"styleEditor_input",id:"o:wms_layers",name:"o:wms_layers",component:"input",type:"text",onChange:this.markUnsaved}))))))))),n.a.createElement(gt.a,{className:"styleEditor_input",name:"o:coverage",component:"input",type:"hidden"}),n.a.createElement(gt.a,{className:"styleEditor_input",name:"o:is_coverage",component:"input",type:"hidden"}),n.a.createElement(gt.a,{className:"styleEditor_input",name:"o:exhibit_id",component:"input",type:"hidden"})):n.a.createElement("div",null,t["o:body"])}}]),a}(r.Component);ba=Object(vt.a)({form:"record",enableReinitialize:!0})(ba);var _a=Object(o.b)((function(e){return{record:e.record,userSignedIn:e.user.userSignedIn,mapCache:e.mapCache,selectedRecord:e.exhibitShow.selectedRecord,initialValues:e.exhibitShow.editorRecord?e.exhibitShow.editorRecord:Object(p.a)(Object(p.a)({},ha),{},{"o:exhibit":{"o:id":e.exhibitShow.exhibit["o:id"]}})}}),(function(e){return Object(l.b)({setUnsavedChanges:Je,updateRecordCache:Ze,removeRecordFromCache:$e},e)}))(ba),Ea=a(795),fa=function(e){Object(Fe.a)(a,e);var t=Object(Ve.a)(a);function a(){return Object(Me.a)(this,a),t.apply(this,arguments)}return Object(Pe.a)(a,[{key:"render",value:function(){var e=this;return n.a.createElement("div",null,n.a.createElement(Ea.a,null,n.a.createElement(Ea.a.Section,{onClick:function(){e.props.setShowRecords(!0),e.props.setRecordEditorType(""),e.props.deselect()}},"Records"),n.a.createElement(Ea.a.Divider,{icon:"right angle"}),n.a.createElement(Ea.a.Section,{active:!0},"New Record")),n.a.createElement(_a,{onSubmit:this.props.submit,submitLabel:k.create,disabled:this.props.record.loading}),n.a.createElement("p",null,this.props.record.error))}}]),a}(r.Component),ya=Object(o.b)((function(e){return{record:e.record}}),(function(e){return Object(l.b)({submit:We,selectRecord:ot},e)}))(fa),ga=function(e){Object(Fe.a)(a,e);var t=Object(Ve.a)(a);function a(){return Object(Me.a)(this,a),t.apply(this,arguments)}return Object(Pe.a)(a,[{key:"render",value:function(){var e=this.props,t=e.record,a=e.submit,r=e.loading,i=e.deleteRecord,o=e.deselect,l=e.setShowRecords,s=e.setRecordEditorType;return t?n.a.createElement("div",null,n.a.createElement(Ea.a,null,n.a.createElement(Ea.a.Section,{onClick:function(){l(!0),s(""),o()}},"Records"),n.a.createElement(Ea.a.Divider,{icon:"right angle"}),n.a.createElement(Ea.a.Section,{active:!0},t["o:title"])),n.a.createElement(_a,{onSubmit:a,submitLabel:k.save_record,disabled:r,showDelete:!0,handleDelete:function(){i(t),l(!0),s("")}}),n.a.createElement("p",null,t.error)):null}}]),a}(r.Component),va=Object(o.b)((function(e){return{record:e.exhibitShow.editorRecord,exhibit:e.exhibitShow.exhibit}}),(function(e){return Object(l.b)({submit:Ye,deleteRecord:qe},e)}))(ga),wa=function(e){Object(Fe.a)(a,e);var t=Object(Ve.a)(a);function a(){return Object(Me.a)(this,a),t.apply(this,arguments)}return Object(Pe.a)(a,[{key:"render",value:function(){return n.a.createElement("div",{id:"lockOverlay_container",className:this.props.isVisible?"lockOverlay_container":"lockOverlay_container hidden"},n.a.createElement("div",{className:this.props.error?"hidden":"lockOverlay"}))}}]),a}(r.Component),xa=function(e){Object(Fe.a)(a,e);var t=Object(Ve.a)(a);function a(){return Object(Me.a)(this,a),t.apply(this,arguments)}return Object(Pe.a)(a,[{key:"render",value:function(){return n.a.createElement("div",{id:"spinner_container",className:this.props.isVisible?"spinner_container":"spinner_container hidden"},n.a.createElement("div",{className:this.props.error?"hidden":"spinner"},n.a.createElement("div",{className:"bounce1"}),n.a.createElement("div",{className:"bounce2"}),n.a.createElement("div",{className:"bounce3"})))}}]),a}(r.Component),Ra=function(e){Object(Fe.a)(a,e);var t=Object(Ve.a)(a);function a(){return Object(Me.a)(this,a),t.apply(this,arguments)}return Object(Pe.a)(a,[{key:"render",value:function(){return n.a.createElement("div",{className:this.props.isVisible?"ps_n3_mapStatus_warning":"ps_n3_mapStatus_warning ps_n3_hidden"},n.a.createElement(Be.a,{name:"warning circle"}),this.props.message)}}]),a}(n.a.Component),Oa=a(389),Sa=function(e){return n.a.createElement("div",null,e.userSignedIn&&n.a.createElement("div",{className:"ps_n3_button save",onClick:e.onSave},"Save"),n.a.createElement("h3",null,n.a.createElement(Ue.a,{to:"".concat(window.baseRoute,"/")},"Neatline")," | ",e.children))},Ca=function(e){return e.userSignedIn?n.a.createElement(Vt,{exhibit:e.exhibit}):n.a.createElement("p",null,e.exhibit["o:narrative"])},ka=function(e){Object(Fe.a)(a,e);var t=Object(Ve.a)(a);function a(e){var r;Object(Me.a)(this,a),(r=t.call(this,e)).saveAll=function(e){var t;r.props.dispatch(Ge("EXHIBIT_CACHE_SAVE",t))},r.componentDidUpdate=function(e){"undefined"!==typeof r.props.filteredRecords||"undefined"===typeof r.props.match.params.slug||r.props.recordsLoading||r.props.fetchRecordsBySlug(r.props.match.params.slug),r.props.filteredRecords!==e.filteredRecords&&(r.setState({records:r.props.filteredRecords}),r.props.dispatch(r.props.updateRecordCache(r.props.filteredRecords)))},r.showRecords=function(){return r.props.showRecords?n.a.createElement(aa,{exhibitShowURL:r.props.match.url,userSignedIn:r.props.userSignedIn,setShowRecords:r.props.setShowRecords,setRecordEditorType:r.props.setRecordEditorType,viewMode:r.state.viewMode}):"new"===r.props.recordEditorType?n.a.createElement(ya,{setShowRecords:r.props.setShowRecords,deselect:r.props.deselectRecord,setRecordEditorType:r.props.setRecordEditorType}):n.a.createElement(va,{setShowRecords:r.props.setShowRecords,deselect:r.props.deselectRecord,setRecordEditorType:r.props.setRecordEditorType})},r.showExhibitPanel=function(){return r.props.showExhibitSettings?n.a.createElement(Ca,{exhibit:r.props.exhibit,userSignedIn:r.props.userSignedIn}):r.showRecords()},r.setViewExhibitEditing=function(){r.setState({viewingExhibitEdit:!r.state.viewingExhibitEdit})},r.setViewMode=function(e){return r.setState({viewMode:e})};var i=r.props.userSignedIn?"editing":"signedOut";return r.state={records:r.props.filteredRecords,viewMode:i},r}return Object(Pe.a)(a,[{key:"componentDidMount",value:function(){this.props.fetchExhibits(),this.cacheIntitialized=!1,this.exhibitCacheInitialized=!1,this.props.dispatch(Ge("RECORD_CACHE_CLEAR"))}},{key:"render",value:function(){var e,t=this,a=this.props,r=a.exhibit,i=!1===window.containerFullMode&&window.containerFullModeBaseRoute,o=!i&&!0===window.containerFullMode&&window.containerReturnBaseRoute;return r?e=n.a.createElement("div",null,n.a.createElement(He.a,{stackable:!0},n.a.createElement(He.a.Item,{header:!0,as:Ue.a,to:"".concat(window.baseRoute,"/")},n.a.createElement("span",{className:"neatline-subhead"},"Neatline")),n.a.createElement(He.a.Item,null,n.a.createElement("h1",{className:"neatline-title"},r["o:title"])),n.a.createElement(He.a.Item,null,i&&n.a.createElement("a",{title:"Fullscreen Editor",href:"".concat(window.containerFullModeBaseRoute,"/show/").concat(r["o:slug"]),"aria-label":"Fullscreen Editor"},n.a.createElement(Be.a,{name:"external alternate",size:"large"})),o&&n.a.createElement("a",{title:"Return to Omeka Admin",href:"".concat(window.containerReturnBaseRoute,"/show/").concat(r["o:slug"]),"aria-label":"Return to Omeka Admin"},n.a.createElement(Be.a,{name:"compress",size:"large"}))),n.a.createElement(He.a.Item,{position:"right"},this.props.userSignedIn?n.a.createElement("div",null,n.a.createElement(ze.a,{icon:!0,toggle:!0,basic:!0,color:this.props.showExhibitSettings?"blue":null,active:this.props.showExhibitSettings,onClick:function(){t.props.setShowExhibitSettings(!0),t.setViewMode("editing"),t.props.setShowRecords(!0),t.props.deselectRecord()}},"Exhibit Settings ",n.a.createElement(Be.a,{name:"settings"})),n.a.createElement(ze.a,{icon:!0,toggle:!0,basic:!0,color:this.props.showExhibitSettings||"editing"!==this.state.viewMode?null:"blue",active:!this.props.showExhibitSettings&&"editing"===this.state.viewMode,onClick:function(){t.props.setShowExhibitSettings(!1),t.setViewMode("editing")}},"Records ",n.a.createElement(Be.a,{name:"list"})),n.a.createElement(ze.a,{icon:!0,toggle:!0,basic:!0,color:"publicView"===this.state.viewMode?"blue":null,active:"publicView"===this.state.viewMode,onClick:function(){t.props.setShowExhibitSettings(!1),t.setViewMode("publicView"),t.props.setRecordEditorType(""),t.props.setShowRecords(!0),t.props.deselectRecord()}},"Public View ",n.a.createElement(Be.a,{name:"eye"})),n.a.createElement(ze.a,{icon:!0,onClick:this.saveAll},"Save ",n.a.createElement(Be.a,{name:"save"}))):n.a.createElement("div",null,n.a.createElement(ze.a,{icon:!0,toggle:!0,basic:!0,color:this.props.showExhibitSettings?"blue":null,active:this.props.showExhibitSettings,onClick:function(){t.props.setShowExhibitSettings(!0),t.props.setShowRecords(!0),t.props.deselectRecord()}},"Exhibit Information ",n.a.createElement(Be.a,{name:"info"})),n.a.createElement(ze.a,{icon:!0,toggle:!0,basic:!0,color:this.props.showExhibitSettings?null:"blue",active:!this.props.showExhibitSettings,onClick:function(){return t.props.setShowExhibitSettings(!1)}},"View Exhibit ",n.a.createElement(Be.a,{name:"list"}))))),n.a.createElement(Oa.a,{stackable:!0},n.a.createElement(Oa.a.Row,{style:{background:"none"}},this.props.userSignedIn?this.props.showExhibitSettings?n.a.createElement(Oa.a.Column,{width:5},n.a.createElement(Ca,{exhibit:this.props.exhibit,userSignedIn:this.props.userSignedIn})):n.a.createElement(Oa.a.Column,{width:5},this.showRecords()):this.props.showExhibitSettings?n.a.createElement(Oa.a.Column,{width:15},n.a.createElement(ea.a,{fluid:!0,style:{height:"80vh"}},n.a.createElement(ea.a.Content,null,n.a.createElement(ea.a.Header,null,r["o:title"])),n.a.createElement(ea.a.Content,null,n.a.createElement(ea.a.Description,null,r["o:narrative"])))):n.a.createElement(Oa.a.Column,{width:5},n.a.createElement(aa,{exhibitShowURL:this.props.match.url,userSignedIn:this.props.userSignedIn,setShowRecords:this.props.setShowRecords,setRecordEditorType:this.props.setRecordEditorType,viewMode:"signedOut"})),!(!this.props.userSignedIn&&this.props.showExhibitSettings)&&n.a.createElement(Oa.a.Column,{floated:"right",width:10},n.a.createElement("div",{className:"nl-container"},n.a.createElement("div",{className:"neatline-exhibit item-map",style:{marginBottom:"1rem",position:"relative",height:"500px"}},n.a.createElement(Yt,{userSignedIn:this.props.userSignedIn,mapCache:this.props.mapCache,exhibit:this.props.exhibit,records:this.state.records,selectedRecord:this.props.selectedRecord,previewedRecord:this.props.previewedRecord,editorRecord:this.props.editorRecord,editorNewRecord:this.props.editorNewRecord,leafletState:this.props.leaflet,exhibitShowURL:this.props.match.url,hasWarning:this.props.mapCache.hasUnsavedChanges,isEditing:"edit"===this.props.recordEditorType,showExhibitSettings:this.props.showExhibitSettings,viewMode:this.state.viewMode,setRecordEditorType:this.props.setRecordEditorType,setShowRecords:this.props.setShowRecords}),n.a.createElement(Qt,{isVisible:!this.props.showExhibitSettings&&!this.props.leaflet.isEditing}),n.a.createElement(Zt,null)),n.a.createElement("div",{className:"item-narrative",style:{marginBottom:"1rem",position:"relative"}},n.a.createElement(Kt,null))))))):a.exhibitsLoading?e=n.a.createElement(Sa,{userSignedIn:a.userSignedIn},"Loading..."):a.exhibitsErrored?e=n.a.createElement(Sa,{userSignedIn:a.userSignedIn},"*ERROR*"):a.exhibitNotFound&&(e=n.a.createElement(Sa,{userSignedIn:a.userSignedIn},'Exhibit with identifier "',a.match.params.slug,'" not found')),n.a.createElement("div",{className:"ps_n3_exhibitShowContainer",style:{width:"100%",position:"relative"}},n.a.createElement(Ra,{isVisible:this.props.mapCache.hasUnsavedChanges,message:"You have unsaved changes"}),n.a.createElement(xa,{isVisible:this.props.leaflet.isSaving||this.props.recordsLoading}),n.a.createElement(wa,{isVisible:this.props.leaflet.isEditing}),e)}}]),a}(r.Component),ja=Object(o.b)((function(e){return{userSignedIn:e.user.userSignedIn,exhibit:e.exhibitShow.exhibit,exhibits:e.exhibits,leaflet:e.leaflet,filteredRecords:e.exhibitShow.filteredRecords,recordsLoading:e.exhibitShow.loading,recordsErrored:e.exhibitShow.errored,exhibitNotFound:e.exhibitShow.exhibitNotFound,selectedRecord:e.exhibitShow.selectedRecord,editorRecord:e.exhibitShow.editorRecord,editorNewRecord:e.exhibitShow.editorNewRecord,tabIndex:e.exhibitShow.tabIndex,mapCache:e.mapCache,exhibitCache:e.exhibitCache,recordEditorType:e.exhibitShow.recordEditorType,showExhibitSettings:e.exhibitShow.showExhibitSettings,showRecords:e.exhibitShow.showRecords}}),(function(e){return Object(l.b)({fetchExhibits:at,setTabIndex:it,deselectRecord:lt,fetchRecordsBySlug:st,updateRecordCache:Ze,updateExhibitCache:Qe,setRecordEditorType:pt,setShowExhibitSettings:ut,setShowRecords:dt,dispatch:e},e)}))(ka),Na=function(e){Object(Fe.a)(a,e);var t=Object(Ve.a)(a);function a(){return Object(Me.a)(this,a),t.apply(this,arguments)}return Object(Pe.a)(a,[{key:"componentWillMount",value:function(){this.props.location.pathname.includes("add")?this.setState({open:!0}):this.setState({open:!1})}},{key:"render",value:function(){var e=this,t=k.getAvailableLanguages().map((function(t){return n.a.createElement(ze.a,{key:t,onClick:function(){return function(t){k.setLanguage(t),e.setState({})}(t)}},t)})),a=!(!1===window.containerFullMode&&window.containerFullModeBaseRoute)&&!0===window.containerFullMode&&window.containerReturnBaseRoute,r=this.props;return n.a.createElement("div",null,n.a.createElement(He.a,{stackable:!0},n.a.createElement(He.a.Item,{header:!0,as:Ue.a,to:"".concat(window.baseRoute,"/")},n.a.createElement("span",{className:"neatline-subhead"},"Neatline")),n.a.createElement(He.a.Item,null,n.a.createElement("h1",{className:"neatline-title"},k.createExhibit)),a&&n.a.createElement(He.a.Item,null,n.a.createElement("a",{title:"Return to Omeka Admin",href:"".concat(window.containerReturnBaseRoute,"/add"),"aria-label":"Return to Omeka Admin"},n.a.createElement(Be.a,{name:"compress",size:"large"}))),n.a.createElement(He.a.Item,{position:"right"},n.a.createElement("div",null,t))),n.a.createElement(Ea.a,null,n.a.createElement(Ea.a.Section,{href:"".concat(window.baseRoute,"/")},"Neatline"),n.a.createElement(Ea.a.Divider,{icon:"right angle"}),n.a.createElement(Ea.a.Section,{active:!0},"New Exhibit")),n.a.createElement(Ct,{onSubmit:r.submit,submitLabel:k.create_exhibit,disabled:r.loading,fullscreen:!0}),r.errored&&n.a.createElement("p",null,k.create_exhibit_error))}}]),a}(r.Component),Da=Object(o.b)((function(e){return{loading:e.exhibits.exhibit.loading,errored:e.exhibits.exhibit.errored}}),(function(e){return Object(l.b)({submit:ht},e)}))(Na),Ia=a(797),Ta=a(798),Aa=a(796),La=function(){return n.a.createElement("main",{className:"neatline"},n.a.createElement(Ia.a,{history:H},n.a.createElement(Ta.a,null,n.a.createElement(Aa.a,{exact:!0,path:"".concat(window.baseRoute,"/"),component:ft}),n.a.createElement(Aa.a,{path:"".concat(window.baseRoute,"/add"),component:Da}),n.a.createElement(Aa.a,{path:"".concat(window.baseRoute,"/show/:slug"),component:ja}))))},Ma=(a(780),document.getElementById("root"));Object(i.render)(n.a.createElement(o.a,{store:Le},n.a.createElement(La,null)),Ma)}},[[441,1,2]]]);
//# sourceMappingURL=main.c3227950.chunk.js.map